<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tai Yu Ying">
<meta name="dcterms.date" content="2024-09-08">

<title>Take-home Exercise 1 – Mapping the Unseen</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Mapping the Unseen</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-onExercise1.1.html">
 <span class="dropdown-text">Hands-on Exercise 1.1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-onExercise1.2.html">
 <span class="dropdown-text">Hands-on Exercise 1.2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-onExercise2.1.html">
 <span class="dropdown-text">Hands-on Exercise 2.1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-onExercise2.2.html">
 <span class="dropdown-text">Hands-on Exercise 2.2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-onExercise3.1.html">
 <span class="dropdown-text">Hands-on Exercise 3.1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-onExercise4.1.html">
 <span class="dropdown-text">Hands-on Exercise 4.1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-onExercise5.1.html">
 <span class="dropdown-text">Hands-on Exercise 5.1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-onExercise5.2.html">
 <span class="dropdown-text">Hands-on Exercise 5.2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-onExercise7.1.html">
 <span class="dropdown-text">Hands-on Exercise 7.1</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-classExercise1.html">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-classExercise2.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-classExercise3.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-classExercise4.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-classExercise5.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-homeExercise1.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">1</span> Overview</a></li>
  <li><a href="#objective" id="toc-objective" class="nav-link" data-scroll-target="#objective"><span class="header-section-number">2</span> Objective</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data"><span class="header-section-number">3</span> The Data</a></li>
  <li><a href="#installing-and-launching-the-r-packages" id="toc-installing-and-launching-the-r-packages" class="nav-link" data-scroll-target="#installing-and-launching-the-r-packages"><span class="header-section-number">4</span> Installing and launching the R packages</a></li>
  <li><a href="#data-import-and-preparation" id="toc-data-import-and-preparation" class="nav-link" data-scroll-target="#data-import-and-preparation"><span class="header-section-number">5</span> Data Import and Preparation</a>
  <ul class="collapse">
  <li><a href="#importing-thailand-road-accident-2019-2022" id="toc-importing-thailand-road-accident-2019-2022" class="nav-link" data-scroll-target="#importing-thailand-road-accident-2019-2022"><span class="header-section-number">5.1</span> Importing Thailand Road Accident [2019-2022]</a></li>
  <li><a href="#importing-thailand-roads-openstreetmap-export" id="toc-importing-thailand-roads-openstreetmap-export" class="nav-link" data-scroll-target="#importing-thailand-roads-openstreetmap-export"><span class="header-section-number">5.2</span> Importing Thailand Roads (OpenStreetMap Export)</a></li>
  <li><a href="#importing-thailand---subnational-administrative-boundaries" id="toc-importing-thailand---subnational-administrative-boundaries" class="nav-link" data-scroll-target="#importing-thailand---subnational-administrative-boundaries"><span class="header-section-number">5.3</span> Importing Thailand - Subnational Administrative Boundaries</a></li>
  <li><a href="#define-and-filter-bangkok-metropolitan-region-bmr" id="toc-define-and-filter-bangkok-metropolitan-region-bmr" class="nav-link" data-scroll-target="#define-and-filter-bangkok-metropolitan-region-bmr"><span class="header-section-number">5.4</span> Define and filter Bangkok Metropolitan Region (BMR)</a></li>
  </ul></li>
  <li><a href="#plotting-the-geospatial-data" id="toc-plotting-the-geospatial-data" class="nav-link" data-scroll-target="#plotting-the-geospatial-data"><span class="header-section-number">6</span> Plotting the Geospatial Data</a>
  <ul class="collapse">
  <li><a href="#spatial-distribution-of-road-fatalities-in-bangkok-metropolitan-region" id="toc-spatial-distribution-of-road-fatalities-in-bangkok-metropolitan-region" class="nav-link" data-scroll-target="#spatial-distribution-of-road-fatalities-in-bangkok-metropolitan-region"><span class="header-section-number">6.1</span> Spatial Distribution of Road Fatalities in Bangkok Metropolitan Region</a></li>
  </ul></li>
  <li><a href="#visualizing-spatio-temporal-dynamics-of-road-accidents" id="toc-visualizing-spatio-temporal-dynamics-of-road-accidents" class="nav-link" data-scroll-target="#visualizing-spatio-temporal-dynamics-of-road-accidents"><span class="header-section-number">7</span> Visualizing Spatio-Temporal Dynamics of Road Accidents</a>
  <ul class="collapse">
  <li><a href="#risk-behaviors-in-different-travel-modes" id="toc-risk-behaviors-in-different-travel-modes" class="nav-link" data-scroll-target="#risk-behaviors-in-different-travel-modes"><span class="header-section-number">7.1</span> Risk Behaviors in Different Travel Modes</a></li>
  <li><a href="#weather-conditions" id="toc-weather-conditions" class="nav-link" data-scroll-target="#weather-conditions"><span class="header-section-number">7.2</span> Weather conditions</a></li>
  <li><a href="#seasonal-accident-trends-analysis-new-year-and-songkran-festivals" id="toc-seasonal-accident-trends-analysis-new-year-and-songkran-festivals" class="nav-link" data-scroll-target="#seasonal-accident-trends-analysis-new-year-and-songkran-festivals"><span class="header-section-number">7.3</span> Seasonal Accident Trends Analysis (New Year and Songkran Festivals)</a></li>
  <li><a href="#other-contributing-factors" id="toc-other-contributing-factors" class="nav-link" data-scroll-target="#other-contributing-factors"><span class="header-section-number">7.4</span> Other Contributing Factors</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 1</h1>
</div>



<div class="quarto-title-meta column-page-left">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Tai Yu Ying </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 8, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">September 23, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="overview" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="overview"><span class="header-section-number">1</span> Overview</h2>
<p>Road traffic accidents are a major global health issue, causing millions of deaths and injuries each year. The majority of fatalities occur in low- and middle-income countries, particularly among vulnerable road users. These accidents not only lead to human suffering but also impose a significant economic burden on individuals, families, and nations. Thailand, in particular, has a high rate of road traffic deaths, with a significant portion of accidents occurring on national highways and in designated “black spots.”</p>
</section>
<section id="objective" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="objective"><span class="header-section-number">2</span> Objective</h2>
<p>The objective of this project is to investigate the factors influencing road traffic accidents in the Bangkok Metropolitan Region (BMR) using spatial and spatio-temporal point pattern analysis.</p>
<ul>
<li><p><strong>Visualize spatio-temporal dynamics:</strong> Use statistical graphics and geovisualization methods to depict the distribution of road traffic accidents over time and space.</p></li>
<li><p><strong>Conduct spatial analysis:</strong> Employ network-based spatial point pattern analysis methods to examine the spatial distribution of accidents within the road network.</p></li>
<li><p><strong>Conduct spatio-temporal analysis:</strong> Utilize temporal network-based spatial point pattern analysis methods to explore the relationship between accidents and both spatial and temporal factors.</p></li>
</ul>
</section>
<section id="the-data" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="the-data"><span class="header-section-number">3</span> The Data</h2>
<p>Three basic data sets are used, they are:</p>
<ul>
<li><p><a href="https://www.kaggle.com/datasets/thaweewatboy/thailand-road-accident-2019-2022">Thailand Road Accident [2019-2022]</a> on Kaggle</p></li>
<li><p><a href="https://data.humdata.org/dataset/hotosm_tha_roads">Thailand Roads (OpenStreetMap Export)</a> on HDX.</p></li>
<li><p><a href="https://data.humdata.org/dataset/cod-ab-tha?">Thailand - Subnational Administrative Boundaries</a> on HDX.</p></li>
</ul>
</section>
<section id="installing-and-launching-the-r-packages" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="installing-and-launching-the-r-packages"><span class="header-section-number">4</span> Installing and launching the R packages</h2>
<p>In this exercise, the following R packages will be used, they are:</p>
<ul>
<li><p><strong>spNetwork</strong>:</p>
<ul>
<li><p><code>st_network</code> for converting road networks into an sf object.</p></li>
<li><p><code>kernel_density</code> to perform kernel density estimation (KDE) on the network to visualize accident hotspots.</p></li>
<li><p><code>k_function</code> to analyze spatial clustering of accidents on the road network.</p></li>
</ul></li>
<li><p><strong>sf</strong>:</p>
<ul>
<li><p><code>st_as_sf()</code> to convert datasets into spatial features (sf objects) for spatial analysis.</p></li>
<li><p><code>st_transform()</code> to transform coordinate reference systems (CRS) for accurate geospatial representation.</p></li>
<li><p><code>st_join()</code> to perform spatial joins between two sf objects, such as accident locations and administrative boundaries.</p></li>
</ul></li>
<li><p><strong>tmap</strong>:</p>
<ul>
<li><p><code>tm_shape()</code> to define the spatial layers (e.g., boundaries, roads, accidents).</p></li>
<li><p><code>tm_fill()</code> and <code>tm_borders()</code> to color and outline the regions (e.g., administrative boundaries).</p></li>
<li><p><code>tm_dots()</code> to plot accident points on the map.</p></li>
<li><p><code>tm_raster()</code> to add raster layers like kernel density maps.</p></li>
<li><p><code>tmap_arrange()</code> to arrange multiple maps into a grid layout.</p></li>
<li><p><code>tmap_animation()</code> to create animated time-lapse maps for temporal accident patterns.</p></li>
</ul></li>
<li><p><strong>tidyverse (dplyr)</strong>:</p>
<ul>
<li><p><code>filter()</code> to subset data based on conditions (e.g., accidents on straight roads).</p></li>
<li><p><code>group_by()</code> and <code>summarize()</code> to aggregate data by specific factors such as road type or weather condition.</p></li>
<li><p><code>mutate()</code> to add new columns or modify existing data.</p></li>
<li><p><code>arrange()</code> to sort data in ascending or descending order.</p></li>
</ul></li>
<li><p><strong>spatstat</strong>:</p>
<ul>
<li><p><code>as.ppp()</code> to convert sf objects into point pattern format for spatial analysis.</p></li>
<li><p><code>density()</code> to perform kernel density estimation (KDE) for accident distribution.</p></li>
<li><p><code>Kest()</code> for computing Ripley’s K-function to assess spatial clustering.</p></li>
</ul></li>
<li><p><strong>raster</strong>:</p>
<ul>
<li><p><code>raster()</code> to convert KDE output to raster objects for visual representation on the map.</p></li>
<li><p><code>writeRaster()</code> to save raster files for later use or visualization.</p></li>
</ul></li>
<li><p><strong>ggplot2</strong>:</p>
<ul>
<li><p><code>ggplot()</code> to create plots such as heatmaps for visualizing accidents over time.</p></li>
<li><p><code>geom_tile()</code> for creating heatmaps.</p></li>
<li><p><code>scale_fill_gradient()</code> to apply color gradients in the heatmaps.</p></li>
</ul></li>
<li><p><strong>gifski</strong>:</p>
<ul>
<li><code>save_gif()</code> to create and save animated maps or time-lapse visualizations.</li>
</ul></li>
</ul>
<p>Use the code chunk below to install and launch the four R packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, spNetwork, tmap, tidyverse, dplyr, spatstat, raster, gifski, ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-import-and-preparation" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="data-import-and-preparation"><span class="header-section-number">5</span> Data Import and Preparation</h2>
<section id="importing-thailand-road-accident-2019-2022" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="importing-thailand-road-accident-2019-2022"><span class="header-section-number">5.1</span> Importing <a href="https://www.kaggle.com/datasets/thaweewatboy/thailand-road-accident-2019-2022">Thailand Road Accident [2019-2022]</a></h3>
<p>Since&nbsp;<code>acc</code>&nbsp;data set is in csv file format, we will use&nbsp;<a href="https://readr.tidyverse.org/reference/read_delim.html"><em>read_csv()</em></a>&nbsp;of&nbsp;<strong>readr</strong>&nbsp;package to import&nbsp;<code>thai_road_accident_2019_2022.csv</code>&nbsp;as shown the code chunk below. The output R object is called&nbsp;<code>acc</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Objectives</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">The code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Missing data check</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Examine output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">Selecting relevant columns</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">Why These Columns?</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>The below code uses the following to:</p>
<ul>
<li><p><strong><code>read_csv()</code></strong>: This function is used to load the CSV file (<code>thai_road_accident_2019_2022.csv</code>) into R. The dataset is stored in a variable called <code>acc</code>.</p></li>
<li><p><strong><code>filter()</code></strong>: This function is from the <code>dplyr</code> package and is used to filter the rows of the dataset.</p></li>
<li><p><strong><code>!is.na(longitude) &amp; !is.na(latitude)</code></strong>: This condition ensures that only rows where both <code>longitude</code> and <code>latitude</code> are not missing (<code>NA</code>) are kept. Any rows with missing coordinates will be removed.</p></li>
<li><p><strong><code>mutate()</code></strong>: This function is used to create or modify columns in a dataframe</p></li>
<li><p><strong><code>month(incident_datetime)</code></strong>: This function extracts the month from the <code>incident_datetime</code> column, and stores it in a new column called <code>Month_num</code> (numeric form of the month)</p></li>
<li><p><strong><code>month(incident_datetime, label = TRUE, abbr = TRUE)</code></strong>: This extracts the month in a labeled form, and it will be abbreviated (e.g., “Jan”, “Feb”). This is stored in a new column called <code>Month_fac</code></p></li>
<li><p><strong><code>day(incident_datetime)</code></strong>: This extracts the day of the month from the <code>incident_datetime</code> column and stores it in a new column called <code>dayofweek</code></p></li>
<li><p><strong><code>st_as_sf()</code></strong>: This function from the <code>sf</code> package is used to convert the dataframe to a simple features (spatial) object</p></li>
<li><p><strong><code>coords = c("longitude", "latitude")</code></strong>: This argument tells <code>st_as_sf()</code> to use the <code>longitude</code> and <code>latitude</code> columns to define the spatial coordinates</p></li>
<li><p><strong><code>crs = 4326</code></strong>: This specifies the Coordinate Reference System (CRS) for the spatial object. EPSG:4326 refers to <strong>WGS 84</strong>, which is the standard geographic CRS (latitude and longitude in degrees)</p></li>
<li><p><strong><code>st_transform()</code></strong>: This function is used to reproject the spatial object to a different CRS</p></li>
<li><p><strong><code>crs = 32647</code></strong>: This specifies the target CRS, which is <strong>UTM Zone 47N</strong>. This is a projected CRS that uses meters as units and is more appropriate for spatial analysis in Thailand. EPSG:32647 is commonly used for accurate distance and area measurements in this region</p></li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>acc <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/rawdata/thai_road_accident_2019_2022.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(longitude) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(latitude)) <span class="sc">%&gt;%</span>   <span class="co"># Filter out rows with missing geographic coordinates</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month_num =</span> <span class="fu">month</span>(incident_datetime)) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month_fac =</span> <span class="fu">month</span>(incident_datetime, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dayofweek =</span> <span class="fu">day</span>(incident_datetime)) <span class="sc">%&gt;%</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>), <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">%&gt;%</span>  <span class="co"># Specify the CRS</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">32647</span>)  <span class="co"># Transform to your desired CRS</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(acc, <span class="st">"Data/rds/acc.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>acc <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"Data/rds/acc.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>We can identify rows with missing values by applying <em>filter()</em> in combination with <em>is.na()</em> to check each column in your dataset. The function <em>if_any()</em> checks all columns, and if any of the columns contain <em>NA</em>, the corresponding row will be flagged.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify rows with missing values</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>acc_incomplete <span class="ot">&lt;-</span> acc <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">if_any</span>(<span class="fu">everything</span>(), is.na))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># View incomplete rows</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>acc_incomplete</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 19 fields
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Projected CRS: WGS 84 / UTM zone 47N
# A tibble: 0 × 20
# ℹ 20 variables: acc_code &lt;dbl&gt;, incident_datetime &lt;dttm&gt;,
#   report_datetime &lt;dttm&gt;, province_th &lt;chr&gt;, province_en &lt;chr&gt;, agency &lt;chr&gt;,
#   route &lt;chr&gt;, vehicle_type &lt;chr&gt;, presumed_cause &lt;chr&gt;, accident_type &lt;chr&gt;,
#   number_of_vehicles_involved &lt;dbl&gt;, number_of_fatalities &lt;dbl&gt;,
#   number_of_injuries &lt;dbl&gt;, weather_condition &lt;chr&gt;, road_description &lt;chr&gt;,
#   slope_description &lt;chr&gt;, Month_num &lt;dbl&gt;, Month_fac &lt;ord&gt;, dayofweek &lt;int&gt;,
#   geometry &lt;GEOMETRY [m]&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>After importing the data file into R, it is important for us to examine if the data file has been imported correctly.</p>
<p>The code chunk below shows <em>summary()</em> and <em>list()</em> of Base R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(acc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    acc_code       incident_datetime               
 Min.   : 571834   Min.   :2019-01-01 00:00:00.00  
 1st Qu.:3789326   1st Qu.:2020-01-16 14:57:30.00  
 Median :3823434   Median :2021-01-02 18:30:00.00  
 Mean   :4228913   Mean   :2021-01-08 11:25:47.25  
 3rd Qu.:5830777   3rd Qu.:2022-01-02 19:17:00.00  
 Max.   :7571316   Max.   :2022-12-31 23:55:00.00  
                                                   
 report_datetime                  province_th        province_en       
 Min.   :2019-01-01 03:05:00.00   Length:81376       Length:81376      
 1st Qu.:2020-03-16 15:27:00.00   Class :character   Class :character  
 Median :2021-03-31 08:39:00.00   Mode  :character   Mode  :character  
 Mean   :2021-03-26 16:52:04.98                                        
 3rd Qu.:2022-03-01 10:02:15.00                                        
 Max.   :2023-01-26 13:20:00.00                                        
                                                                       
    agency             route           vehicle_type       presumed_cause    
 Length:81376       Length:81376       Length:81376       Length:81376      
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
 accident_type      number_of_vehicles_involved number_of_fatalities
 Length:81376       Min.   : 0.000              Min.   : 0.0000     
 Class :character   1st Qu.: 1.000              1st Qu.: 0.0000     
 Mode  :character   Median : 1.000              Median : 0.0000     
                    Mean   : 1.535              Mean   : 0.1461     
                    3rd Qu.: 2.000              3rd Qu.: 0.0000     
                    Max.   :27.000              Max.   :13.0000     
                                                                    
 number_of_injuries weather_condition  road_description   slope_description 
 Min.   : 0.0000    Length:81376       Length:81376       Length:81376      
 1st Qu.: 0.0000    Class :character   Class :character   Class :character  
 Median : 0.0000    Mode  :character   Mode  :character   Mode  :character  
 Mean   : 0.8139                                                            
 3rd Qu.: 1.0000                                                            
 Max.   :51.0000                                                            
                                                                            
   Month_num        Month_fac       dayofweek              geometry    
 Min.   : 1.000   Dec    : 9621   Min.   : 1.00   POINT        :81376  
 1st Qu.: 3.000   Apr    : 9403   1st Qu.: 8.00   epsg:32647   :    0  
 Median : 6.000   Jan    : 8494   Median :15.00   +proj=utm ...:    0  
 Mean   : 6.469   Mar    : 6468   Mean   :15.72                        
 3rd Qu.:10.000   Oct    : 6293   3rd Qu.:24.00                        
 Max.   :12.000   Jul    : 6255   Max.   :31.00                        
                  (Other):34842                                        </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(acc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
Simple feature collection with 81376 features and 19 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -16183190 ymin: -936.228 xmax: 1200243 ymax: 4918525
Projected CRS: WGS 84 / UTM zone 47N
# A tibble: 81,376 × 20
   acc_code incident_datetime   report_datetime     province_th province_en     
 *    &lt;dbl&gt; &lt;dttm&gt;              &lt;dttm&gt;              &lt;chr&gt;       &lt;chr&gt;           
 1   571905 2019-01-01 00:00:00 2019-01-02 06:11:00 ลพบุรี        Loburi          
 2  3790870 2019-01-01 00:03:00 2020-02-20 13:48:00 อุบลราชธานี   Ubon Ratchathani
 3   599075 2019-01-01 00:05:00 2019-01-01 10:35:00 ประจวบคีรีขันธ์ Prachuap Khiri …
 4   571924 2019-01-01 00:20:00 2019-01-02 05:12:00 เชียงใหม่     Chiang Mai      
 5   599523 2019-01-01 00:25:00 2019-01-04 09:42:00 นครสวรรค์    Nakhon Sawan    
 6   571982 2019-01-01 00:30:00 2019-01-07 12:46:00 แม่ฮ่องสอน    Mae Hong Son    
 7   612782 2019-01-01 00:30:00 2019-10-25 14:25:00 ชุมพร        Chumphon        
 8   599235 2019-01-01 00:35:00 2019-01-02 16:23:00 สิงห์บุรี       Sing Buri       
 9   600643 2019-01-01 00:40:00 2019-01-11 10:01:00 สงขลา       Songkhla        
10   599105 2019-01-01 00:45:00 2019-01-01 10:11:00 ตราด        Trat            
# ℹ 81,366 more rows
# ℹ 15 more variables: agency &lt;chr&gt;, route &lt;chr&gt;, vehicle_type &lt;chr&gt;,
#   presumed_cause &lt;chr&gt;, accident_type &lt;chr&gt;,
#   number_of_vehicles_involved &lt;dbl&gt;, number_of_fatalities &lt;dbl&gt;,
#   number_of_injuries &lt;dbl&gt;, weather_condition &lt;chr&gt;, road_description &lt;chr&gt;,
#   slope_description &lt;chr&gt;, Month_num &lt;dbl&gt;, Month_fac &lt;ord&gt;, dayofweek &lt;int&gt;,
#   geometry &lt;POINT [m]&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<ol type="1">
<li><p><strong><code>acc_code</code></strong>: Unique identifier for each accident. Useful for tracking individual incidents.</p></li>
<li><p><strong><code>incident_datetime</code></strong>: Date and time of the accident. Important for temporal analysis (e.g., analyzing accidents by time of day or day of the week).</p></li>
<li><p><strong><code>province_en</code></strong>: The province where the accident occurred. You’ll need this to filter accidents within the Bangkok Metropolitan Region (BMR).</p></li>
<li><p><strong><code>vehicle_type</code></strong>: The type of vehicles involved in the accident. This is useful for understanding vehicle-specific trends in accidents.</p></li>
<li><p><strong><code>presumed_cause</code></strong>: The suspected cause of the accident. This helps with behavioral analysis and understanding the major factors contributing to accidents.</p></li>
<li><p><strong><code>accident_type</code></strong>: Type of accident (e.g., collision, rollover). This helps categorize the nature of accidents.</p></li>
<li><p><strong><code>number_of_vehicles_involved</code></strong>: The number of vehicles involved. Useful for analyzing accident severity.</p></li>
<li><p><strong><code>number_of_fatalities</code></strong>: The number of fatalities in the accident. Important for assessing the severity and impact of accidents.</p></li>
<li><p><strong><code>number_of_injuries</code></strong>: The number of injuries in the accident. Another key factor for assessing the seriousness of accidents.</p></li>
<li><p><strong><code>weather_condition</code></strong>: Weather conditions at the time of the accident. Useful for understanding environmental factors affecting accidents.</p></li>
<li><p><strong><code>latitude</code> and <code>longitude</code></strong>: Coordinates of the accident location. These are crucial for spatial analysis, including mapping accidents and performing spatial joins with road networks.</p></li>
<li><p><strong><code>road_description</code></strong>: A description of the road (e.g., highway, intersection). Helps in identifying road-specific characteristics linked to accidents.</p></li>
<li><p><strong><code>slope_description</code></strong>: Description of the slope of the road. Useful for analyzing road conditions that may contribute to accidents.</p></li>
</ol>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<ul>
<li><p><strong>Temporal Analysis</strong>: <code>incident_datetime</code> will allow you to analyze patterns based on time (e.g., peak accident times or seasons).</p></li>
<li><p><strong>Spatial Analysis</strong>: <code>latitude</code> and <code>longitude</code> are essential for mapping the accident locations and performing spatial joins with your roads dataset.</p></li>
<li><p><strong>Accident Characteristics</strong>: Columns like <code>vehicle_type</code>, <code>presumed_cause</code>, <code>accident_type</code>, and <code>weather_condition</code> help you understand the types of accidents and contributing factors.</p></li>
<li><p><strong>Severity Indicators</strong>: <code>number_of_fatalities</code> and <code>number_of_injuries</code> help assess the severity of each accident.</p></li>
<li><p><strong>Road Context</strong>: <code>road_description</code> and <code>slope_description</code> provide additional context on road conditions that may influence accidents.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the dataset to include only the relevant columns</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>accidents_filtered <span class="ot">&lt;-</span> acc <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(acc_code,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                incident_datetime,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                Month_num,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                Month_fac,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                dayofweek,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                province_en,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                vehicle_type,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                presumed_cause,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                accident_type,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                number_of_vehicles_involved,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                number_of_fatalities,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                number_of_injuries,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>                weather_condition,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>                road_description,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                slope_description,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>                geometry)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co"># View the first few rows of the filtered dataset</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(accidents_filtered)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 6 features and 15 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 386299.4 ymin: 1368107 xmax: 1130617 ymax: 2080805
Projected CRS: WGS 84 / UTM zone 47N
# A tibble: 6 × 16
  acc_code incident_datetime   Month_num Month_fac dayofweek province_en        
     &lt;dbl&gt; &lt;dttm&gt;                  &lt;dbl&gt; &lt;ord&gt;         &lt;int&gt; &lt;chr&gt;              
1   571905 2019-01-01 00:00:00         1 Jan               1 Loburi             
2  3790870 2019-01-01 00:03:00         1 Jan               1 Ubon Ratchathani   
3   599075 2019-01-01 00:05:00         1 Jan               1 Prachuap Khiri Khan
4   571924 2019-01-01 00:20:00         1 Jan               1 Chiang Mai         
5   599523 2019-01-01 00:25:00         1 Jan               1 Nakhon Sawan       
6   571982 2019-01-01 00:30:00         1 Jan               1 Mae Hong Son       
# ℹ 10 more variables: vehicle_type &lt;chr&gt;, presumed_cause &lt;chr&gt;,
#   accident_type &lt;chr&gt;, number_of_vehicles_involved &lt;dbl&gt;,
#   number_of_fatalities &lt;dbl&gt;, number_of_injuries &lt;dbl&gt;,
#   weather_condition &lt;chr&gt;, road_description &lt;chr&gt;, slope_description &lt;chr&gt;,
#   geometry &lt;POINT [m]&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="importing-thailand-roads-openstreetmap-export" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="importing-thailand-roads-openstreetmap-export"><span class="header-section-number">5.2</span> Importing <a href="https://data.humdata.org/dataset/hotosm_tha_roads">Thailand Roads (OpenStreetMap Export)</a></h3>
<p>The code chunk below uses&nbsp;<em>st_read()</em>&nbsp;function of&nbsp;<strong>sf</strong>&nbsp;package to import&nbsp;<code>hotosm_tha_roads_lines_shp</code>&nbsp;shapefile into R as a polygon feature data frame.&nbsp;</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Objectives</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">The code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Selecting relevant columns</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>The below code uses the following to:</p>
<ul>
<li><p><strong><code>st_read()</code></strong>: Reads the Shapefile.</p></li>
<li><p><strong><code>st_crs()</code></strong>: Checks the CRS of the dataset.</p></li>
<li><p><strong><code>st_zm()</code></strong>: Removes unnecessary Z and M dimensions</p></li>
<li><p><strong><code>st_cast()</code></strong>: This function converts the geometries from <strong><code>MULTILINESTRING</code></strong> to <strong><code>LINESTRING</code></strong>, allowing you to handle each line individually.</p></li>
<li><p><strong><code>colSums(is.na(st_drop_geometry()))</code></strong>: Checks for missing values in attribute columns (excluding geometries).</p></li>
<li><p><strong><code>st_is_valid()</code></strong>: Checks if the geometries are valid.</p></li>
<li><p><strong><code>st_make_valid()</code></strong>: Cleans invalid geometries if any exist.</p></li>
<li><p><strong><code>st_transform()</code></strong>: Transforms the dataset to <strong>UTM Zone 47N (EPSG:32647)</strong> for better spatial accuracy in Thailand.</p></li>
<li><p><strong><code>drop_na()</code></strong>: Removes rows with missing values in attributes.</p></li>
<li><p><strong><code>summary()</code></strong>: Provides a summary of the cleaned dataset.</p></li>
</ul>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read only necessary columns (adjust column names as needed)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>roads_raw <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"Data/rawdata/hotosm_tha_roads_lines_shp.shp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `hotosm_tha_roads_lines_shp' from data source 
  `C:\gniyuy\ISSS626_GA\Take-home_Ex\Take-home_Ex01\Data\rawdata\hotosm_tha_roads_lines_shp.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 2792361 features and 14 fields
Geometry type: MULTILINESTRING
Dimension:     XY
Bounding box:  xmin: 97.34457 ymin: 5.643645 xmax: 105.6528 ymax: 20.47168
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check CRS</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">st_crs</span>(roads_raw))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove Z and M dimensions from the roads dataset</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>roads_raw <span class="ot">&lt;-</span> <span class="fu">st_zm</span>(roads_raw, <span class="at">drop =</span> <span class="cn">TRUE</span>, <span class="at">what =</span> <span class="st">"ZM"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure MULTILINESTRING is converted to LINESTRING</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Explode MULTILINESTRING into individual LINESTRING geometries</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>roads_raw <span class="ot">&lt;-</span> <span class="fu">st_cast</span>(roads_raw, <span class="st">"LINESTRING"</span>, <span class="at">group_or_split =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for invalid geometries</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>invalid_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">st_is_valid</span>(roads_raw))</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Number of invalid geometries:"</span>, invalid_count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Number of invalid geometries: 0"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean and transform data</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>roads_cleaned <span class="ot">&lt;-</span> roads_raw <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(invalid_count <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">st_make_valid</span>(.) <span class="cf">else</span> .} <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">32647</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Provide a summary of the cleaned dataset</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Summary of the cleaned dataset:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Summary of the cleaned dataset:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(roads_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     name             name_en            highway            surface         
 Length:2792362     Length:2792362     Length:2792362     Length:2792362    
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
  smoothness           width              lanes              oneway         
 Length:2792362     Length:2792362     Length:2792362     Length:2792362    
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
    bridge             layer              source            name_th         
 Length:2792362     Length:2792362     Length:2792362     Length:2792362    
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
     osm_id            osm_type                  geometry      
 Min.   :4.271e+06   Length:2792362     LINESTRING   :2792362  
 1st Qu.:5.269e+08   Class :character   epsg:32647   :      0  
 Median :6.296e+08   Mode  :character   +proj=utm ...:      0  
 Mean   :6.896e+08                                             
 3rd Qu.:9.353e+08                                             
 Max.   :1.316e+09                                             </code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>From the columns in <code>roads_cleaned</code> dataset, the following would be most relevant to the project and can be retained:</p>
<ol type="1">
<li><p><code>name_en</code>: The English name of the road can be helpful for reference.</p></li>
<li><p><code>highway</code>: Indicates the road type, which can be essential for understanding traffic and accident patterns.</p></li>
<li><p><code>surface</code>: Useful to assess the condition of roads.</p></li>
<li><p><code>lanes</code>: Important for analyzing road capacity and traffic accidents.</p></li>
<li><p><code>oneway</code>: Indicates whether the road is one-way, which could be relevant to accidents.</p></li>
<li><p><code>bridge</code>: Useful for identifying structural elements that may influence accident frequency.</p></li>
<li><p><code>layer</code>: Might be important if there are stacked roads or complex intersections.</p></li>
<li><p><code>osm_id</code>: Identifier for each road segment (important for spatial joins or linking).</p></li>
<li><p><code>osm_type</code>: Type of OpenStreetMap object (likely useful for analysis).</p></li>
<li><p><code>geometry</code>: Necessary for spatial analysis and mapping.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>roads_filtered <span class="ot">&lt;-</span> roads_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name_en, highway, surface, lanes, oneway, bridge, layer, osm_id, osm_type, geometry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="importing-thailand---subnational-administrative-boundaries" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="importing-thailand---subnational-administrative-boundaries"><span class="header-section-number">5.3</span> Importing <a href="https://data.humdata.org/dataset/cod-ab-tha?">Thailand - Subnational Administrative Boundaries</a></h3>
<p>The code chunk below uses&nbsp;<em>st_read()</em>&nbsp;function of&nbsp;<strong>sf</strong>&nbsp;package to import&nbsp;<code>tha_adm_rtsd_itos_20210121_SHP</code>&nbsp;shapefile into R as a polygon feature data frame.&nbsp;</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Objectives</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">The code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Selecting relevant columns</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>The below code uses the following to:</p>
<ul>
<li><p><strong><code>st_read()</code></strong>: Reads the Shapefile for the administrative boundaries of Thailand</p></li>
<li><p><strong><code>st_crs()</code></strong>: Checks the Coordinate Reference System of the dataset</p></li>
<li><p><strong><code>st_geometry_type()</code></strong>: Identifies the geometry type (e.g., polygons, points, etc.)</p></li>
<li><p><strong><code>st_bbox()</code></strong>: Displays the bounding box (extent) of the dataset</p></li>
<li><p><strong><code>colSums(is.na(st_drop_geometry()))</code></strong>: Calculates the number of missing values in each attribute column (non-geometry columns)</p></li>
<li><p><strong><code>st_is_valid()</code></strong>: Checks if there are any invalid geometries in the dataset</p></li>
<li><p><strong><code>st_make_valid()</code></strong>: Cleans invalid geometries, if any exist</p></li>
<li><p><strong><code>st_transform(crs = 32647)</code></strong>: Transforms the dataset to <strong>UTM Zone 47N (EPSG:32647)</strong> for spatial accuracy in Thailand</p></li>
<li><p><strong><code>drop_na()</code></strong>: Removes rows where any attribute columns contain missing values</p></li>
<li><p><strong><code>summary()</code></strong>: Provides a summary of the final cleaned dataset, including both attribute data and geometries</p></li>
</ul>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>admin_boundaries_raw <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"Data/rawdata/tha_admbnda_adm2_rtsd_20220121.shp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `tha_admbnda_adm2_rtsd_20220121' from data source 
  `C:\gniyuy\ISSS626_GA\Take-home_Ex\Take-home_Ex01\Data\rawdata\tha_admbnda_adm2_rtsd_20220121.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 928 features and 19 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check Geospatial Properties</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Geospatial Properties:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Geospatial Properties:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">st_crs</span>(admin_boundaries_raw))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">st_geometry_type</span>(admin_boundaries_raw))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
  [6] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [11] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [16] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [21] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [26] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [31] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [36] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [41] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [46] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [51] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [56] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [61] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [66] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [71] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [76] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [81] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [86] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [91] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [96] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[101] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[106] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[111] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[116] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[121] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[126] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[131] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[136] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[141] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[146] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[151] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[156] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[161] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[166] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[171] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[176] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[181] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[186] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[191] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[196] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[201] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[206] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[211] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[216] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[221] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[226] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[231] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[236] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[241] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[246] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[251] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[256] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[261] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[266] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[271] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[276] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[281] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[286] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[291] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[296] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[301] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[306] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[311] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[316] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[321] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[326] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[331] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[336] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[341] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[346] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[351] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[356] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[361] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[366] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[371] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[376] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[381] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[386] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[391] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[396] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[401] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[406] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[411] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[416] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[421] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[426] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[431] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[436] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[441] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[446] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[451] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[456] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[461] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[466] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[471] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[476] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[481] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[486] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[491] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[496] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[501] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[506] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[511] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[516] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[521] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[526] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[531] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[536] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[541] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[546] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[551] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[556] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[561] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[566] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[571] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[576] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[581] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[586] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[591] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[596] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[601] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[606] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[611] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[616] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[621] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[626] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[631] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[636] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[641] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[646] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[651] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[656] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[661] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[666] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[671] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[676] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[681] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[686] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[691] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[696] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[701] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[706] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[711] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[716] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[721] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[726] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[731] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[736] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[741] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[746] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[751] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[756] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[761] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[766] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[771] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[776] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[781] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[786] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[791] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[796] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[801] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[806] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[811] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[816] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[821] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[826] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[831] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[836] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[841] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[846] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[851] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[856] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[861] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[866] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[871] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[876] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[881] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[886] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[891] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[896] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[901] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[906] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[911] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[916] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[921] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[926] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT ... TRIANGLE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">st_bbox</span>(admin_boundaries_raw))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      xmin       ymin       xmax       ymax 
 97.343358   5.613038 105.636965  20.465074 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove Z and M dimensions from the admin boundaries dataset</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>admin_boundaries_raw <span class="ot">&lt;-</span> <span class="fu">st_zm</span>(admin_boundaries_raw, <span class="at">drop =</span> <span class="cn">TRUE</span>, <span class="at">what =</span> <span class="st">"ZM"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for Invalid Geometries</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>invalid_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">st_is_valid</span>(admin_boundaries_raw))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Number of invalid geometries:"</span>, invalid_count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Number of invalid geometries: 0"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean and Transform Data</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>admin_boundaries_cleaned <span class="ot">&lt;-</span> admin_boundaries_raw <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">32647</span>) </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Provide Summary of the Cleaned Dataset</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Summary of the cleaned dataset:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Summary of the cleaned dataset:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(admin_boundaries_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Shape_Leng        Shape_Area          ADM2_EN            ADM2_TH         
 Min.   :0.05123   Min.   :0.0001177   Length:928         Length:928        
 1st Qu.:0.86613   1st Qu.:0.0195873   Class :character   Class :character  
 Median :1.22369   Median :0.0379046   Mode  :character   Mode  :character  
 Mean   :1.31536   Mean   :0.0467710                                        
 3rd Qu.:1.68395   3rd Qu.:0.0629092                                        
 Max.   :4.34007   Max.   :0.4075191                                        
  ADM2_PCODE          ADM2_REF          ADM2ALT1EN         ADM2ALT2EN       
 Length:928         Length:928         Length:928         Length:928        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
  ADM2ALT1TH         ADM2ALT2TH          ADM1_EN            ADM1_TH         
 Length:928         Length:928         Length:928         Length:928        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
  ADM1_PCODE          ADM0_EN            ADM0_TH           ADM0_PCODE       
 Length:928         Length:928         Length:928         Length:928        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
      date               validOn              validTo          
 Min.   :2019-02-18   Min.   :2022-01-22   Min.   :-001-11-30  
 1st Qu.:2019-02-18   1st Qu.:2022-01-22   1st Qu.:-001-11-30  
 Median :2019-02-18   Median :2022-01-22   Median :-001-11-30  
 Mean   :2019-02-18   Mean   :2022-01-22   Mean   :-001-11-30  
 3rd Qu.:2019-02-18   3rd Qu.:2022-01-22   3rd Qu.:-001-11-30  
 Max.   :2019-02-18   Max.   :2022-01-22   Max.   :-001-11-30  
          geometry  
 MULTIPOLYGON :928  
 epsg:32647   :  0  
 +proj=utm ...:  0  
                    
                    
                    </code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>The following columns that provide information on the administrative area can be retained, such as:</p>
<ul>
<li><p><code>ADM2_EN</code> (English name of the second-level administrative boundary)</p></li>
<li><p><code>ADM1_EN</code> (English name of the first-level boundary, e.g., province)</p></li>
<li><p><code>ADM0_EN</code> (country name)</p></li>
<li><p><code>ADM2_PCODE</code> (second-level administrative boundary code)</p></li>
<li><p><code>geometry</code> (spatial information in MULTIPOLYGON format)</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>admin_boundaries_filtered <span class="ot">&lt;-</span> admin_boundaries_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ADM2_EN, ADM1_EN, ADM0_EN, ADM2_PCODE, geometry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>:::</p>
</section>
<section id="define-and-filter-bangkok-metropolitan-region-bmr" class="level3" data-number="5.4">
<h3 data-number="5.4" class="anchored" data-anchor-id="define-and-filter-bangkok-metropolitan-region-bmr"><span class="header-section-number">5.4</span> Define and filter <a href="https://en.wikipedia.org/wiki/Bangkok_Metropolitan_Region">Bangkok Metropolitan Region (BMR)</a></h3>
<p>The <strong>Bangkok Metropolitan Region (BMR)</strong> consists of six key provinces located in the central part of Thailand. These provinces include:</p>
<ul>
<li><p><strong>Bangkok (Metropolis)</strong>,</p></li>
<li><p><strong>Nonthaburi</strong>,</p></li>
<li><p><strong>Samut Prakan</strong>,</p></li>
<li><p><strong>Pathum Thani</strong>,</p></li>
<li><p><strong>Samut Sakhon</strong>, and</p></li>
<li><p><strong>Nakhon Pathom</strong>.</p></li>
</ul>
<p>Together, these regions represent the most urbanized and densely populated areas in Thailand. Bangkok serves as the central hub, with surrounding provinces supporting residential, commercial, and industrial activities. The BMR plays a crucial role in Thailand’s economy, infrastructure, and governance, making it a significant focal point for urban planning and transportation networks.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List of provinces in Bangkok Metropolitan Region (BMR)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>bmr_provinces <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Bangkok"</span>, <span class="st">"Nonthaburi"</span>, <span class="st">"Nakhon Pathom"</span>, <span class="st">"Pathum Thani"</span>, <span class="st">"Samut Prakan"</span>, <span class="st">"Samut Sakhon"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Firstly, let’s filter <code>acc</code> dataset to consist accidents only of BMR provinces.</p>
<p>Once the filter is applied, we can inspect the filtered dataset using <code>head(accidents_bmr)</code> to verify that only accidents from the BMR provinces are included.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the accident dataset for only BMR provinces</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>accidents_bmr <span class="ot">&lt;-</span> accidents_filtered <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(province_en <span class="sc">%in%</span> bmr_provinces)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># View the filtered dataset</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(accidents_bmr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 6 features and 15 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 627012.3 ymin: 1502876 xmax: 693488.9 ymax: 1533381
Projected CRS: WGS 84 / UTM zone 47N
# A tibble: 6 × 16
  acc_code incident_datetime   Month_num Month_fac dayofweek province_en  
     &lt;dbl&gt; &lt;dttm&gt;                  &lt;dbl&gt; &lt;ord&gt;         &lt;int&gt; &lt;chr&gt;        
1   571882 2019-01-01 02:25:00         1 Jan               1 Nakhon Pathom
2   600001 2019-01-01 03:00:00         1 Jan               1 Nonthaburi   
3   605043 2019-01-01 03:00:00         1 Jan               1 Samut Prakan 
4   629691 2019-01-01 03:05:00         1 Jan               1 Bangkok      
5   571887 2019-01-01 04:30:00         1 Jan               1 Nakhon Pathom
6   599234 2019-01-01 04:45:00         1 Jan               1 Samut Prakan 
# ℹ 10 more variables: vehicle_type &lt;chr&gt;, presumed_cause &lt;chr&gt;,
#   accident_type &lt;chr&gt;, number_of_vehicles_involved &lt;dbl&gt;,
#   number_of_fatalities &lt;dbl&gt;, number_of_injuries &lt;dbl&gt;,
#   weather_condition &lt;chr&gt;, road_description &lt;chr&gt;, slope_description &lt;chr&gt;,
#   geometry &lt;POINT [m]&gt;</code></pre>
</div>
</div>
<p>In this step, we utilize the <strong>Thailand Administrative Boundaries dataset</strong>, which contains detailed geospatial information for all provinces in Thailand. By applying a filter, the dataset is restricted to the six provinces within the Bangkok Metropolitan Region (BMR). This process ensures that the analysis only focuses on these regions, excluding other areas of Thailand. By isolating the BMR boundaries, further geospatial analyses—such as spatial joins and road infrastructure studies—can be accurately conducted within this concentrated urban zone.</p>
<p>We verify the class of ‘admin_boundaries_filtered’.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(admin_boundaries_filtered)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sf"         "data.frame"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the 'admin_boundaries_cleaned' dataset to keep only BMR provinces</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>admin_boundaries_bmr <span class="ot">&lt;-</span> admin_boundaries_filtered <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ADM1_EN <span class="sc">%in%</span> bmr_provinces)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <strong>Thailand Roads dataset</strong> is a comprehensive geospatial dataset that details the road networks throughout the country. After reading the dataset, a spatial join is performed to integrate the filtered BMR administrative boundaries with the roads data. This spatial join ensures that only the road segments located within the defined BMR boundaries are retained for analysis. This step is crucial for focusing the study on the traffic networks within the Bangkok Metropolitan Region, allowing for specific analyses such as traffic flow, accident-prone areas, and infrastructure planning within the urban and suburban contexts of the BMR.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Create a bounding box for the BMR area</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>bmr_bbox <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(admin_boundaries_bmr)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Simplify the BMR boundaries for faster processing</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>admin_boundaries_bmr_simplified <span class="ot">&lt;-</span> <span class="fu">st_simplify</span>(admin_boundaries_bmr, <span class="at">dTolerance =</span> <span class="dv">100</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Use st_crop to pre-filter roads based on the bounding box (faster)</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>roads_filtered_bbox <span class="ot">&lt;-</span> <span class="fu">st_crop</span>(roads_filtered, bmr_bbox)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Perform the spatial join with the filtered roads</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>roads_bmr <span class="ot">&lt;-</span> <span class="fu">st_join</span>(roads_filtered, admin_boundaries_bmr_simplified, <span class="at">join =</span> st_within, <span class="at">left =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="plotting-the-geospatial-data" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="plotting-the-geospatial-data"><span class="header-section-number">6</span> Plotting the Geospatial Data</h2>
<p>Here’s how to we can plot the <code>accidents_bmr</code>, <code>admin_boundaries_bmr</code>, and <code>roads_bmr</code> using tmap.</p>
<p>As before, we need to ensure that the <code>accidents_bmr</code>, <code>admin_boundaries_bmr</code>, and <code>roads_bmr</code> datasets are all in the same CRS.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>admin_boundaries_bmr <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(admin_boundaries_bmr, <span class="at">crs =</span> <span class="dv">32647</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>roads_bmr <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(roads_bmr, <span class="at">crs =</span> <span class="dv">32647</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>accidents_bmr <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(accidents_bmr, <span class="at">crs =</span> <span class="dv">32647</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can then create a thematic map with <code>tmap</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a thematic map with tmap</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(admin_boundaries_bmr_simplified) <span class="sc">+</span>   </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span>   </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(roads_bmr) <span class="sc">+</span>         </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">"brown"</span>, <span class="at">lwd =</span> <span class="fl">0.5</span>) <span class="sc">+</span>     </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(accidents_bmr) <span class="sc">+</span>         </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"number_of_fatalities"</span>,    </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"Reds"</span>, </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.1</span>, </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Fatalities"</span>) <span class="sc">+</span>             </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Road Accidents in Bangkok Metropolitan Region (BMR)"</span>,</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="spatial-distribution-of-road-fatalities-in-bangkok-metropolitan-region" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="spatial-distribution-of-road-fatalities-in-bangkok-metropolitan-region"><span class="header-section-number">6.1</span> Spatial Distribution of Road Fatalities in Bangkok Metropolitan Region</h3>
<p>To display the number of fatalities in each region, we will calculate the total number of fatalities for each administrative region and then update the map to reflect this in the tm_fill() function. Here’s how we can proceed:</p>
<p><strong>Step 1: Aggregate the number of fatalities per region</strong></p>
<p>We will group <code>accident</code> data by region and sum the number of fatalities for each region.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to a regular data frame</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>accidents_bmr_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(accidents_bmr)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the column</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>accidents_bmr_df <span class="ot">&lt;-</span> accidents_bmr_df <span class="sc">%&gt;%</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">:::</span><span class="fu">rename.data.frame</span>(<span class="at">ADM1_EN =</span> province_en)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert back to an sf object</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>accidents_bmr <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(accidents_bmr_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate fatalities by region</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>fatalities_by_region <span class="ot">&lt;-</span> accidents_bmr <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADM1_EN) <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_fatalities =</span> <span class="fu">sum</span>(number_of_fatalities, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Step 2: Join this aggregated data with your boundaries data</strong></p>
<p>Next, join the aggregated fatalities data to your BMR boundaries:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert fatalities_by_region to a regular data frame if needed</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>fatalities_by_region_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(fatalities_by_region)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a non-spatial left join to join the data with your boundaries</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>admin_boundaries_bmr <span class="ot">&lt;-</span> admin_boundaries_bmr_simplified <span class="sc">%&gt;%</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(fatalities_by_region_df, <span class="at">by =</span> <span class="st">"ADM1_EN"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Step 3: Update map to show the number of fatalities</strong></p>
<p>Now, modify the <code>tm_fill()</code> function to reflect the total fatalities in each region:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a thematic map showing the number of fatalities per region</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(admin_boundaries_bmr) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"total_fatalities"</span>,  <span class="co"># Column to display</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"Reds"</span>,          <span class="co"># Color palette</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Total Fatalities"</span>) <span class="sc">+</span> <span class="co"># Legend title</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(accidents_bmr) <span class="sc">+</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Total Fatalities in BMR"</span>,</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The thematic map produced displays the <strong>total fatalities</strong> across the <strong>BMR</strong>, with the number of fatalities color-coded by region. The red dots represent individual accident locations, and the underlying color gradient indicates the total fatalities aggregated by region.</p>
<p><strong>Key Observations:</strong></p>
<ol type="1">
<li><p><strong>High Fatality Regions</strong>:</p>
<ul>
<li>The northern part of the BMR, particularly regions like <strong>Nonthaburi</strong>, <strong>Nakhon Pathom</strong>, and parts of <strong>Bangkok</strong>, are represented with darker shades of red, indicating these areas have the highest total fatalities, falling within the 150–250 range.</li>
</ul></li>
<li><p><strong>Moderate Fatality Regions</strong>:</p>
<ul>
<li>Regions like <strong>Samut Prakan</strong> and parts of <strong>Pathum Thani</strong> show moderate total fatalities, ranging from <strong>100 to 150</strong>.</li>
</ul></li>
<li><p><strong>Low Fatality Regions</strong>:</p>
<ul>
<li>The southern regions, such as <strong>Samut Sakhon</strong>, have relatively lower total fatalities, indicated by lighter shades of red.</li>
</ul></li>
</ol>
<p>Let’s investigate the underlying causes of road accidents in these regions. Here could be some of the reasons:</p>
<ul>
<li><p><strong>Risk Behaviors in Different Travel Modes</strong>: A study conducted in the BMR highlights that different modes of travel, such as motorcycles, cars, and public transportation, carry varying levels of risk perception. Vulnerable road users like pedestrians and cyclists tend to be more aware of risky behaviors than those driving cars or motorcycles. This is crucial since most accidents in Bangkok involve motorcycles, which are more vulnerable to high fatality rates​ (<a href="https://structurae.net/en/literature/journal-article/analysis-of-road-users-risk-behaviors-in-different-travel-modes-the-bangkok-metropolitan-region-thailand">Structurae</a>).</p></li>
<li><p><strong>Weather conditions:</strong> It does have a significant impact on road accidents in the BMR. Rain, in particular, leads to increased risks due to slippery roads and reduced visibility. Heavy rainfall can cause dangerous driving conditions such as hydroplaning and longer braking distances, which lead to higher accident rates. Furthermore, flooding, which is common in Bangkok during monsoon seasons, exacerbates these dangers by making certain roads impassable or more dangerous to navigate, leading to crashes or vehicle damage (<a href="https://www.mdpi.com/2412-3811/8/4/79">MDPI</a>).</p></li>
<li><p><strong>Seasonal Accident Trends</strong>: The number of accidents in Thailand tends to spike during specific periods like the New Year and Songkran festivals. While accident rates have gradually decreased over the years, the high involvement of motorcycles remains a constant challenge. Studies report that nearly 80% of accidents during these peak periods involve motorcycles, further highlighting the vulnerability of two-wheeler users ​(<a href="https://www.thaiwebsites.com/caraccidents.asp">ThaiWebsites</a>).</p></li>
<li><p><strong>Contributing Factors</strong>: Key factors like road design, driver behavior, and enforcement of traffic laws play significant roles in accidents. In Bangkok, accidents tend to occur more frequently on straight road sections​ (<a href="https://www.thaiwebsites.com/caraccidents.asp">ThaiWebsites</a>). This is compounded by driver fatigue, drug use, and reckless driving, which are common causes of accidents​ (<a href="https://structurae.net/en/literature/journal-article/analysis-of-road-users-risk-behaviors-in-different-travel-modes-the-bangkok-metropolitan-region-thailand">Structurae</a>).</p></li>
</ul>
</section>
</section>
<section id="visualizing-spatio-temporal-dynamics-of-road-accidents" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="visualizing-spatio-temporal-dynamics-of-road-accidents"><span class="header-section-number">7</span> Visualizing Spatio-Temporal Dynamics of Road Accidents</h2>
<section id="risk-behaviors-in-different-travel-modes" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="risk-behaviors-in-different-travel-modes"><span class="header-section-number">7.1</span> Risk Behaviors in Different Travel Modes</h3>
<p><strong>Classify the different travel modes</strong></p>
<ul>
<li><p><strong>Identify modes of transport</strong>: Use the column in your accident data that lists vehicle types (e.g., “vehicle_type”).</p></li>
<li><p><strong>Filter for key modes</strong>: Extract data for motorcycles, cars, and public transport. This will allow you to isolate accidents involving these different modes of travel.</p></li>
<li><p><strong>Geospatial Analysis</strong>: Using the boundaries and road network, spatially analyze where accidents involving motorcycles, cars, and public transport occur. This can highlight spatial patterns of risk behavior for each mode.</p></li>
</ul>
<p>Use <code>filter</code> in R to classify accidents based on vehicle types:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reclassify vehicle types based on the image into distinct categories</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>pickup_truck_accidents <span class="ot">&lt;-</span> <span class="fu">filter</span>(accidents_bmr, vehicle_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"4-wheel pickup truck"</span>, <span class="st">"passenger pickup truck"</span>))</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>light_truck_accidents <span class="ot">&lt;-</span> <span class="fu">filter</span>(accidents_bmr, vehicle_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"6-wheel truck"</span>, <span class="st">"7-10-wheel truck"</span>))</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>heavy_truck_accidents <span class="ot">&lt;-</span> <span class="fu">filter</span>(accidents_bmr, vehicle_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"large truck with trailer"</span>, <span class="st">"tractor/agricultural vehicle"</span>))</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>motorcycle_accidents <span class="ot">&lt;-</span> <span class="fu">filter</span>(accidents_bmr, vehicle_type <span class="sc">==</span> <span class="st">"motorcycle"</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>car_accidents <span class="ot">&lt;-</span> <span class="fu">filter</span>(accidents_bmr, vehicle_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"private/passenger car"</span>, <span class="st">"van"</span>))</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>bus_accidents <span class="ot">&lt;-</span> <span class="fu">filter</span>(accidents_bmr, vehicle_type <span class="sc">==</span> <span class="st">"large passenger vehicle"</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>bicycle_accidents <span class="ot">&lt;-</span> <span class="fu">filter</span>(accidents_bmr, vehicle_type <span class="sc">==</span> <span class="st">"bicycle"</span>)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>pedestrian_accidents <span class="ot">&lt;-</span> <span class="fu">filter</span>(accidents_bmr, vehicle_type <span class="sc">==</span> <span class="st">"pedestrian"</span>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>other_accidents <span class="ot">&lt;-</span> <span class="fu">filter</span>(accidents_bmr, vehicle_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"motorized tricycle"</span>, <span class="st">"other"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Identify High-Risk Road Sections:</strong></p>
<ul>
<li><strong>Spatial point pattern analysis</strong>: Examine <strong>accident hotspots</strong> for each travel mode using Kernel Density Estimation (KDE). This can reveal high-risk road sections for different travel modes.</li>
<li><strong>Overlay accidents on road network</strong>: Use the <strong>road data</strong> (e.g., road type, surface quality, width) to analyze how specific road conditions impact accident risk for different modes.</li>
</ul>
<p><strong>Car accidents</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure Car accidents are an sf object</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>car_accidents_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(car_accidents)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(admin_boundaries_bmr_simplified) <span class="sc">+</span>  <span class="co"># BMR boundaries</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># Add borders for the regions</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"ADM1_EN"</span>, <span class="at">palette =</span> <span class="st">"Set3"</span>, <span class="at">title =</span> <span class="st">"BMR Regions"</span>) <span class="sc">+</span>  <span class="co"># Fill regions by name</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(car_accidents_sf) <span class="sc">+</span>  <span class="co"># Add car accident points</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span>  <span class="co"># Red dots for accident locations</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(roads_bmr) <span class="sc">+</span>  <span class="co"># Add road network (no tm_raster, as it's a line)</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">"brown"</span>, <span class="at">lwd =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span>  </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Car Accident in BMR"</span>, <span class="at">legend.outside =</span> <span class="cn">TRUE</span>)  <span class="co"># Layout settings</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Pickup Truck accidents</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure Pickup Truck accidents are an sf object</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>pickup_truck_accidents_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(pickup_truck_accidents)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(admin_boundaries_bmr_simplified) <span class="sc">+</span>  <span class="co"># BMR boundaries</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># Add borders for the regions</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"ADM1_EN"</span>, <span class="at">palette =</span> <span class="st">"Set3"</span>, <span class="at">title =</span> <span class="st">"BMR Regions"</span>) <span class="sc">+</span>  <span class="co"># Fill regions by name</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(pickup_truck_accidents_sf) <span class="sc">+</span>  <span class="co"># Add pick up truck accident points</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span>  <span class="co"># Red dots for accident locations</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(roads_bmr) <span class="sc">+</span>  <span class="co"># Add road network (no tm_raster, as it's a line)</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">"brown"</span>, <span class="at">lwd =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span>  </span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Pickup Truck Accident in BMR"</span>, <span class="at">legend.outside =</span> <span class="cn">TRUE</span>)  <span class="co"># Layout settings</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Motorcycle accidents</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure motorcycle accidents are an sf object</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>motorcycle_accidents_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(motorcycle_accidents)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(admin_boundaries_bmr_simplified) <span class="sc">+</span>  <span class="co"># BMR boundaries</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># Add borders for the regions</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"ADM1_EN"</span>, <span class="at">palette =</span> <span class="st">"Set3"</span>, <span class="at">title =</span> <span class="st">"BMR Regions"</span>) <span class="sc">+</span>  <span class="co"># Fill regions by name</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(motorcycle_accidents_sf) <span class="sc">+</span>  <span class="co"># Add motorcycle accident points</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span>  <span class="co"># Red dots for accident locations</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(roads_bmr) <span class="sc">+</span>  <span class="co"># Add road network (no tm_raster, as it's a line)</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">"brown"</span>, <span class="at">lwd =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span>  </span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Motorcycle Accident in BMR"</span>, <span class="at">legend.outside =</span> <span class="cn">TRUE</span>)  <span class="co"># Layout settings</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The analysis of the top three vehicle types involved in accidents in the BMR is as follows:</p>
<ol type="1">
<li><p><strong>Cars</strong>:</p>
<ul>
<li>Private or passenger cars constitute the largest portion of vehicles involved in accidents. This finding is consistent with the high prevalence of private cars on the road. In urban environments like Bangkok, car congestion, driver distractions, and speeding could all contribute to the higher accident rate. The dense traffic conditions and complex road networks, including narrow streets and frequent intersections, could lead to a higher likelihood of collisions involving passenger vehicles.</li>
</ul></li>
<li><p><strong>Pickup Truck accidents</strong>:</p>
<ul>
<li>Pickup trucks come in second. Pickup trucks are popular for both personal and commercial use in Thailand, making them a significant part of road traffic. Their larger size compared to private cars can also be a factor in more severe accidents, particularly in high-speed zones or when maneuvering through tight urban roads. Furthermore, the high usage of pickup trucks for goods transportation, often overloaded, can increase risks, especially on highways or rural roads leading into the metropolitan area.</li>
</ul></li>
<li><p><strong>Motorcycles</strong>:</p>
<ul>
<li>Motorcycles rank third. Despite being the third most common type in the dataset, motorcycles are particularly vulnerable due to the lack of protective barriers for the driver and passengers. In many cases, motorcycle accidents result in higher fatality rates compared to cars or trucks. The high number of motorcycles on the road in Bangkok, combined with factors like weaving through traffic, poor visibility in certain weather conditions, and risky driving behavior, may explain their high involvement in road accidents.</li>
</ul></li>
</ol>
<p>The dominance of private cars, pickup trucks, and motorcycles in accident statistics underscores the need for targeted safety measures. For private cars and pickup trucks, enhancing road infrastructure, promoting safer driving practices, and enforcing traffic laws are essential. For motorcycles, encouraging the use of protective gear, increasing awareness about the dangers of risky driving behaviors, and developing safer motorcycle lanes could help reduce accidents and fatalities. Additionally, analyzing accident hotspots and times (such as peak traffic hours) could provide insights for reducing accident rates among these top vehicle types.</p>
</section>
<section id="weather-conditions" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="weather-conditions"><span class="header-section-number">7.2</span> Weather conditions</h3>
<section id="spatial-distribution-by-weather-condition" class="level4" data-number="7.2.1">
<h4 data-number="7.2.1" class="anchored" data-anchor-id="spatial-distribution-by-weather-condition"><span class="header-section-number">7.2.1</span> Spatial Distribution by Weather Condition</h4>
<p>We overlay traffic accidents filtered by weather conditions (clear, dark, rainy, etc.) on the BMR map, showing which regions experience higher fatalities or injuries under different weather conditions.</p>
<ul>
<li><p><strong>Use filtering</strong>: Filter accidents by weather conditions in your dataset.</p></li>
<li><p><strong>Dot maps</strong>: Overlay dots representing accidents on the BMR map, colored by weather condition.</p></li>
</ul>
<p><strong>By number of accidents</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter accidents based on weather conditions</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>clear_accidents <span class="ot">&lt;-</span> <span class="fu">filter</span>(accidents_bmr, weather_condition <span class="sc">==</span> <span class="st">"clear"</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>rainy_accidents <span class="ot">&lt;-</span> <span class="fu">filter</span>(accidents_bmr, weather_condition <span class="sc">==</span> <span class="st">"rainy"</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>dark_accidents <span class="ot">&lt;-</span> <span class="fu">filter</span>(accidents_bmr, weather_condition <span class="sc">==</span> <span class="st">"dark"</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>foggy_accidents <span class="ot">&lt;-</span> <span class="fu">filter</span>(accidents_bmr, weather_condition <span class="sc">==</span> <span class="st">"foggy"</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>landslide_accidents <span class="ot">&lt;-</span> <span class="fu">filter</span>(accidents_bmr, weather_condition <span class="sc">==</span> <span class="st">"land slide"</span>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>natural_disaster_accidents <span class="ot">&lt;-</span> <span class="fu">filter</span>(accidents_bmr, weather_condition <span class="sc">==</span> <span class="st">"natural disaster"</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>other_accidents <span class="ot">&lt;-</span> <span class="fu">filter</span>(accidents_bmr, weather_condition <span class="sc">==</span> <span class="st">"other"</span>)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create map combining regions, roads, and weather conditions</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(admin_boundaries_bmr_simplified) <span class="sc">+</span> </span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fill regions by name</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"ADM1_EN"</span>, <span class="at">palette =</span> <span class="st">"Set3"</span>, <span class="at">title =</span> <span class="st">"BMR Regions"</span>) <span class="sc">+</span> </span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span> </span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add roads</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(roads_bmr) <span class="sc">+</span>  <span class="co"># Add road network (no tm_raster, as it's a line)</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">"brown"</span>, <span class="at">lwd =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot accidents for each weather condition with different colors</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(clear_accidents) <span class="sc">+</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(rainy_accidents) <span class="sc">+</span></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(dark_accidents) <span class="sc">+</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(foggy_accidents) <span class="sc">+</span></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"purple"</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(landslide_accidents) <span class="sc">+</span></span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"green"</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(natural_disaster_accidents) <span class="sc">+</span></span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(other_accidents) <span class="sc">+</span></span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"yellow"</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a custom legend for weather conditions</span></span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_add_legend</span>(<span class="at">type =</span> <span class="st">"symbol"</span>,</span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"black"</span>, <span class="st">"purple"</span>, <span class="st">"green"</span>, <span class="st">"orange"</span>, <span class="st">"yellow"</span>),</span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Clear"</span>, <span class="st">"Rainy"</span>, <span class="st">"Dark"</span>, <span class="st">"Foggy"</span>, <span class="st">"Landslide"</span>, <span class="st">"Natural Disaster"</span>, <span class="st">"Other"</span>),</span>
<span id="cb58-46"><a href="#cb58-46" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">"Weather Conditions"</span>) <span class="sc">+</span></span>
<span id="cb58-47"><a href="#cb58-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-48"><a href="#cb58-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Layout settings</span></span>
<span id="cb58-49"><a href="#cb58-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Traffic Accidents by Weather in BMR with Regions and Roads"</span>, </span>
<span id="cb58-50"><a href="#cb58-50" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb58-51"><a href="#cb58-51" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>By number of fatalities</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create map for fatalities</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(admin_boundaries_bmr_simplified) <span class="sc">+</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fill regions by name</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"ADM1_EN"</span>, <span class="at">palette =</span> <span class="st">"Set3"</span>, <span class="at">title =</span> <span class="st">"BMR Regions"</span>) <span class="sc">+</span> </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span> </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add roads</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(roads_bmr) <span class="sc">+</span>  <span class="co"># Add road network (no tm_raster, as it's a line)</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">"brown"</span>, <span class="at">lwd =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot accidents with fatalities for each weather condition</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(clear_accidents) <span class="sc">+</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="st">"number_of_fatalities"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">title =</span> <span class="st">"Clear Weather (Fatalities)"</span>) <span class="sc">+</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(rainy_accidents) <span class="sc">+</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="st">"number_of_fatalities"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">title =</span> <span class="st">"Rainy Weather (Fatalities)"</span>) <span class="sc">+</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(dark_accidents) <span class="sc">+</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="st">"number_of_fatalities"</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">title =</span> <span class="st">"Dark Weather (Fatalities)"</span>) <span class="sc">+</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(foggy_accidents) <span class="sc">+</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="st">"number_of_fatalities"</span>, <span class="at">col =</span> <span class="st">"purple"</span>, <span class="at">title =</span> <span class="st">"Foggy Weather (Fatalities)"</span>) <span class="sc">+</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(landslide_accidents) <span class="sc">+</span></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="st">"number_of_fatalities"</span>, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">title =</span> <span class="st">"Landslide Weather (Fatalities)"</span>) <span class="sc">+</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(natural_disaster_accidents) <span class="sc">+</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="st">"number_of_fatalities"</span>, <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">title =</span> <span class="st">"Natural Disaster (Fatalities)"</span>) <span class="sc">+</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(other_accidents) <span class="sc">+</span></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="st">"number_of_fatalities"</span>, <span class="at">col =</span> <span class="st">"yellow"</span>, <span class="at">title =</span> <span class="st">"Other Weather (Fatalities)"</span>) <span class="sc">+</span></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a custom legend for weather conditions</span></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_add_legend</span>(<span class="at">type =</span> <span class="st">"symbol"</span>,</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"black"</span>, <span class="st">"purple"</span>, <span class="st">"green"</span>, <span class="st">"orange"</span>, <span class="st">"yellow"</span>),</span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Clear"</span>, <span class="st">"Rainy"</span>, <span class="st">"Dark"</span>, <span class="st">"Foggy"</span>, <span class="st">"Landslide"</span>, <span class="st">"Natural Disaster"</span>, <span class="st">"Other"</span>),</span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">"Weather Conditions"</span>) <span class="sc">+</span></span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Layout settings</span></span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Fatalities by Weather in BMR with Regions and Roads"</span>, </span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>By number of injuries</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create map for injuries</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(admin_boundaries_bmr_simplified) <span class="sc">+</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fill regions by name</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"ADM1_EN"</span>, <span class="at">palette =</span> <span class="st">"Set3"</span>, <span class="at">title =</span> <span class="st">"BMR Regions"</span>) <span class="sc">+</span> </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span> </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add roads</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(roads_bmr) <span class="sc">+</span>  <span class="co"># Add road network (no tm_raster, as it's a line)</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">"brown"</span>, <span class="at">lwd =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot accidents with injuries for each weather condition</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(clear_accidents) <span class="sc">+</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="st">"number_of_injuries"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">title =</span> <span class="st">"Clear Weather (Injuries)"</span>) <span class="sc">+</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(rainy_accidents) <span class="sc">+</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="st">"number_of_injuries"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">title =</span> <span class="st">"Rainy Weather (Injuries)"</span>) <span class="sc">+</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(dark_accidents) <span class="sc">+</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="st">"number_of_injuries"</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">title =</span> <span class="st">"Dark Weather (Injuries)"</span>) <span class="sc">+</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(foggy_accidents) <span class="sc">+</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="st">"number_of_injuries"</span>, <span class="at">col =</span> <span class="st">"purple"</span>, <span class="at">title =</span> <span class="st">"Foggy Weather (Injuries)"</span>) <span class="sc">+</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(landslide_accidents) <span class="sc">+</span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="st">"number_of_injuries"</span>, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">title =</span> <span class="st">"Landslide Weather (Injuries)"</span>) <span class="sc">+</span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(natural_disaster_accidents) <span class="sc">+</span></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="st">"number_of_injuries"</span>, <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">title =</span> <span class="st">"Natural Disaster (Injuries)"</span>) <span class="sc">+</span></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(other_accidents) <span class="sc">+</span></span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="st">"number_of_injuries"</span>, <span class="at">col =</span> <span class="st">"yellow"</span>, <span class="at">title =</span> <span class="st">"Other Weather (Injuries)"</span>) <span class="sc">+</span></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a custom legend for weather conditions</span></span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_add_legend</span>(<span class="at">type =</span> <span class="st">"symbol"</span>,</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"black"</span>, <span class="st">"purple"</span>, <span class="st">"green"</span>, <span class="st">"orange"</span>, <span class="st">"yellow"</span>),</span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Clear"</span>, <span class="st">"Rainy"</span>, <span class="st">"Dark"</span>, <span class="st">"Foggy"</span>, <span class="st">"Landslide"</span>, <span class="st">"Natural Disaster"</span>, <span class="st">"Other"</span>),</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">"Weather Conditions"</span>) <span class="sc">+</span></span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Layout settings</span></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Fatalities by Weather in BMR with Regions and Roads"</span>, </span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="temporal-analysis" class="level4" data-number="7.2.2">
<h4 data-number="7.2.2" class="anchored" data-anchor-id="temporal-analysis"><span class="header-section-number">7.2.2</span> Temporal Analysis</h4>
<p>We analyze how the frequency of accidents varies across different times of day, months, or years for various weather conditions. This can be achieved by:</p>
<ul>
<li><p><strong>Aggregating accident data by time period</strong> (hour, day, month, year) and weather condition.</p></li>
<li><p><strong>Time-series plots</strong>: Create time-series plots for each weather condition, showing the number of accidents over time.</p></li>
<li><p><strong>Heatmaps</strong>: Visualize accident frequencies across different times of day and months.</p></li>
</ul>
<p><strong>Step 1: Aggregating Accident Data by Time Period and Weather Condition</strong></p>
<p>We can aggregate the accident data by different time period such as hour, day, month, or year, and by weather condition.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data by month and weather condition</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>accidents_by_month_weather <span class="ot">&lt;-</span> accidents_bmr <span class="sc">%&gt;%</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">:::</span><span class="fu">group_by.data.frame</span>(Month_num, Month_fac, weather_condition) <span class="sc">%&gt;%</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_fatalities =</span> <span class="fu">sum</span>(number_of_fatalities, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_injuries =</span> <span class="fu">sum</span>(number_of_injuries, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate by hour and weather condition</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>accidents_by_hour_weather <span class="ot">&lt;-</span> accidents_bmr <span class="sc">%&gt;%</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hour =</span> lubridate<span class="sc">::</span><span class="fu">hour</span>(incident_datetime)) <span class="sc">%&gt;%</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hour, weather_condition) <span class="sc">%&gt;%</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_fatalities =</span> <span class="fu">sum</span>(number_of_fatalities, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_injuries =</span> <span class="fu">sum</span>(number_of_injuries, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Step 2: Time-Series Plots for Each Weather Condition</strong></p>
<p>We can create time-series plots to visualize the number of accidents over time (for instance, by hour or month).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Time-series plot of accidents by month and weather condition</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(accidents_by_month_weather, <span class="fu">aes</span>(<span class="at">x =</span> Month_num, <span class="at">y =</span> total_fatalities, <span class="at">color =</span> weather_condition, <span class="at">group =</span> weather_condition)) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Monthly Accidents by Weather Condition"</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>, <span class="at">y =</span> <span class="st">"Number of Fatalities"</span>) <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">labels =</span> <span class="fu">unique</span>(accidents_by_month_weather<span class="sc">$</span>Month)) <span class="sc">+</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Step 3: Heatmaps to Visualize Accident Frequencies</strong></p>
<p>We can create heatmaps to visualize accident frequencies across different times of day and months.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmap of accidents by hour and weather condition</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(accidents_by_hour_weather, <span class="fu">aes</span>(<span class="at">x =</span> hour, <span class="at">y =</span> weather_condition, <span class="at">fill =</span> total_fatalities)) <span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Accidents by Hour and Weather Condition"</span>,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hour"</span>, <span class="at">y =</span> <span class="st">"Weather Condition"</span>, <span class="at">fill =</span> <span class="st">"Fatalities"</span>) <span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"C"</span>) <span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="combining-spatial-temporal-analysis" class="level4" data-number="7.2.3">
<h4 data-number="7.2.3" class="anchored" data-anchor-id="combining-spatial-temporal-analysis"><span class="header-section-number">7.2.3</span> Combining Spatial &amp; Temporal Analysis</h4>
<p>Below shows how accidents evolve spatially over time under different weather conditions:</p>
<p>Ensure the dataset includes a <strong>temporal</strong> component (e.g., month, year) and spatial geometry (<code>sf</code> object). You can modify your existing <code>accidents_bmr</code> dataset if it’s not already in the correct format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'incident_datetime' to date format if not already</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>accidents_bmr <span class="ot">&lt;-</span> accidents_bmr <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">incident_datetime =</span> <span class="fu">as.POSIXct</span>(incident_datetime, <span class="at">format =</span> <span class="st">"%m/%d/%Y %H:%M"</span>))</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a 'month_year' column for easier temporal analysis</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>accidents_bmr <span class="ot">&lt;-</span> accidents_bmr <span class="sc">%&gt;%</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month_year =</span> <span class="fu">format</span>(incident_datetime, <span class="st">"%Y-%m"</span>))</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure that the dataset is an sf object</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>accidents_bmr_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(accidents_bmr, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can set up <code>tmap_animation()</code> to visualize the accident data across months or years while factoring in weather conditions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Switch to view mode for interactive animations </span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"view"</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the animated map</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_animation</span>(</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(accidents_bmr_sf) <span class="sc">+</span>  <span class="co"># Load accident data as sf object</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"weather_condition"</span>, <span class="at">palette =</span> <span class="st">"Set1"</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">title =</span> <span class="st">"Weather Conditions"</span>) <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">along =</span> <span class="st">"month_year"</span>, <span class="at">free.coords =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  <span class="co"># Create facets by month-year</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(admin_boundaries_bmr) <span class="sc">+</span>  <span class="co"># Add BMR boundaries</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># Add boundaries outline</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Accident Distribution Over Time by Weather Conditions in BMR"</span>,</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>),  <span class="co"># Layout settings for the map</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"accidents_bmr_animation.gif"</span>,  <span class="co"># Save as gif</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">600</span>, <span class="at">delay =</span> <span class="dv">60</span>  <span class="co"># Define gif size and frame delay</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="accidents_bmr_animation.gif" class="img-fluid"></p>
<p>From the analysis of the weather conditions and accidents in the BMR, we can observe a significant difference in the number of accidents under different weather conditions:</p>
<ol type="1">
<li><p><strong>Clear Weather</strong>:</p>
<ul>
<li><p>The vast majority of accidents, approximately 11,711 incidents, occur under clear weather conditions.</p></li>
<li><p>This indicates that even in optimal weather conditions with clear visibility and road conditions, accidents are still prevalent.</p></li>
<li><p>The map shows widespread distribution of these accidents across all regions of the BMR, with a noticeable concentration along major road networks and urban areas like Bangkok. The high volume of traffic and higher speed limits during clear weather may contribute to the increased number of accidents.</p></li>
</ul></li>
<li><p><strong>Rainy Weather</strong>:</p>
<ul>
<li><p>The second most common weather condition associated with accidents is rainy weather, with 1,166 incidents.</p></li>
<li><p>Rain increases the risk of accidents due to factors such as reduced visibility, slippery roads, and longer stopping distances.</p></li>
<li><p>The map shows clusters of accidents during rainy weather, particularly along major highways and arterial roads. Regions like Pathum Thani and Samut Prakan appear to have a higher density of accidents in rainy conditions, which may be due to the poor drainage systems or high traffic flow.</p></li>
</ul></li>
</ol>
<p><strong>Comparison:</strong></p>
<ul>
<li><p><strong>Clear vs.&nbsp;Rainy Conditions</strong>:</p>
<ul>
<li><p>While clear weather accounts for more accidents due to the higher volume of vehicles on the road and possibly higher speeds, rainy conditions present their own hazards. The number of accidents during rain, while lower, still shows that driving in adverse weather remains a significant risk factor, especially in certain regions.</p></li>
<li><p>Both conditions demonstrate the importance of maintaining road safety awareness regardless of weather, but special caution is needed during rain, as visibility and road conditions deteriorate.</p></li>
</ul></li>
</ul>
<p><strong>Key Takeaways:</strong></p>
<ul>
<li><p>In clear weather, driver behavior such as speeding and not paying attention may be primary factors for accidents.</p></li>
<li><p>In rainy weather, the road conditions become more challenging, and accidents might result from hydroplaning, reduced grip on the road, or poor visibility. It’s important to enforce road safety laws and awareness campaigns to reduce accidents in both conditions.</p></li>
</ul>
<p>The map visualizes how accidents are distributed based on weather conditions, helping to understand areas where interventions (like better road design or stricter enforcement) may be needed to reduce the risks.</p>
</section>
</section>
<section id="seasonal-accident-trends-analysis-new-year-and-songkran-festivals" class="level3" data-number="7.3">
<h3 data-number="7.3" class="anchored" data-anchor-id="seasonal-accident-trends-analysis-new-year-and-songkran-festivals"><span class="header-section-number">7.3</span> Seasonal Accident Trends Analysis (New Year and Songkran Festivals)</h3>
<section id="filter-accident-data-for-new-year-and-songkran" class="level4" data-number="7.3.1">
<h4 data-number="7.3.1" class="anchored" data-anchor-id="filter-accident-data-for-new-year-and-songkran"><span class="header-section-number">7.3.1</span> <strong>Filter Accident Data for New Year and Songkran:</strong></h4>
<p>We define the periods for the New Year and Songkran festivals in the dataset, then filter accidents that occurred during those times. The New Year generally spans from the 31st of December to the 2nd of January, and Songkran typically runs from the 13th to the 15th of April.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define New Year and Songkran periods</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>new_year_period <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"12-31"</span>, <span class="st">"01-01"</span>, <span class="st">"01-02"</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>songkran_period <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"04-13"</span>, <span class="st">"04-14"</span>, <span class="st">"04-15"</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert incident_datetime to Date format and extract the month-day part for comparison</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>accidents_bmr<span class="sc">$</span>month_day <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">as.Date</span>(accidents_bmr<span class="sc">$</span>incident_datetime), <span class="st">"%m-%d"</span>)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for New Year accidents</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>new_year_accidents <span class="ot">&lt;-</span> accidents_bmr <span class="sc">%&gt;%</span> </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month_day <span class="sc">%in%</span> new_year_period)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Songkran accidents</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>songkran_accidents <span class="ot">&lt;-</span> accidents_bmr <span class="sc">%&gt;%</span> </span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month_day <span class="sc">%in%</span> songkran_period)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine both festivals</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>festival_accidents <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(new_year_accidents, songkran_accidents)</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics for both festivals</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>festival_summary <span class="ot">&lt;-</span> festival_accidents <span class="sc">%&gt;%</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vehicle_type) <span class="sc">%&gt;%</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">fatalities =</span> <span class="fu">sum</span>(number_of_fatalities, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">injuries =</span> <span class="fu">sum</span>(number_of_injuries, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualizing-accident-trends" class="level4" data-number="7.3.2">
<h4 data-number="7.3.2" class="anchored" data-anchor-id="visualizing-accident-trends"><span class="header-section-number">7.3.2</span> <strong>Visualizing Accident Trends:</strong></h4>
<p>You can create time-series plots to analyze accident trends during New Year and Songkran festivals for various vehicle types, particularly motorcycles, which are more involved in accidents during these periods.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing the time series trend of accidents during festivals by vehicle type</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(festival_accidents, <span class="fu">aes</span>(<span class="at">x =</span> incident_datetime, <span class="at">fill =</span> vehicle_type)) <span class="sc">+</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">86400</span>) <span class="sc">+</span> <span class="co"># binwidth of one day</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Accident Trends During New Year and Songkran Festivals"</span>,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Accidents"</span>) <span class="sc">+</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> vehicle_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="heatmaps-for-time-of-day-or-day-of-week" class="level4" data-number="7.3.3">
<h4 data-number="7.3.3" class="anchored" data-anchor-id="heatmaps-for-time-of-day-or-day-of-week"><span class="header-section-number">7.3.3</span> <strong>Heatmaps for Time of Day or Day of Week:</strong></h4>
<p>A heatmap can show accident frequencies during different times of the day or days of the week for these festival periods.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure incident_datetime is properly formatted and extract hour and day</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>festival_accidents<span class="sc">$</span>hour <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">as.POSIXct</span>(festival_accidents<span class="sc">$</span>incident_datetime), <span class="st">"%H"</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>festival_accidents<span class="sc">$</span>day <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">as.POSIXct</span>(festival_accidents<span class="sc">$</span>incident_datetime), <span class="st">"%A"</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert hour and day to factors (if necessary)</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>festival_accidents<span class="sc">$</span>hour <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(festival_accidents<span class="sc">$</span>hour)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>festival_accidents<span class="sc">$</span>day <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(festival_accidents<span class="sc">$</span>day)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summary data frame with counts</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>accident_summary <span class="ot">&lt;-</span> festival_accidents <span class="sc">%&gt;%</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hour, day) <span class="sc">%&gt;%</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the heatmap</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(accident_summary, <span class="fu">aes</span>(<span class="at">x =</span> hour, <span class="at">y =</span> day, <span class="at">fill =</span> count)) <span class="sc">+</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"lightblue"</span>, <span class="at">high =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Accident Heatmap by Hour and Day During New Year and Songkran"</span>,</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hour of the Day"</span>,</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Day of the Week"</span>,</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Number of Accidents"</span>) <span class="sc">+</span></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="mapping-the-accidents-spatial-distribution" class="level4" data-number="7.3.4">
<h4 data-number="7.3.4" class="anchored" data-anchor-id="mapping-the-accidents-spatial-distribution"><span class="header-section-number">7.3.4</span> <strong>Mapping the Accidents (Spatial Distribution):</strong></h4>
<p>To analyze spatial trends during the festivals, we map the accidents for New Year and Songkran festivals using tmap:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the accidents during festivals on a map</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(admin_boundaries_bmr_simplified) <span class="sc">+</span> </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(festival_accidents) <span class="sc">+</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"vehicle_type"</span>, <span class="at">palette =</span> <span class="st">"Set1"</span>, <span class="at">title =</span> <span class="st">"Vehicle Type"</span>) <span class="sc">+</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Accidents During Festivals (New Year &amp; Songkran) in BMR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="other-contributing-factors" class="level3" data-number="7.4">
<h3 data-number="7.4" class="anchored" data-anchor-id="other-contributing-factors"><span class="header-section-number">7.4</span> Other Contributing Factors</h3>
<section id="road-design-analysis" class="level4" data-number="7.4.1">
<h4 data-number="7.4.1" class="anchored" data-anchor-id="road-design-analysis"><span class="header-section-number">7.4.1</span> Road Design Analysis</h4>
<p>Here’s how we can prepare, filter, and aggregate the accident data by road description, followed by combining this analysis with fatalities and injuries for each type of road.</p>
<p><strong>Step 1: Aggregate Fatalities and Injuries by Road Type</strong></p>
<p>Now, aggregate the number of fatalities and injuries for each type of road, similar to the table you shared.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate fatalities and injuries by road type</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>road_aggregated <span class="ot">&lt;-</span> accidents_bmr <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(road_description) <span class="sc">%&gt;%</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_fatalities =</span> <span class="fu">sum</span>(number_of_fatalities, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_injuries =</span> <span class="fu">sum</span>(number_of_injuries, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_fatalities))</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="co"># View the aggregated data</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(road_aggregated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 14 features and 3 fields
Geometry type: MULTIPOINT
Dimension:     XY
Bounding box:  xmin: 591277.5 ymin: 1486846 xmax: 710166.1 ymax: 1576520
Projected CRS: WGS 84 / UTM zone 47N
# A tibble: 14 × 4
   road_description    total_fatalities total_injuries                  geometry
   &lt;chr&gt;                          &lt;dbl&gt;          &lt;dbl&gt;          &lt;MULTIPOINT [m]&gt;
 1 straight road                    639           6249 ((591277.5 1545514), (59…
 2 other                             89            539 ((604914.7 1548870), (60…
 3 wide curve                        45            254 ((605960.9 1537813), (60…
 4 t-intersection                    22             63 ((599469.8 1542071), (61…
 5 y-intersection                     8             35 ((629514.6 1526365), (62…
 6 grade-separated in…                6             95 ((654173 1525967), (6560…
 7 sharp curve                        5             16 ((621201.3 1498072), (62…
 8 connecting to publ…                4             35 ((606712.6 1557002), (60…
 9 connecting to priv…                2              8 ((595545.3 1542719), (61…
10 four-way intersect…                2              4 ((616900.4 1556213), (62…
11 roundabout                         1              2 ((614608.3 1523654), (65…
12 connecting to scho…                0              4 ((646878.1 1550240), (66…
13 merge lane                         0              8 ((665780.8 1524036), (66…
14 u-turn area                        0              3 ((641181.3 1509733), (66…</code></pre>
</div>
</div>
<p><strong>Step 2: Visualize Accident Hotspots on Different Road Types</strong></p>
<p>For visualization, we can use <strong>kernel density estimation (KDE)</strong> and <strong>spatial analysis</strong> to show accident hotspots and how they are distributed across different road types like straight roads, intersections, etc.</p>
<p>This display the density on a map, with red dots representing accident locations on straight roads within the BMR.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for specific road types, e.g., straight roads</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>straight_road_accidents <span class="ot">&lt;-</span> accidents_bmr <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(road_description <span class="sc">==</span> <span class="st">"straight road"</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to a spatial object</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>straight_road_accidents_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(straight_road_accidents)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure the CRS is set correctly</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(straight_road_accidents_sf) <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(admin_boundaries_bmr_simplified)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to spatstat format for density estimation</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>window <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_bbox</span>(admin_boundaries_bmr_simplified))</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>straight_road_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_coordinates</span>(straight_road_accidents_sf), <span class="at">W =</span> window)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Kernel Density Estimation with adjusted parameters</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>straight_road_density <span class="ot">&lt;-</span> <span class="fu">density</span>(straight_road_ppp, <span class="at">sigma =</span> <span class="dv">100</span>, <span class="at">eps =</span> <span class="dv">50</span>, <span class="at">edge =</span> <span class="cn">TRUE</span>)</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the density output to a raster object</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>straight_road_density_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(straight_road_density)</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure raster and sf objects have the same CRS</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a><span class="fu">crs</span>(straight_road_density_raster) <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(admin_boundaries_bmr_simplified)<span class="sc">$</span>proj4string</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Straight road accident density</span></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(admin_boundaries_bmr_simplified) <span class="sc">+</span></span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add boundaries with semi-transparency</span></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(straight_road_density_raster) <span class="sc">+</span></span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="st">"-viridis"</span>, </span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">style =</span> <span class="st">"fisher"</span>,</span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="dv">9</span>,</span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">"Straight Road Accident Density"</span>,</span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(straight_road_accidents_sf) <span class="sc">+</span></span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.05</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(admin_boundaries_bmr_simplified) <span class="sc">+</span>  <span class="co"># Add boundaries again on top</span></span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Accident Density on Straight Roads in BMR"</span>,</span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.title.size =</span> <span class="fl">0.8</span>,</span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.text.size =</span> <span class="fl">0.6</span>,</span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"bottom"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The map shows the <strong>Kernel Density Estimation (KDE)</strong> of road accidents on straight roads in the BMR. KDE is a technique used to estimate the density of events (accidents in this case) over a geographical area. The heatmap overlay on the map helps identify areas where accidents are most concentrated.</p>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p><strong>High accident density on straight roads</strong>: The red dots represent accidents, and the colored density gradient (ranging from dark red to yellow) indicates accident density. The areas with darker red indicate higher concentrations of accidents.</p></li>
<li><p><strong>Focus on hotspots</strong>: These high-density areas could point to specific road conditions, traffic patterns, or driver behavior that make straight roads particularly risky in these locations.</p></li>
</ul>
<p>The observation that <strong>straight roads have the most accidents</strong> could be attributed to various factors such as high speed, inattentiveness, or driver fatigue, which are more common on long, straight sections of roads where drivers may feel more relaxed and less alert. These factors align with studies indicating that <strong>straight roads often lead to more severe accidents</strong>, especially at higher speeds. This analysis highlights the importance of focusing traffic safety measures, like speed controls and driver awareness programs, on these high-risk zones.</p>
</section>
<section id="further-analysis-on-driver-behavior-on-straight-road" class="level4" data-number="7.4.2">
<h4 data-number="7.4.2" class="anchored" data-anchor-id="further-analysis-on-driver-behavior-on-straight-road"><span class="header-section-number">7.4.2</span> Further analysis on driver behavior on straight road</h4>
<p><strong>Step 1: Descriptive Statistics of Accidents on Straight Roads</strong></p>
<ul>
<li><strong>Filter the accidents for straight roads</strong>: Use the existing dataset to filter out the accidents that occurred specifically on straight roads.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>straight_road_accidents <span class="ot">&lt;-</span> <span class="fu">filter</span>(accidents_bmr, road_description <span class="sc">==</span> <span class="st">"straight road"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong>Summarize the causes of accidents</strong>: Aggregate the data by the presumed cause of accidents on straight roads to identify the primary causes. This will give you a breakdown of accidents on straight roads by cause, fatalities, and injuries.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate accident counts by presumed cause</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>straight_road_accident_causes_aggregated <span class="ot">&lt;-</span> straight_road_accidents <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(presumed_cause) <span class="sc">%&gt;%</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_accidents =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_accidents))</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View the aggregated data in descending order</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(straight_road_accident_causes_aggregated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 36 features and 2 fields
Geometry type: GEOMETRY
Dimension:     XY
Bounding box:  xmin: 591277.5 ymin: 1486846 xmax: 710166.1 ymax: 1576520
Projected CRS: WGS 84 / UTM zone 47N
# A tibble: 36 × 3
   presumed_cause                      total_accidents                  geometry
   &lt;chr&gt;                                         &lt;int&gt;          &lt;MULTIPOINT [m]&gt;
 1 speeding                                       8829 ((593843.8 1550868), (59…
 2 other                                           716 ((624456.5 1494214), (63…
 3 cutting in closely by people/vehic…             529 ((595540.6 1542724), (60…
 4 vehicle equipment failure                       325 ((606366 1562577), (6066…
 5 falling asleep                                  189 ((597876.3 1547500), (60…
 6 driving under the influence of alc…              95 ((607471.8 1545956), (61…
 7 tailgating                                       67 ((622420.1 1491733), (64…
 8 running red lights/traffic signals               62 ((611111.8 1526277), (62…
 9 abrupt lane change                               42 ((603057.8 1533623), (63…
10 illegal overtaking                               41 ((622895.3 1508505), (62…
# ℹ 26 more rows</code></pre>
</div>
</div>
<p><strong>Step 2: Spatial Visualization of Accident Causes</strong></p>
<ul>
<li>Create separate maps showing the distribution of accidents on straight roads by specific causes. For example, a map for accidents caused by speeding, driver fatigue, and reckless driving.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(admin_boundaries_bmr_simplified) <span class="sc">+</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(roads_bmr) <span class="sc">+</span>  <span class="co"># Add road network (no tm_raster, as it's a line)</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">"brown"</span>, <span class="at">lwd =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span>   </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(<span class="fu">filter</span>(accidents_bmr, road_description <span class="sc">==</span> <span class="st">"straight road"</span> <span class="sc">&amp;</span> presumed_cause <span class="sc">==</span> <span class="st">"speeding"</span>)) <span class="sc">+</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">title =</span> <span class="st">"Speeding Accidents"</span>) <span class="sc">+</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Speeding Accidents on Straight Roads"</span>, <span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(admin_boundaries_bmr_simplified) <span class="sc">+</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(roads_bmr) <span class="sc">+</span>  <span class="co"># Add road network (no tm_raster, as it's a line)</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">"brown"</span>, <span class="at">lwd =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span>   </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(<span class="fu">filter</span>(accidents_bmr, road_description <span class="sc">==</span> <span class="st">"straight road"</span> <span class="sc">&amp;</span> presumed_cause <span class="sc">==</span> <span class="st">"cutting in closely by people/vehicles/animals"</span>)) <span class="sc">+</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">title =</span> <span class="st">"Other Causes Accidents"</span>) <span class="sc">+</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Other Causes Accidents on Straight Roads"</span>, <span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(admin_boundaries_bmr_simplified) <span class="sc">+</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(roads_bmr) <span class="sc">+</span>  <span class="co"># Add road network (no tm_raster, as it's a line)</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">"brown"</span>, <span class="at">lwd =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span>   </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(<span class="fu">filter</span>(accidents_bmr, road_description <span class="sc">==</span> <span class="st">"straight road"</span> <span class="sc">&amp;</span> presumed_cause <span class="sc">==</span> <span class="st">"cutting in closely by people/vehicles/animals"</span>)) <span class="sc">+</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">title =</span> <span class="st">"People and Animal related Accidents"</span>) <span class="sc">+</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"People and Animal related Accidents on Straight Roads"</span>, <span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(admin_boundaries_bmr_simplified) <span class="sc">+</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(roads_bmr) <span class="sc">+</span>  <span class="co"># Add road network (no tm_raster, as it's a line)</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">"brown"</span>, <span class="at">lwd =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span>   </span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(<span class="fu">filter</span>(accidents_bmr, road_description <span class="sc">==</span> <span class="st">"straight road"</span> <span class="sc">&amp;</span> presumed_cause <span class="sc">==</span> <span class="st">"vehicle equipment failure"</span>)) <span class="sc">+</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">title =</span> <span class="st">"Vehicle Equipment Failure related Accidents"</span>) <span class="sc">+</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Vehicle Equipment Failure related Accidents on Straight Roads"</span>, <span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(admin_boundaries_bmr_simplified) <span class="sc">+</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(roads_bmr) <span class="sc">+</span>  <span class="co"># Add road network (no tm_raster, as it's a line)</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">"brown"</span>, <span class="at">lwd =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span>   </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(<span class="fu">filter</span>(accidents_bmr, road_description <span class="sc">==</span> <span class="st">"straight road"</span> <span class="sc">&amp;</span> presumed_cause <span class="sc">==</span> <span class="st">"vehicle equipment failure"</span>)) <span class="sc">+</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">title =</span> <span class="st">"Vehicle Equipment Failure related Accidents"</span>) <span class="sc">+</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Vehicle Equipment Failure related Accidents on Straight Roads"</span>, <span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Step 3: <strong>Comparative Analysis by Region</strong>:</p>
<p>We also compare which regions within BMR are more prone to certain types of accidents on straight roads. Create a heatmap or bar chart showing the distribution by region.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>region_comparison <span class="ot">&lt;-</span> accidents_bmr <span class="sc">%&gt;%</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(road_description <span class="sc">==</span> <span class="st">"straight road"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADM1_EN, presumed_cause) <span class="sc">%&gt;%</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_accidents =</span> <span class="fu">n</span>())</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(region_comparison, <span class="fu">aes</span>(<span class="at">x =</span> ADM1_EN, <span class="at">y =</span> total_accidents, <span class="at">fill =</span> presumed_cause)) <span class="sc">+</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Accidents on Straight Roads by Region and Cause"</span>, <span class="at">x =</span> <span class="st">"Region"</span>, <span class="at">y =</span> <span class="st">"Total Accidents"</span>) <span class="sc">+</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise1_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>