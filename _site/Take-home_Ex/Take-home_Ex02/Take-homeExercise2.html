<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tai Yu Ying">
<meta name="dcterms.date" content="2024-09-25">

<title>Take-home Exercise 2 – Mapping the Unseen</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Mapping the Unseen</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-onExercise1.1.html">
 <span class="dropdown-text">Hands-on Exercise 1.1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-onExercise1.2.html">
 <span class="dropdown-text">Hands-on Exercise 1.2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-onExercise2.1.html">
 <span class="dropdown-text">Hands-on Exercise 2.1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-onExercise2.2.html">
 <span class="dropdown-text">Hands-on Exercise 2.2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-onExercise3.1.html">
 <span class="dropdown-text">Hands-on Exercise 3.1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-onExercise4.1.html">
 <span class="dropdown-text">Hands-on Exercise 4.1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-onExercise5.1.html">
 <span class="dropdown-text">Hands-on Exercise 5.1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-onExercise5.2.html">
 <span class="dropdown-text">Hands-on Exercise 5.2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-onExercise6.1.html">
 <span class="dropdown-text">Hands-on Exercise 6.1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-onExercise7.1.html">
 <span class="dropdown-text">Hands-on Exercise 7.1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-onExercise8.1.qmd">
 <span class="dropdown-text">Hands-on Exercise 8.1</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-classExercise1.html">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-classExercise2.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-classExercise3.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-classExercise4.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-classExercise5.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-classExercise6.html">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-homeExercise1.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-homeExercise2.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">1</span> Overview</a></li>
  <li><a href="#objective" id="toc-objective" class="nav-link" data-scroll-target="#objective"><span class="header-section-number">2</span> Objective</a></li>
  <li><a href="#installing-and-launching-the-r-packages" id="toc-installing-and-launching-the-r-packages" class="nav-link" data-scroll-target="#installing-and-launching-the-r-packages"><span class="header-section-number">3</span> Installing and launching the R packages</a></li>
  <li><a href="#data-import-and-preparation" id="toc-data-import-and-preparation" class="nav-link" data-scroll-target="#data-import-and-preparation"><span class="header-section-number">4</span> Data Import and Preparation</a>
  <ul class="collapse">
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data"><span class="header-section-number">4.1</span> The Data</a></li>
  <li><a href="#import-thailand-domestic-tourism-statistics" id="toc-import-thailand-domestic-tourism-statistics" class="nav-link" data-scroll-target="#import-thailand-domestic-tourism-statistics"><span class="header-section-number">4.2</span> Import Thailand Domestic Tourism Statistics</a></li>
  <li><a href="#import-thailand---subnational-administrative-boundaries" id="toc-import-thailand---subnational-administrative-boundaries" class="nav-link" data-scroll-target="#import-thailand---subnational-administrative-boundaries"><span class="header-section-number">4.3</span> Import Thailand - Subnational Administrative Boundaries</a></li>
  <li><a href="#data-cleaning-and-transformation-for-thailand-domestic-tourism-statistics" id="toc-data-cleaning-and-transformation-for-thailand-domestic-tourism-statistics" class="nav-link" data-scroll-target="#data-cleaning-and-transformation-for-thailand-domestic-tourism-statistics"><span class="header-section-number">4.4</span> Data Cleaning and Transformation for Thailand Domestic Tourism Statistics</a></li>
  <li><a href="#exploratory-data-analysis-eda-for-thailand-domestic-tourism-statistics" id="toc-exploratory-data-analysis-eda-for-thailand-domestic-tourism-statistics" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda-for-thailand-domestic-tourism-statistics"><span class="header-section-number">4.5</span> Exploratory Data Analysis (EDA) for Thailand Domestic Tourism Statistics</a></li>
  <li><a href="#data-cleaning-and-transformation-for-thailand---subnational-administrative-boundaries" id="toc-data-cleaning-and-transformation-for-thailand---subnational-administrative-boundaries" class="nav-link" data-scroll-target="#data-cleaning-and-transformation-for-thailand---subnational-administrative-boundaries"><span class="header-section-number">4.6</span> Data Cleaning and Transformation for Thailand - Subnational Administrative Boundaries</a></li>
  <li><a href="#merging-the-two-datasets" id="toc-merging-the-two-datasets" class="nav-link" data-scroll-target="#merging-the-two-datasets"><span class="header-section-number">4.7</span> Merging the Two Datasets</a></li>
  <li><a href="#filter-the-data-for-each-year" id="toc-filter-the-data-for-each-year" class="nav-link" data-scroll-target="#filter-the-data-for-each-year"><span class="header-section-number">4.8</span> Filter the Data for Each Year</a></li>
  <li><a href="#saving-the-analytical-data-table" id="toc-saving-the-analytical-data-table" class="nav-link" data-scroll-target="#saving-the-analytical-data-table"><span class="header-section-number">4.9</span> Saving the Analytical Data Table</a></li>
  </ul></li>
  <li><a href="#visualising-thailand-tourism-economy" id="toc-visualising-thailand-tourism-economy" class="nav-link" data-scroll-target="#visualising-thailand-tourism-economy"><span class="header-section-number">5</span> Visualising Thailand tourism economy</a></li>
  <li><a href="#global-spatial-autocorrelation-analysis" id="toc-global-spatial-autocorrelation-analysis" class="nav-link" data-scroll-target="#global-spatial-autocorrelation-analysis"><span class="header-section-number">6</span> Global Spatial Autocorrelation Analysis</a>
  <ul class="collapse">
  <li><a href="#total-revenue-generated-by-tourism-industry-1" id="toc-total-revenue-generated-by-tourism-industry-1" class="nav-link" data-scroll-target="#total-revenue-generated-by-tourism-industry-1"><span class="header-section-number">6.1</span> Total revenue generated by tourism industry</a></li>
  </ul></li>
  <li><a href="#local-spatial-autocorrelation-analysis" id="toc-local-spatial-autocorrelation-analysis" class="nav-link" data-scroll-target="#local-spatial-autocorrelation-analysis"><span class="header-section-number">7</span> Local Spatial Autocorrelation Analysis</a>
  <ul class="collapse">
  <li><a href="#total-revenue-generated-by-tourism-industry-2" id="toc-total-revenue-generated-by-tourism-industry-2" class="nav-link" data-scroll-target="#total-revenue-generated-by-tourism-industry-2"><span class="header-section-number">7.1</span> Total revenue generated by tourism industry</a></li>
  </ul></li>
  <li><a href="#emerging-hotspot-analysis" id="toc-emerging-hotspot-analysis" class="nav-link" data-scroll-target="#emerging-hotspot-analysis"><span class="header-section-number">8</span> Emerging Hotspot Analysis</a>
  <ul class="collapse">
  <li><a href="#gi-statistics-using-adaptive-distance" id="toc-gi-statistics-using-adaptive-distance" class="nav-link" data-scroll-target="#gi-statistics-using-adaptive-distance"><span class="header-section-number">8.1</span> <strong>Gi statistics using adaptive distance</strong></a></li>
  <li><a href="#interpretation-of-the-emerging-hotspot-analysis-2020-vs-2022" id="toc-interpretation-of-the-emerging-hotspot-analysis-2020-vs-2022" class="nav-link" data-scroll-target="#interpretation-of-the-emerging-hotspot-analysis-2020-vs-2022"><span class="header-section-number">8.2</span> Interpretation of the Emerging Hotspot Analysis (2020 vs 2022):</a></li>
  <li><a href="#observations-and-changes-between-2020-and-2022" id="toc-observations-and-changes-between-2020-and-2022" class="nav-link" data-scroll-target="#observations-and-changes-between-2020-and-2022"><span class="header-section-number">8.3</span> Observations and Changes Between 2020 and 2022:</a></li>
  <li><a href="#key-changes-during-and-after-covid-19" id="toc-key-changes-during-and-after-covid-19" class="nav-link" data-scroll-target="#key-changes-during-and-after-covid-19"><span class="header-section-number">8.4</span> Key Changes During and After COVID-19:</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">8.5</span> Conclusion:</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 2</h1>
</div>



<div class="quarto-title-meta column-page-left">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Tai Yu Ying </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 25, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 14, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="overview" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="overview"><span class="header-section-number">1</span> Overview</h2>
<p>Tourism is a critical part of Thailand’s economy, contributing around 20% of its GDP before the COVID-19 pandemic. In 2019, the country earned $90 billion from tourism, but this dropped sharply to $24 billion in 2020 due to the pandemic. Though recovery began in late 2021, revenues remain below pre-pandemic levels, with key tourist hubs like Bangkok and Phuket rebounding faster than smaller provinces.</p>
<p>This study focuses on understanding the spatial and temporal recovery of Thailand’s tourism economy from 2019 to 2023. Using spatial autocorrelation methods such as Global Moran’s I and Local Moran’s I, we aim to detect clusters of tourism activity across provinces. In addition, we will conduct an emerging hotspot analysis to track tourism trends over time, revealing which areas are leading recovery and which remain underperforming.</p>
<p>Previous studies, such as Stankov et al.&nbsp;(2017), have successfully used spatial analysis to identify tourism clusters in Serbia, and Khan et al.&nbsp;(2017) applied similar methods in the U.S. to detect social trends. Applying these techniques in Thailand can provide insights into the geographic distribution of recovery, guiding targeted policy interventions.</p>
</section>
<section id="objective" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="objective"><span class="header-section-number">2</span> Objective</h2>
<p>Given the importance of the tourism sector to Thailand’s economic recovery, this study aims to address the following key research questions:</p>
<ul>
<li>Are Thailand’s tourism revenue patterns spatially and temporally dependent?</li>
<li>Where are the emerging hotspots and cold spots in tourism recovery?</li>
</ul>
</section>
<section id="installing-and-launching-the-r-packages" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="installing-and-launching-the-r-packages"><span class="header-section-number">3</span> Installing and launching the R packages</h2>
<p>In this exercise, the following R packages will be used, they are:</p>
<ul>
<li><strong><code>sf</code></strong>: For handling and manipulating <strong>spatial data</strong> (e.g., shapefiles of Thailand’s provinces).</li>
<li><strong><code>sfdep</code></strong>: Provides tools for spatial dependence analysis on <code>sf</code> objects. This will be used for calculating spatial autocorrelation metrics like <strong>Local Moran’s I</strong> and detecting clusters/outliers in tourism revenue data.</li>
<li><strong><code>spdep</code></strong>: For advanced spatial analysis, including <strong>spatial weights</strong> creation and conducting <strong>spatial lag and error models</strong> relevant to tourism data.</li>
<li><strong><code>tmap</code></strong>: Enables the creation of interactive and static <strong>thematic maps</strong>, crucial for visualizing clusters, hot/cold spots, and emerging tourism patterns.</li>
<li><strong><code>tidyverse</code></strong>: A suite of packages for data cleaning, manipulation, and visualization, used to manage and prepare the tourism data for analysis.</li>
<li><strong><code>knitr</code></strong>: Facilitates the generation of dynamic reports, integrating R code and output for documentation and reproducibility of the analysis.</li>
<li><strong><code>dplyr</code></strong>: Used for efficient data manipulation and cleaning, helping to preprocess the <strong>tourism revenue dataset</strong> before spatial analysis.</li>
<li><strong><code>spacetime</code></strong>: For managing and analyzing spatio-temporal data, allowing us to compare tourism revenue patterns over time (e.g., comparing 2020 and 2022 data).</li>
<li><strong><code>ggplot2</code></strong>: A visualization tool for creating detailed <strong>spatial and statistical plots</strong>, used to complement <code>tmap</code> for presenting tourism revenue patterns.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, sfdep, spdep, tmap, tidyverse, knitr, dplyr, spacetime, ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-import-and-preparation" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="data-import-and-preparation"><span class="header-section-number">4</span> Data Import and Preparation</h2>
<section id="the-data" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="the-data"><span class="header-section-number">4.1</span> The Data</h3>
<ul>
<li><p><a href="https://www.kaggle.com/datasets/thaweewatboy/thailand-domestic-tourism-statistics">Thailand Domestic Tourism Statistics</a>&nbsp;at Kaggle.</p></li>
<li><p><a href="https://data.humdata.org/dataset/cod-ab-tha?">Thailand - Subnational Administrative Boundaries</a> on HDX.</p></li>
</ul>
</section>
<section id="import-thailand-domestic-tourism-statistics" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="import-thailand-domestic-tourism-statistics"><span class="header-section-number">4.2</span> Import <a href="https://www.kaggle.com/datasets/thaweewatboy/thailand-domestic-tourism-statistics">Thailand Domestic Tourism Statistics</a></h3>
<p>This dataset provides monthly data on tourism activity across Thailand’s provinces, from January 2019 to February 2023. The variable of interest is the ratio of tourist stays in each province, which reflects the percentage of tourists who stay overnight compared to the total number of visitors.</p>
<p>Since&nbsp;data set is in csv file format, we will use&nbsp;<a href="https://readr.tidyverse.org/reference/read_delim.html"><em>read_csv()</em></a>&nbsp;of&nbsp;<strong>readr</strong>&nbsp;package to import&nbsp;<code>thailand_domestic_tourism_2019_2023_ver2.csv</code>&nbsp;as shown the code chunk below. The output R object is called&nbsp;<code>tour</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">The code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Examine output</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tour <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/rawdata/thailand_domestic_tourism_2019_2023_ver2.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>After importing the data file into R, it is important for us to examine if the data file has been imported correctly.</p>
<p>The code chunk below shows <em>summary()</em> and <em>list()</em> of Base R.</p>
<p>The dataset includes the following columns:</p>
<ul>
<li><p><code>date</code>: The time period (monthly data).</p></li>
<li><p><code>province_thai</code>: The name of the province in Thai.</p></li>
<li><p><code>province_eng</code>: The name of the province in English.</p></li>
<li><p><code>region_thai</code>: The region name in Thai.</p></li>
<li><p><code>region_eng</code>: The region name in English.</p></li>
<li><p><code>variable</code>: 8 types of data being recorded, such as the number of tourists or the occupancy rate.</p>
<ul>
<li><p><code>no_tourist_all</code> The total number of tourists who visited the province</p></li>
<li><p><code>no_tourist_foreign</code> The number of foreign tourists who visited the province</p></li>
<li><p><code>no_tourist_stay</code> The total number of occupied hotel rooms in the province</p></li>
<li><p><code>no_tourist_thai</code> The number of Thai tourists who visited the province</p></li>
<li><p><code>ratio_tourist_stay</code> The percentage of occupied travel accommodation in the province</p></li>
<li><p><code>revenue_all</code> The revenue generated by the tourism industry in the province, in Thai Baht</p></li>
<li><p><code>revenue_foreign</code> The revenue generated by foreign tourists in the province, in Thai Baht</p></li>
<li><p><code>revenue_thai</code> The revenue generated by Thai tourists in the province, in Thai Baht</p></li>
</ul></li>
<li><p><code>value</code>: The value of the measured variable.</p></li>
</ul>
<p>This dataset provides crucial insights into the tourism trends for each province, enabling the identification of recovery patterns after the pandemic. By analyzing the changes in the ratio of tourist stays, we can gauge how tourism activities have fluctuated in response to external factors, such as COVID-19.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tour)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      date            province_thai      province_eng       region_thai       
 Min.   :2019-01-01   Length:30800       Length:30800       Length:30800      
 1st Qu.:2020-01-01   Class :character   Class :character   Class :character  
 Median :2021-01-16   Mode  :character   Mode  :character   Mode  :character  
 Mean   :2021-01-15                                                           
 3rd Qu.:2022-02-01                                                           
 Max.   :2023-02-01                                                           
  region_eng          variable             value           
 Length:30800       Length:30800       Min.   :-4.250e+03  
 Class :character   Class :character   1st Qu.: 1.740e+03  
 Mode  :character   Mode  :character   Median : 9.335e+04  
                                       Mean   : 3.360e+08  
                                       3rd Qu.: 1.817e+07  
                                       Max.   : 1.103e+11  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(tour)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 30,800 × 7
   date       province_thai province_eng   region_thai region_eng variable value
   &lt;date&gt;     &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;
 1 2019-01-01 กรุงเทพมหานคร  Bangkok        ภาคกลาง     central    ratio_t…  93.4
 2 2019-01-01 ลพบุรี          Lopburi        ภาคกลาง     central    ratio_t…  61.3
 3 2019-01-01 พระนครศรีอยุธยา Phra Nakhon S… ภาคกลาง     central    ratio_t…  73.4
 4 2019-01-01 สระบุรี         Saraburi       ภาคกลาง     central    ratio_t…  67.3
 5 2019-01-01 ชัยนาท         Chainat        ภาคกลาง     central    ratio_t…  79.3
 6 2019-01-01 นครปฐม        Nakhon Pathom  ภาคกลาง     central    ratio_t…  71.7
 7 2019-01-01 สิงห์บุรี         Sing Buri      ภาคกลาง     central    ratio_t…  64.6
 8 2019-01-01 อ่างทอง        Ang Thong      ภาคกลาง     central    ratio_t…  71.2
 9 2019-01-01 นนทบุรี         Nonthaburi     ภาคกลาง     central    ratio_t…  75.1
10 2019-01-01 ปทุมธานี        Pathum Thani   ภาคกลาง     central    ratio_t…  60.8
# ℹ 30,790 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="import-thailand---subnational-administrative-boundaries" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="import-thailand---subnational-administrative-boundaries"><span class="header-section-number">4.3</span> Import <a href="https://data.humdata.org/dataset/cod-ab-tha?">Thailand - Subnational Administrative Boundaries</a></h3>
<p>This dataset contains the geographic boundaries of Thailand’s provinces, represented as polygons. It is essential for spatial analysis and will be used to map and visualize the spatial distribution of tourism activities across Thailand.</p>
<p>The code chunk below uses&nbsp;<em>st_read()</em>&nbsp;function of&nbsp;<strong>sf</strong>&nbsp;package to import&nbsp;<code>tha_adm_rtsd_itos_20210121_SHP</code>&nbsp;shapefile into R as a polygon feature data frame.&nbsp;</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">The code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Examine output</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>admin_boundaries_raw <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"Data/rawdata/tha_admbnda_adm2_rtsd_20220121.shp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `tha_admbnda_adm2_rtsd_20220121' from data source 
  `C:\gniyuy\ISSS626_GA\Take-home_Ex\Take-home_Ex02\Data\rawdata\tha_admbnda_adm2_rtsd_20220121.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 928 features and 19 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>The boundary dataset is currently using the <strong>EPSG:4326 (WGS 84)</strong> coordinate reference system, which employs latitude and longitude in degrees. While suitable for global mapping, EPSG:4326 is not ideal for precise local analysis due to its use of degrees rather than meters.</p>
<p>To improve spatial accuracy and facilitate local analysis in Thailand, the coordinate system will be transformed to <strong>EPSG:32647</strong> (UTM Zone 47N), which uses meters for measurement. The reasons include:</p>
<ol type="1">
<li><p><strong>Improved Accuracy</strong>: UTM projections, like EPSG:32647, provide more precise distance and area calculations compared to WGS 84, which uses degrees.</p></li>
<li><p><strong>Better for Local Analysis</strong>: UTM zones minimize distortions for regional-scale mapping, making it more suitable for spatial analysis in Thailand.</p></li>
<li><p><strong>Consistency</strong>: Many spatial studies in Thailand use UTM Zone 47N for local accuracy.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Geospatial Properties:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Geospatial Properties:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">st_crs</span>(admin_boundaries_raw))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">st_geometry_type</span>(admin_boundaries_raw))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
  [6] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [11] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [16] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [21] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [26] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [31] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [36] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [41] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [46] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [51] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [56] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [61] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [66] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [71] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [76] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [81] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [86] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [91] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [96] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[101] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[106] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[111] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[116] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[121] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[126] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[131] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[136] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[141] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[146] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[151] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[156] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[161] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[166] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[171] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[176] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[181] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[186] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[191] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[196] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[201] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[206] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[211] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[216] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[221] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[226] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[231] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[236] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[241] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[246] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[251] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[256] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[261] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[266] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[271] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[276] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[281] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[286] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[291] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[296] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[301] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[306] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[311] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[316] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[321] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[326] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[331] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[336] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[341] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[346] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[351] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[356] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[361] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[366] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[371] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[376] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[381] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[386] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[391] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[396] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[401] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[406] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[411] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[416] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[421] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[426] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[431] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[436] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[441] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[446] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[451] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[456] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[461] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[466] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[471] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[476] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[481] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[486] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[491] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[496] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[501] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[506] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[511] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[516] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[521] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[526] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[531] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[536] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[541] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[546] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[551] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[556] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[561] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[566] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[571] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[576] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[581] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[586] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[591] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[596] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[601] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[606] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[611] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[616] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[621] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[626] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[631] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[636] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[641] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[646] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[651] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[656] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[661] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[666] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[671] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[676] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[681] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[686] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[691] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[696] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[701] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[706] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[711] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[716] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[721] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[726] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[731] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[736] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[741] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[746] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[751] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[756] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[761] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[766] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[771] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[776] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[781] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[786] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[791] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[796] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[801] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[806] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[811] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[816] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[821] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[826] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[831] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[836] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[841] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[846] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[851] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[856] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[861] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[866] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[871] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[876] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[881] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[886] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[891] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[896] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[901] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[906] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[911] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[916] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[921] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[926] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT ... TRIANGLE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">st_bbox</span>(admin_boundaries_raw))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      xmin       ymin       xmax       ymax 
 97.343358   5.613038 105.636965  20.465074 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="data-cleaning-and-transformation-for-thailand-domestic-tourism-statistics" class="level3" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="data-cleaning-and-transformation-for-thailand-domestic-tourism-statistics"><span class="header-section-number">4.4</span> Data Cleaning and Transformation for <a href="https://www.kaggle.com/datasets/thaweewatboy/thailand-domestic-tourism-statistics">Thailand Domestic Tourism Statistics</a></h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Selection of relevant columns</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Handling Missing Data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Date and Time Aggregation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">Rename <code>province_eng</code> to <code>ADM1_EN</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">Rename provinces to match both dataset</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-6" role="tab" aria-controls="tabset-3-6" aria-selected="false">Split of dataset into each variable</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>The most relevant columns are:</p>
<ul>
<li><code>date</code>: Required for temporal analysis (spacetime analysis).</li>
<li><code>province_eng</code>: The English name of the province, which will be used to join with the spatial boundary dataset.</li>
<li><code>value</code>: The numerical value of the ratio of tourist stays, which is the key variable for your spatial analysis.</li>
<li><code>variable</code>: The variable measured (in this case, it appears to be “ratio_tourist_stay,” representing the ratio of tourist stays).</li>
</ul>
<p>The other columns, such as <code>province_thai</code>, <code>region_thai</code>, and <code>region_eng</code>, can be omitted if they are not needed for your analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select relevant columns: date, province_eng, and value</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>tour_clean <span class="ot">&lt;-</span> tour <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">select</span>(date, province_eng, variable, value)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># View the cleaned dataset</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tour_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  date       province_eng             variable           value
  &lt;date&gt;     &lt;chr&gt;                    &lt;chr&gt;              &lt;dbl&gt;
1 2019-01-01 Bangkok                  ratio_tourist_stay  93.4
2 2019-01-01 Lopburi                  ratio_tourist_stay  61.3
3 2019-01-01 Phra Nakhon Si Ayutthaya ratio_tourist_stay  73.4
4 2019-01-01 Saraburi                 ratio_tourist_stay  67.3
5 2019-01-01 Chainat                  ratio_tourist_stay  79.3
6 2019-01-01 Nakhon Pathom            ratio_tourist_stay  71.7</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Prepare a tourism economy indicators layer using <strong>sf</strong> and <strong>tidyverse</strong> functions. The layer should contain tourism economy indicators (like the ratio of tourist stays) for each province.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Handle missing values</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>tour_clean<span class="sc">$</span>value <span class="ot">&lt;-</span> zoo<span class="sc">::</span><span class="fu">na.approx</span>(tour_clean<span class="sc">$</span>value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>Keep the time series at <strong>month and year levels</strong> to prepare for spacetime analysis.</p>
<p>Ensure that the <strong>date</strong> column is correctly formatted and aggregate the data by month and year for each province. This step is crucial for later <strong>spacetime S3 class</strong> analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'date' column to date type and aggregate by month and year</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>tour_clean<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(tour_clean<span class="sc">$</span>date)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>monthly_data <span class="ot">&lt;-</span> tour_clean <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">group_by</span>(province_eng,variable, <span class="at">month =</span> <span class="fu">format</span>(date, <span class="st">"%Y-%m"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">summarize</span>(<span class="at">total_value =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the column</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>monthly_data <span class="ot">&lt;-</span> monthly_data <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">:::</span><span class="fu">rename.data.frame</span>(<span class="at">ADM1_EN =</span> province_eng)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Under <code>Thailand Domestic Tourism Statistics</code></th>
<th>Under <code>Thailand - Subnational Administrative Boundaries</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Buriram</td>
<td>Buri Ram</td>
</tr>
<tr class="even">
<td>Chainat</td>
<td>Chai Nat</td>
</tr>
<tr class="odd">
<td>Chonburi</td>
<td>Chon Buri</td>
</tr>
<tr class="even">
<td>Lopburi</td>
<td>Lop Buri</td>
</tr>
<tr class="odd">
<td>Nong Bua Lamphu</td>
<td>Nong Bua Lam Phu</td>
</tr>
<tr class="even">
<td>Phang Nga</td>
<td>Phangnga</td>
</tr>
<tr class="odd">
<td>Prachinburi</td>
<td>Prachin Buri</td>
</tr>
<tr class="even">
<td>Sisaket</td>
<td>Si Sa Ket</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a named vector for renaming provinces</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>rename_provinces <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Buriram"</span> <span class="ot">=</span> <span class="st">"Buri Ram"</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Chainat"</span> <span class="ot">=</span> <span class="st">"Chai Nat"</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Chonburi"</span> <span class="ot">=</span> <span class="st">"Chon Buri"</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Lopburi"</span> <span class="ot">=</span> <span class="st">"Lop Buri"</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Nong Bua Lamphu"</span> <span class="ot">=</span> <span class="st">"Nong Bua Lam Phu"</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Phang Nga"</span> <span class="ot">=</span> <span class="st">"Phangnga"</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Prachinburi"</span> <span class="ot">=</span> <span class="st">"Prachin Buri"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Sisaket"</span> <span class="ot">=</span> <span class="st">"Si Sa Ket"</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename provinces in the 'ADM1_EN' column using dplyr</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>monthly_data <span class="ot">&lt;-</span> monthly_data <span class="sc">%&gt;%</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ADM1_EN =</span> <span class="fu">recode</span>(ADM1_EN, <span class="sc">!!!</span>rename_provinces))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for 'no_tourist_all'</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>no_tourist_all_data <span class="ot">&lt;-</span> monthly_data <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"no_tourist_all"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(no_tourist_all_data, <span class="st">"Data/rds/no_tourist_all_data.rds"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>no_tourist_all_data_join <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data/rds/no_tourist_all_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for 'revenue_all'</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>revenue_all_data <span class="ot">&lt;-</span> monthly_data <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"revenue_all"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(revenue_all_data, <span class="st">"Data/rds/revenue_all_data.rds"</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>revenue_all_data_join <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data/rds/revenue_all_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="exploratory-data-analysis-eda-for-thailand-domestic-tourism-statistics" class="level3" data-number="4.5">
<h3 data-number="4.5" class="anchored" data-anchor-id="exploratory-data-analysis-eda-for-thailand-domestic-tourism-statistics"><span class="header-section-number">4.5</span> Exploratory Data Analysis (EDA) for <a href="https://www.kaggle.com/datasets/thaweewatboy/thailand-domestic-tourism-statistics">Thailand Domestic Tourism Statistics</a></h3>
<p>To derive a <strong>tourism economy indicator layer</strong> to be used for global and local spatial autocorrelation analysis.</p>
<p>We can conduct preliminary visualizations (e.g., time series plots or heat maps) to understand tourism trends and identify any anomalies. This step helps ensure the data is ready for more complex spatial analysis.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Summary</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Trends Over Time by Category</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Total Revenue by Province in 2019</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<ul>
<li><p><strong>Tourist Distribution</strong>:</p>
<ul>
<li><p><strong>Total Tourists (no_tourist_all)</strong>: The average number of tourists is around 206,000, but some provinces see as many as 6.13 million, while others experience months with no tourists.</p></li>
<li><p><strong>Foreign Tourists (no_tourist_foreign)</strong>: On average, provinces attract 32,000 foreign tourists, but the median is much lower at 553, showing that a few provinces (up to 2.47 million tourists) dominate international tourism.</p></li>
<li><p><strong>Domestic Tourists (no_tourist_thai)</strong>: Domestic tourism is significant, with an average of 174,000 tourists per province, reaching a maximum of 4.08 million.</p></li>
</ul></li>
<li><p><strong>Overnight Stays</strong>:</p>
<ul>
<li><p><strong>Overnight Tourists (no_tourist_stay)</strong>: The average number of tourists staying overnight is 105,000, but this varies widely across provinces.</p></li>
<li><p><strong>Ratio of Overnight Stays (ratio_tourist_stay)</strong>: On average, 40% of tourists stay overnight, but this can range from 0% (day-trippers) to nearly 96%.</p></li>
</ul></li>
<li><p><strong>Tourism Revenue</strong>:</p>
<ul>
<li><p><strong>Total Revenue (revenue_all)</strong>: Provinces earn an average of 1.34 billion Baht in tourism revenue, with the highest revenue reaching over 1 trillion Baht, indicating a large revenue disparity.</p></li>
<li><p><strong>Foreign Revenue (revenue_foreign)</strong>: Foreign tourists contribute an average of 680 million Baht, with some provinces earning as much as 85 billion Baht.</p></li>
<li><p><strong>Domestic Revenue (revenue_thai)</strong>: Domestic tourists generate an average of 663 million Baht, with a maximum of 45 billion Baht in some provinces.</p></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by variable and calculate summary statistics for each category</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> monthly_data <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">summarize</span>(<span class="at">mean_value =</span> <span class="fu">mean</span>(total_value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">median_value =</span> <span class="fu">median</span>(total_value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">min_value =</span> <span class="fu">min</span>(total_value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">max_value =</span> <span class="fu">max</span>(total_value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  variable             mean_value median_value min_value max_value
  &lt;chr&gt;                     &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 no_tourist_all         206328.       92122.          0   6.13e 6
2 no_tourist_foreign      32366.         553           0   2.47e 6
3 no_tourist_stay        105161.       44579           0   3.34e 6
4 no_tourist_thai        173962.       88782           0   4.09e 6
5 ratio_tourist_stay         38.9         41.8         0   9.59e 1
6 revenue_all        1343875802.   195495000           0   1.10e11
7 revenue_foreign     680232189.     1540000       -4250   8.50e10
8 revenue_thai        663643613.   177310000           0   4.51e10</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(no_tourist_all_data, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> total_value)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Monthly Total Number of All Tourists, 2019-2023"</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month-Year"</span>, <span class="at">y =</span> <span class="st">"No. of Tourists"</span>) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(revenue_all_data, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> total_value)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Monthly Total Revenue from Tourism Industry, 2019-2023"</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month-Year"</span>, <span class="at">y =</span> <span class="st">"Total Revenue"</span>) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>Figure below reveals that the tourism economy of Thailand are mainly focus on five provinces, namely Bangkok, Phuket, Chonburi, Krabi and Chiang Mai.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for all months in 2019 and "revenue_all" in the 'variable' column</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>revenue_2019 <span class="ot">&lt;-</span> monthly_data <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"revenue_all"</span>, <span class="fu">grepl</span>(<span class="st">"^2019-"</span>, month)) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADM1_EN) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_revenue =</span> <span class="fu">sum</span>(total_value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot using ggplot2</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(revenue_2019, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(ADM1_EN, total_revenue), <span class="at">y =</span> total_revenue)) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="co"># Flip coordinates to make a horizontal bar plot</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total Revenue by Province in 2019"</span>,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Province"</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Revenue"</span>) <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="co"># Use a minimal theme for a clean look</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="data-cleaning-and-transformation-for-thailand---subnational-administrative-boundaries" class="level3" data-number="4.6">
<h3 data-number="4.6" class="anchored" data-anchor-id="data-cleaning-and-transformation-for-thailand---subnational-administrative-boundaries"><span class="header-section-number">4.6</span> Data Cleaning and Transformation for <a href="https://data.humdata.org/dataset/cod-ab-tha?">Thailand - Subnational Administrative Boundaries</a></h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Prepare study area layer in sf polygon</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Selecting relevant columns</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Remove Z and M dimensions from the admin boundaries dataset</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">CRS Transformation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false">Aggregate district-level geometries to province-level boundaries</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>This will enable the linking of tourism data with geographic boundaries.</p>
<p>Ensure that all provinces are included in the boundary dataset and that their polygon geometries are valid. Check for and fix any invalid geometries.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check and fix invalid geometries</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">st_is_valid</span>(admin_boundaries_raw))  <span class="co"># Check for invalid geometries</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>boundaries <span class="ot">&lt;-</span> <span class="fu">st_make_valid</span>(admin_boundaries_raw)  <span class="co"># Fix invalid geometries</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>The following columns that provide information on the administrative area can be retained, such as:</p>
<ul>
<li><p><code>ADM1_EN</code> (English name of the first-level boundary, e.g., province)</p></li>
<li><p><code>geometry</code> (spatial information in MULTIPOLYGON format)</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>admin_boundaries_filtered <span class="ot">&lt;-</span> admin_boundaries_raw <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ADM1_EN, geometry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>admin_boundaries_drop <span class="ot">&lt;-</span> <span class="fu">st_zm</span>(admin_boundaries_filtered, <span class="at">drop =</span> <span class="cn">TRUE</span>, <span class="at">what =</span> <span class="st">"ZM"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<p>Transform the CRS from <strong>EPSG:4326 (WGS 84)</strong> to <strong>EPSG:32647 (UTM Zone 47N)</strong> to align with local spatial analysis requirements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>admin_boundaries_cleaned <span class="ot">&lt;-</span> admin_boundaries_drop <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">32647</span>) </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the filtered data</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(admin_boundaries_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   ADM1_EN                   geometry  
 Length:928         MULTIPOLYGON :928  
 Class :character   epsg:32647   :  0  
 Mode  :character   +proj=utm ...:  0  </code></pre>
</div>
</div>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<p>Group the data by <code>ADM1_EN</code> (the province name) and ensure that you only keep one geometry per province.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>simplified_provinces <span class="ot">&lt;-</span> admin_boundaries_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADM1_EN) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">geometry =</span> <span class="fu">st_union</span>(geometry)) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_cast</span>(<span class="st">"MULTIPOLYGON"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="merging-the-two-datasets" class="level3" data-number="4.7">
<h3 data-number="4.7" class="anchored" data-anchor-id="merging-the-two-datasets"><span class="header-section-number">4.7</span> Merging the Two Datasets</h3>
<p>Merge the tourism dataset with the provincial boundary dataset to create the <strong>study area layer</strong> and <strong>tourism economy indicators layer</strong> for spatial analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>no_tourist_all_join <span class="ot">&lt;-</span> dplyr<span class="sc">:::</span><span class="fu">left_join.data.frame</span>(simplified_provinces, no_tourist_all_data, <span class="at">by =</span> <span class="fu">c</span>(<span class="at">ADM1_EN =</span> <span class="st">"ADM1_EN"</span>))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(no_tourist_all_join, <span class="st">"Data/rds/no_tourist_all.rds"</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>no_tourist_all_join <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data/rds/no_tourist_all.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>revenue_all_join <span class="ot">&lt;-</span> dplyr<span class="sc">:::</span><span class="fu">left_join.data.frame</span>(simplified_provinces, revenue_all_data, <span class="at">by =</span> <span class="fu">c</span>(<span class="at">ADM1_EN =</span> <span class="st">"ADM1_EN"</span>))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(revenue_all_join, <span class="st">"Data/rds/rev_all.rds"</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>revenue_all_join <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data/rds/rev_all.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="filter-the-data-for-each-year" class="level3" data-number="4.8">
<h3 data-number="4.8" class="anchored" data-anchor-id="filter-the-data-for-each-year"><span class="header-section-number">4.8</span> Filter the Data for Each Year</h3>
<p>To investigate the impact of COVID-19 on Thailand’s tourism industry while choosing specific years, would recommend focusing on the following years:</p>
<ul>
<li><p><strong>2020 (Pandemic Year)</strong>: This year represents the height of the COVID-19 pandemic, with lockdowns, travel restrictions, and a significant decline in both international and domestic tourism. Analyzing this year will highlight how severely the pandemic disrupted tourism in Thailand.</p></li>
<li><p><strong>2022 (Recovery Year)</strong>: By 2022, many countries, including Thailand, began easing restrictions, allowing travel to resume. Analyzing this year helps to assess the recovery phase and whether the tourism industry has bounced back to pre-pandemic levels, or if it is still lagging.</p></li>
</ul>
<p>By focusing on these two years, we can clearly assess the immediate impact of the pandemic and the subsequent recovery, providing a targeted understanding of how tourism dynamics shifted between the crisis and recovery periods.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the 'month' column to a date format</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>revenue_all_join <span class="ot">&lt;-</span> revenue_all_join <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(month, <span class="st">"-01"</span>), <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>))</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>no_tourist_all_join <span class="ot">&lt;-</span> no_tourist_all_join <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(month, <span class="st">"-01"</span>), <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="total-revenue-generated-by-tourism-industry" class="level4" data-number="4.8.1">
<h4 data-number="4.8.1" class="anchored" data-anchor-id="total-revenue-generated-by-tourism-industry"><span class="header-section-number">4.8.1</span> Total revenue generated by tourism industry</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Pandemic Year: 2020</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Recovery Year: 2022</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>rev_2020 <span class="ot">&lt;-</span> revenue_all_join <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">format</span>(<span class="fu">as.Date</span>(month), <span class="st">"%Y"</span>) <span class="sc">==</span> <span class="st">"2020"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize total revenue by province for 2020</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>rev_2020 <span class="ot">&lt;-</span> rev_2020 <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADM1_EN) <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_revenue =</span> <span class="fu">sum</span>(total_value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>rev_2022 <span class="ot">&lt;-</span> revenue_all_join <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">format</span>(<span class="fu">as.Date</span>(month), <span class="st">"%Y"</span>) <span class="sc">==</span> <span class="st">"2022"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize total revenue by province for 2020</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>rev_2022 <span class="ot">&lt;-</span> rev_2022 <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADM1_EN) <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_revenue =</span> <span class="fu">sum</span>(total_value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="number-of-tourists-visited-the-provinces" class="level4" data-number="4.8.2">
<h4 data-number="4.8.2" class="anchored" data-anchor-id="number-of-tourists-visited-the-provinces"><span class="header-section-number">4.8.2</span> Number of tourists visited the provinces</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Pandemic Year: 2020</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Recovery Year: 2022</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>notour_2020 <span class="ot">&lt;-</span> no_tourist_all_join <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">format</span>(<span class="fu">as.Date</span>(month), <span class="st">"%Y"</span>) <span class="sc">==</span> <span class="st">"2020"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize total revenue by province for 2020</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>notour_2020 <span class="ot">&lt;-</span> notour_2020 <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADM1_EN) <span class="sc">%&gt;%</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">no_tourist =</span> <span class="fu">sum</span>(total_value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>notour_2022 <span class="ot">&lt;-</span> no_tourist_all_join <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">format</span>(<span class="fu">as.Date</span>(month), <span class="st">"%Y"</span>) <span class="sc">==</span> <span class="st">"2022"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize total revenue by province for 2020</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>notour_2022 <span class="ot">&lt;-</span> notour_2022 <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADM1_EN) <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">no_tourist =</span> <span class="fu">sum</span>(total_value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="saving-the-analytical-data-table" class="level3" data-number="4.9">
<h3 data-number="4.9" class="anchored" data-anchor-id="saving-the-analytical-data-table"><span class="header-section-number">4.9</span> Saving the Analytical Data Table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(rev_2020, <span class="st">"Data/rds/rev_2020.rds"</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(rev_2022, <span class="st">"Data/rds/rev_2022.rds"</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(notour_2020, <span class="st">"Data/rds/notour_2020 .rds"</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(notour_2022, <span class="st">"Data/rds/notour_2022 .rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="visualising-thailand-tourism-economy" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="visualising-thailand-tourism-economy"><span class="header-section-number">5</span> Visualising Thailand tourism economy</h2>
<p>Let’s load the .rds file using the&nbsp;<em>readRDS()</em>&nbsp;function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>rev_2020 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data/rds/rev_2020.rds"</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>rev_2022 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data/rds/rev_2022.rds"</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>notour_2020 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data/rds/notour_2020 .rds"</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>notour_2022 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Data/rds/notour_2022 .rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we are going to prepare a basemap and a choropleth map showing the distribution of Thailand tourism economy by using&nbsp;<em>qtm()</em>&nbsp;of&nbsp;<strong>tmap</strong>&nbsp;package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>basemap <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(rev_2020) <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"ADM1_EN"</span>, <span class="at">size=</span><span class="fl">0.5</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>rev_2020_map <span class="ot">&lt;-</span> <span class="fu">qtm</span>(rev_2020, <span class="st">"total_revenue"</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(basemap, rev_2020_map, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>basemap <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(rev_2022) <span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"ADM1_EN"</span>, <span class="at">size=</span><span class="fl">0.5</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>rev_2022_map <span class="ot">&lt;-</span> <span class="fu">qtm</span>(rev_2022, <span class="st">"total_revenue"</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(basemap, rev_2022_map, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>basemap <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(notour_2020) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"ADM1_EN"</span>, <span class="at">size=</span><span class="fl">0.5</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>notour_2020_map <span class="ot">&lt;-</span> <span class="fu">qtm</span>(notour_2020, <span class="st">"no_tourist"</span>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(basemap, notour_2020_map, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>basemap <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(notour_2022) <span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"ADM1_EN"</span>, <span class="at">size=</span><span class="fl">0.5</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>notour_2022_map <span class="ot">&lt;-</span> <span class="fu">qtm</span>(notour_2022, <span class="st">"no_tourist"</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(basemap, notour_2022_map, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="global-spatial-autocorrelation-analysis" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="global-spatial-autocorrelation-analysis"><span class="header-section-number">6</span> Global Spatial Autocorrelation Analysis</h2>
<p>Global Spatial Autocorrelation Analysis helps determine whether the spatial distribution of tourism revenue is random or exhibits patterns across different regions. This step involves applying the <code>sfdep</code> package in R to compute the Global Moran’s I statistic, which measures the degree of spatial autocorrelation in the dataset. The analysis includes significance testing to confirm whether any detected patterns are statistically significant.</p>
<p>Global Moran’s I is a statistical measure that assesses whether the observed values (e.g., tourism revenue) are clustered, dispersed, or randomly distributed in space. A positive Moran’s I value suggests clustering, a negative value indicates dispersion, and a value near zero implies randomness.</p>
<section id="total-revenue-generated-by-tourism-industry-1" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="total-revenue-generated-by-tourism-industry-1"><span class="header-section-number">6.1</span> Total revenue generated by tourism industry</h3>
<p><code>revenue_all</code> represents the total revenue generated by the tourism industry in each province, which makes it a suitable choice for analyzing spatial patterns in economic impact.</p>
<p>Since the analysis aims to understand the spatial distribution of the tourism economy, using revenue data provides direct insights into the financial performance of each province.</p>
<section id="pandemic-year-2020-2" class="level4" data-number="6.1.1">
<h4 data-number="6.1.1" class="anchored" data-anchor-id="pandemic-year-2020-2"><span class="header-section-number">6.1.1</span> Pandemic Year: 2020</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Computing (QUEEN) contiguity based neighbours</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Creating (ROOK) contiguity based neighbours</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>The code chunk below is used to compute Queen contiguity weight matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>wm_q_rev_2020 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(rev_2020, <span class="at">queen=</span><span class="cn">TRUE</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wm_q_rev_2020)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 77 
Number of nonzero links: 352 
Percentage nonzero weights: 5.93692 
Average number of links: 4.571429 
1 region with no links:
48
2 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  5  6  7  8  9 
 1  1  5 17 15 17 10  5  4  2 
1 least connected region:
71 with 1 link
2 most connected regions:
17 69 with 9 links</code></pre>
</div>
</div>
<p>The summary report above shows that there are 77 area units in Thailand. The most connected area unit has 9 neighbours. There are one area units with only one neighbours.</p>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p>The code chunk below is used to compute Rook contiguity weight matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>wm_r_rev_2020 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(rev_2020, <span class="at">queen=</span><span class="cn">FALSE</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wm_r_rev_2020)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 77 
Number of nonzero links: 352 
Percentage nonzero weights: 5.93692 
Average number of links: 4.571429 
1 region with no links:
48
2 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  5  6  7  8  9 
 1  1  5 17 15 17 10  5  4  2 
1 least connected region:
71 with 1 link
2 most connected regions:
17 69 with 9 links</code></pre>
</div>
</div>
<p>The summary report above shows that there are 77 area units in Thailand. The most connected area unit has 9 neighbours. There are one area units with only one neighbours.</p>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<p>A summary of the results are below. In our case, both methods yield similar results.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>Queen Contiguity</th>
<th>Rook Contiguity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>No.&nbsp;of regions with no links</td>
<td>5</td>
<td>5</td>
</tr>
<tr class="even">
<td>Average number of links</td>
<td>4.571</td>
<td>4.571</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="create-spatial-weights-matrix" class="level5" data-number="6.1.1.1">
<h5 data-number="6.1.1.1" class="anchored" data-anchor-id="create-spatial-weights-matrix"><span class="header-section-number">6.1.1.1</span> Create spatial weights matrix</h5>
<p>Create a spatial weights matrix using the tourism data. The spatial weights define how each region is connected to other regions, based on criteria such as contiguity (neighboring areas) or distance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>rswm_q_rev_2020 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(wm_q_rev_2020, </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"W"</span>, </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>rswm_q_rev_2020</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 77 
Number of nonzero links: 352 
Percentage nonzero weights: 5.93692 
Average number of links: 4.571429 
1 region with no links:
48
2 disjoint connected subgraphs

Weights style: W 
Weights constants summary:
   n   nn S0       S1      S2
W 76 5776 76 36.26113 315.652</code></pre>
</div>
</div>
</section>
<section id="calculate-global-morans-i" class="level5" data-number="6.1.1.2">
<h5 data-number="6.1.1.2" class="anchored" data-anchor-id="calculate-global-morans-i"><span class="header-section-number">6.1.1.2</span> Calculate Global Moran’s I</h5>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Global Moran’s I</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Interpretation</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>The code chunk below performs Moran’s I statistical testing using moran.test() of spdep.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(rev_2020<span class="sc">$</span>total_revenue, </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">listw=</span>rswm_q_rev_2020, </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  rev_2020$total_revenue  
weights: rswm_q_rev_2020  
n reduced by no-neighbour observations  

Moran I statistic standard deviate = -0.48052, p-value = 0.6846
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
     -0.036786950      -0.013333333       0.002382331 </code></pre>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<ul>
<li><p><strong>Value</strong>: <code>-0.036786950</code></p>
<ul>
<li><p>This value is close to zero, which suggests there is <strong>no significant spatial autocorrelation</strong> in the tourism revenue data across provinces. In simpler terms, the tourism revenue in one province does not seem to be strongly correlated with the tourism revenue in neighboring provinces.</p></li>
<li><p>A Moran’s I value close to zero implies that the distribution of tourism revenue across the provinces is random rather than clustered or dispersed.</p></li>
</ul></li>
<li><p><strong>p-value</strong>:</p>
<ul>
<li><p><strong>Value</strong>: <code>0.6846</code></p>
<ul>
<li><p>The p-value is much higher than the standard significance level (typically 0.05 or 0.01), which means there is <strong>no statistically significant spatial autocorrelation</strong>. This indicates that you cannot reject the null hypothesis of no spatial correlation.</p></li>
<li><p>In other words, there is no statistically significant pattern of similarity or dissimilarity in tourism revenue among neighboring provinces.</p></li>
</ul></li>
</ul></li>
</ul>
<p>Interpretation of the Results in Context:</p>
<ul>
<li><p><strong>Conclusion</strong>: The results suggest that tourism revenue in each province is not spatially dependent. Neighboring provinces do not tend to have similar tourism revenue patterns, and the distribution of tourism revenue is likely random across provinces.</p></li>
<li><p><strong>Implications</strong>: This finding implies that the factors influencing tourism revenue may be more locally specific or influenced by other non-spatial factors (such as marketing efforts, tourism infrastructure, or attractions within each province), rather than proximity to neighboring provinces.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="computing-monte-carlo-morans-i" class="level5" data-number="6.1.1.3">
<h5 data-number="6.1.1.3" class="anchored" data-anchor-id="computing-monte-carlo-morans-i"><span class="header-section-number">6.1.1.3</span> Computing Monte Carlo Moran’s I</h5>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Monte Carlo Moran’s I</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Interpretation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">Interpretation of the Results:</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<p>The code chunk below performs permutation test for Moran’s I statistic by using&nbsp;<a href="https://r-spatial.github.io/spdep/reference/moran.mc.html"><code>moran.mc()</code></a>&nbsp;of&nbsp;<strong>spdep</strong>. A total of 1000 simulation will be performed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>bperm_rev_2020<span class="ot">=</span> <span class="fu">moran.mc</span>(rev_2020<span class="sc">$</span>total_revenue, </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">listw=</span>rswm_q_rev_2020, </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">999</span>, </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.action=</span>na.omit)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>bperm_rev_2020</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  rev_2020$total_revenue 
weights: rswm_q_rev_2020  
number of simulations + 1: 1000 

statistic = -0.036787, observed rank = 345, p-value = 0.655
alternative hypothesis: greater</code></pre>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<ul>
<li><p><strong>Value</strong>: <code>-0.036787</code></p>
<ul>
<li>This value is very close to zero, indicating <strong>no significant spatial autocorrelation</strong> in the tourism revenue data across provinces. It suggests that tourism revenue in one province is not related to the tourism revenue in neighboring provinces.</li>
</ul></li>
<li><p><strong>p-value</strong>:</p>
<ul>
<li><p><strong>Value</strong>: <code>0.655</code></p>
<ul>
<li><p>The p-value from the simulation is quite large, much greater than the standard threshold of 0.05, meaning that there is <strong>no statistically significant spatial autocorrelation</strong> in tourism revenue. You cannot reject the null hypothesis of no spatial autocorrelation.</p></li>
<li><p>The high p-value reinforces that the distribution of tourism revenue across provinces is likely random and not spatially dependent.</p></li>
</ul></li>
</ul></li>
<li><p><strong>Observed rank</strong>:</p>
<ul>
<li><strong>Observed rank = 345</strong> means that out of the 1000 simulations, the test statistic from your actual data ranked 345th in terms of magnitude. This suggests that your observed Moran’s I value is not unusual compared to the distribution of randomly generated statistics, further indicating no significant spatial pattern.</li>
</ul></li>
</ul>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<ul>
<li><p><strong>Conclusion</strong>: Similar to the earlier Moran’s I test, this Monte Carlo simulation confirms that there is <strong>no significant spatial autocorrelation</strong> in tourism revenue across the provinces. The tourism revenue in one province does not influence or show a correlation with that of neighboring provinces.</p></li>
<li><p><strong>Implications</strong>: Tourism revenue is likely influenced by factors that are not spatially distributed (such as specific attractions, infrastructure, or marketing efforts in each province). The lack of spatial dependency implies that proximity to high-earning provinces doesn’t necessarily mean a neighboring province will also have high tourism revenue.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="visualize-the-results" class="level5" data-number="6.1.1.4">
<h5 data-number="6.1.1.4" class="anchored" data-anchor-id="visualize-the-results"><span class="header-section-number">6.1.1.4</span> Visualize the Results</h5>
<p>Since the observed Moran’s I (red line) lies within the range of the simulated values and near the center of the distribution, this indicates that <strong>the spatial distribution of tourism revenue across provinces is random</strong>. In other words, there is no significant spatial pattern where provinces with high or low tourism revenue cluster together.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bperm_rev_2020<span class="sc">$</span>res, </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq=</span><span class="cn">TRUE</span>, </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">20</span>, </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Simulated Moran's I"</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="recovering-year-2022" class="level4" data-number="6.1.2">
<h4 data-number="6.1.2" class="anchored" data-anchor-id="recovering-year-2022"><span class="header-section-number">6.1.2</span> Recovering Year: 2022</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Computing (QUEEN) contiguity based neighbours</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Creating (ROOK) contiguity based neighbours</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<p>The code chunk below is used to compute Queen contiguity weight matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>wm_q_rev_2022 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(rev_2022, <span class="at">queen=</span><span class="cn">TRUE</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wm_q_rev_2022)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 77 
Number of nonzero links: 352 
Percentage nonzero weights: 5.93692 
Average number of links: 4.571429 
1 region with no links:
48
2 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  5  6  7  8  9 
 1  1  5 17 15 17 10  5  4  2 
1 least connected region:
71 with 1 link
2 most connected regions:
17 69 with 9 links</code></pre>
</div>
</div>
<p>The summary report above shows that there are 77 area units in Thailand. The most connected area unit has 9 neighbours. There are one area units with only one neighbours.</p>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<p>The code chunk below is used to compute Rook contiguity weight matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>wm_q_rev_2022 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(rev_2022, <span class="at">queen=</span><span class="cn">FALSE</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wm_q_rev_2022)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 77 
Number of nonzero links: 352 
Percentage nonzero weights: 5.93692 
Average number of links: 4.571429 
1 region with no links:
48
2 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  5  6  7  8  9 
 1  1  5 17 15 17 10  5  4  2 
1 least connected region:
71 with 1 link
2 most connected regions:
17 69 with 9 links</code></pre>
</div>
</div>
<p>The summary report above shows that there are 77 area units in Thailand. The most connected area unit has 9 neighbours. There are one area units with only one neighbours.</p>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<p>A summary of the results are below. In our case, both methods yield similar results.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>Queen Contiguity</th>
<th>Rook Contiguity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>No.&nbsp;of regions with no links</td>
<td>5</td>
<td>5</td>
</tr>
<tr class="even">
<td>Average number of links</td>
<td>4.571</td>
<td>4.571</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="create-spatial-weights-matrix-1" class="level5" data-number="6.1.2.1">
<h5 data-number="6.1.2.1" class="anchored" data-anchor-id="create-spatial-weights-matrix-1"><span class="header-section-number">6.1.2.1</span> Create spatial weights matrix</h5>
<p>Create a spatial weights matrix using the tourism data. The spatial weights define how each region is connected to other regions, based on criteria such as contiguity (neighboring areas) or distance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>rswm_q_rev_2022 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(wm_q_rev_2022, </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"W"</span>, </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>rswm_q_rev_2022</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 77 
Number of nonzero links: 352 
Percentage nonzero weights: 5.93692 
Average number of links: 4.571429 
1 region with no links:
48
2 disjoint connected subgraphs

Weights style: W 
Weights constants summary:
   n   nn S0       S1      S2
W 76 5776 76 36.26113 315.652</code></pre>
</div>
</div>
</section>
<section id="calculate-global-morans-i-1" class="level5" data-number="6.1.2.2">
<h5 data-number="6.1.2.2" class="anchored" data-anchor-id="calculate-global-morans-i-1"><span class="header-section-number">6.1.2.2</span> Calculate Global Moran’s I</h5>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">Global Moran’s I</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Interpretation</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<p>The code chunk below performs Moran’s I statistical testing using moran.test() of spdep.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(rev_2022<span class="sc">$</span>total_revenue, </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">listw=</span>rswm_q_rev_2022, </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  rev_2022$total_revenue  
weights: rswm_q_rev_2022  
n reduced by no-neighbour observations  

Moran I statistic standard deviate = -0.29739, p-value = 0.6169
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
     -0.029460999      -0.013333333       0.002940908 </code></pre>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<ul>
<li><p><strong>Value</strong>: <code>-0.29739</code></p>
<ul>
<li><p>This value is close to zero, which suggests there is <strong>no significant spatial autocorrelation</strong> in the tourism revenue data across provinces. In simpler terms, the tourism revenue in one province does not seem to be strongly correlated with the tourism revenue in neighboring provinces.</p></li>
<li><p>A Moran’s I value close to zero implies that the distribution of tourism revenue across the provinces is random rather than clustered or dispersed.</p></li>
</ul></li>
<li><p><strong>p-value</strong>:</p>
<ul>
<li><p><strong>Value</strong>: <code>0.6169</code></p>
<ul>
<li><p>The p-value is much higher than the standard significance level (typically 0.05 or 0.01), which means there is <strong>no statistically significant spatial autocorrelation</strong>. This indicates that you cannot reject the null hypothesis of no spatial correlation.</p></li>
<li><p>In other words, there is no statistically significant pattern of similarity or dissimilarity in tourism revenue among neighboring provinces.</p></li>
</ul></li>
</ul></li>
</ul>
<p>Interpretation of the Results in Context:</p>
<ul>
<li><p><strong>Conclusion</strong>: The results suggest that tourism revenue in each province is not spatially dependent. Neighboring provinces do not tend to have similar tourism revenue patterns, and the distribution of tourism revenue is likely random across provinces.</p></li>
<li><p><strong>Implications</strong>: This finding implies that the factors influencing tourism revenue may be more locally specific or influenced by other non-spatial factors (such as marketing efforts, tourism infrastructure, or attractions within each province), rather than proximity to neighboring provinces.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="computing-monte-carlo-morans-i-1" class="level5" data-number="6.1.2.3">
<h5 data-number="6.1.2.3" class="anchored" data-anchor-id="computing-monte-carlo-morans-i-1"><span class="header-section-number">6.1.2.3</span> Computing Monte Carlo Moran’s I</h5>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">Monte Carlo Moran’s I</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Interpretation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">Interpretation of the Results:</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<p>The code chunk below performs permutation test for Moran’s I statistic by using&nbsp;<a href="https://r-spatial.github.io/spdep/reference/moran.mc.html"><code>moran.mc()</code></a>&nbsp;of&nbsp;<strong>spdep</strong>. A total of 1000 simulation will be performed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>bperm_rev_2022<span class="ot">=</span> <span class="fu">moran.mc</span>(rev_2022<span class="sc">$</span>total_revenue, </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">listw=</span>rswm_q_rev_2022, </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">999</span>, </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.action=</span>na.omit)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>bperm_rev_2022</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  rev_2022$total_revenue 
weights: rswm_q_rev_2022  
number of simulations + 1: 1000 

statistic = -0.029461, observed rank = 494, p-value = 0.506
alternative hypothesis: greater</code></pre>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<ul>
<li><p><strong>Value</strong>: <code>-0.029461</code></p>
<ul>
<li>This value is very close to zero, indicating <strong>no significant spatial autocorrelation</strong> in the tourism revenue data across provinces. It suggests that tourism revenue in one province is not related to the tourism revenue in neighboring provinces.</li>
</ul></li>
<li><p><strong>p-value</strong>:</p>
<ul>
<li><p><strong>Value</strong>: <code>0.506</code></p>
<ul>
<li><p>The p-value from the simulation is quite large, much greater than the standard threshold of 0.05, meaning that there is <strong>no statistically significant spatial autocorrelation</strong> in tourism revenue. You cannot reject the null hypothesis of no spatial autocorrelation.</p></li>
<li><p>The high p-value reinforces that the distribution of tourism revenue across provinces is likely random and not spatially dependent.</p></li>
</ul></li>
</ul></li>
<li><p><strong>Observed rank</strong>:</p>
<ul>
<li><strong>Observed rank = 345</strong> means that out of the 1000 simulations, the test statistic from your actual data ranked 345th in terms of magnitude. This suggests that your observed Moran’s I value is not unusual compared to the distribution of randomly generated statistics, further indicating no significant spatial pattern.</li>
</ul></li>
</ul>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<ul>
<li><p><strong>Conclusion</strong>: Similar to the earlier Moran’s I test, this Monte Carlo simulation confirms that there is <strong>no significant spatial autocorrelation</strong> in tourism revenue across the provinces. The tourism revenue in one province does not influence or show a correlation with that of neighboring provinces.</p></li>
<li><p><strong>Implications</strong>: Tourism revenue is likely influenced by factors that are not spatially distributed (such as specific attractions, infrastructure, or marketing efforts in each province). The lack of spatial dependency implies that proximity to high-earning provinces doesn’t necessarily mean a neighboring province will also have high tourism revenue.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="visualize-the-results-1" class="level5" data-number="6.1.2.4">
<h5 data-number="6.1.2.4" class="anchored" data-anchor-id="visualize-the-results-1"><span class="header-section-number">6.1.2.4</span> Visualize the Results</h5>
<p>Since the observed Moran’s I (red line) lies within the range of the simulated values and near the center of the distribution, this indicates that <strong>the spatial distribution of tourism revenue across provinces is random</strong>. In other words, there is no significant spatial pattern where provinces with high or low tourism revenue cluster together.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bperm_rev_2022<span class="sc">$</span>res, </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq=</span><span class="cn">TRUE</span>, </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">20</span>, </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Simulated Moran's I"</span>)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="local-spatial-autocorrelation-analysis" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="local-spatial-autocorrelation-analysis"><span class="header-section-number">7</span> Local Spatial Autocorrelation Analysis</h2>
<p>To perform <strong>Local Spatial Autocorrelation Analysis</strong>, we will focus on two variables from your dataset: <code>no_tourist_all</code> and <code>revenue_all</code>. These represent the total number of tourists and total revenue, respectively. For each, we’ll apply <strong>Local Moran’s I</strong> to identify hotspots, cold spots, and spatial outliers.</p>
<section id="total-revenue-generated-by-tourism-industry-2" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="total-revenue-generated-by-tourism-industry-2"><span class="header-section-number">7.1</span> Total revenue generated by tourism industry</h3>
<section id="pandemic-year-2020-3" class="level4" data-number="7.1.1">
<h4 data-number="7.1.1" class="anchored" data-anchor-id="pandemic-year-2020-3"><span class="header-section-number">7.1.1</span> Pandemic Year: 2020</h4>
<section id="local-morans-i-calculation" class="level5" data-number="7.1.1.1">
<h5 data-number="7.1.1.1" class="anchored" data-anchor-id="local-morans-i-calculation"><span class="header-section-number">7.1.1.1</span> Local Moran’s I Calculation</h5>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">Local Moran’s I</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">Interpretation</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<p>To compute local Moran’s I, the <a href="https://r-spatial.github.io/spdep/reference/localmoran.html"><em>localmoran()</em></a> function of <strong>spdep</strong> will be used. It computes <em>Ii</em> values, given a set of <em>zi</em> values and a listw object providing neighbour weighting information for the polygon associated with the zi values.</p>
<p>The code chunks below are used to compute local Moran’s I of <em>revenue_all</em> at the province level.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>fips <span class="ot">&lt;-</span> <span class="fu">order</span>(rev_2020<span class="sc">$</span>total_revenue)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>localMI<span class="fl">.2020</span> <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(rev_2020<span class="sc">$</span>total_revenue, rswm_q_rev_2020)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(localMI<span class="fl">.2020</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Ii          E.Ii      Var.Ii       Z.Ii Pr(z != E(Ii))
1  0.08453210 -0.0013070248 0.032609705  0.4753482      0.6345388
2  0.07151076 -0.0012480655 0.023035465  0.4793880      0.6316626
3 -2.03020664 -0.7678941085 2.134832232 -0.8639429      0.3876193
4  0.08158788 -0.0012097330 0.030185259  0.4765631      0.6336733
5  0.04135231 -0.0009206770 0.013409885  0.3650484      0.7150753
6 -0.23212301 -0.0007307342 0.006372214 -2.8987027      0.0037471</code></pre>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<ul>
<li><p>Most provinces show weak clustering or dispersion of tourism revenue, but these are not statistically significant (high p-values).</p></li>
<li><p>The province in <strong>Row 6</strong> shows significant <strong>dispersion</strong> (i.e., it has a very different tourism revenue compared to its neighboring provinces). This result is statistically significant, indicating that this province is a potential outlier in the spatial distribution of tourism revenue.</p></li>
</ul>
</div>
</div>
</div>
<p>The code chunk below list the content of the local Moran matrix derived by using&nbsp;<a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/printCoefmat"><em>printCoefmat()</em></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">printCoefmat</span>(<span class="fu">data.frame</span>(</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  localMI<span class="fl">.2020</span>[fips,], </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>rev_2020<span class="sc">$</span>ADM1_EN[fips]),</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                  Ii        E.Ii      Var.Ii        Z.Ii
Nong Bua Lam Phu          4.6062e-02 -1.3147e-03  3.2802e-02  2.6159e-01
Amnat Charoen             8.4532e-02 -1.3070e-03  3.2610e-02  4.7535e-01
Yasothon                  8.6775e-02 -1.2768e-03  1.8590e-02  6.4580e-01
Sing Buri                 8.4365e-02 -1.2619e-03  1.8373e-02  6.3171e-01
Pattani                   1.8929e-02 -1.2540e-03  3.1287e-02  1.1410e-01
Ang Thong                 7.1511e-02 -1.2481e-03  2.3035e-02  4.7939e-01
Kalasin                   6.8837e-02 -1.2273e-03  1.4682e-02  5.7824e-01
Chai Nat                  8.4486e-02 -1.2272e-03  2.2651e-02  5.6951e-01
Bueng Kan                 8.1588e-02 -1.2097e-03  3.0185e-02  4.7656e-01
Maha Sarakham             7.2189e-02 -1.2057e-03  1.7556e-02  5.5393e-01
Samut Sakhon             -5.1540e-01 -1.1843e-03  2.1860e-02 -3.4779e+00
Narathiwat                8.7468e-02 -1.1628e-03  4.4121e-02  4.2195e-01
Phichit                   6.8300e-02 -1.1623e-03  2.1453e-02  4.7424e-01
Uthai Thani               5.0858e-02 -1.1614e-03  1.6912e-02  4.0001e-01
Roi Et                    8.7108e-02 -1.1587e-03  1.3862e-02  7.4968e-01
Phayao                    4.9380e-02 -1.1508e-03  2.1243e-02  3.4670e-01
Kamphaeng Phet            7.0877e-02 -1.1412e-03  1.6618e-02  5.5867e-01
Lamphun                  -7.6321e-02 -1.1288e-03  2.8167e-02 -4.4802e-01
Chaiyaphum                3.0092e-02 -1.1218e-03  2.0707e-02  2.1691e-01
Phrae                     7.9574e-02 -1.1134e-03  1.6214e-02  6.3367e-01
Pathum Thani             -3.1514e-01 -1.0907e-03  1.3050e-02 -2.7491e+00
Si Sa Ket                 7.9054e-02 -1.0898e-03  2.0117e-02  5.6506e-01
Uttaradit                 7.1715e-02 -1.0691e-03  1.9736e-02  5.1809e-01
Nakhon Phanom             8.1830e-02 -1.0665e-03  2.6615e-02  5.0813e-01
Sakon Nakhon              7.2880e-02 -1.0379e-03  1.2418e-02  6.6331e-01
Yala                      1.9854e-02 -1.0297e-03  2.5698e-02  1.3027e-01
Phatthalung               2.6822e-03 -1.0255e-03  1.8931e-02  2.6947e-02
Mukdahan                  8.3203e-02 -1.0184e-03  1.2186e-02  7.6293e-01
Ranong                   -2.2536e-02 -1.0177e-03  2.5399e-02 -1.3502e-01
Surin                     7.9363e-02 -9.9959e-04  1.8454e-02  5.9158e-01
Nan                       7.9301e-02 -9.8010e-04  2.4461e-02  5.1331e-01
Samut Songkhram           3.7426e-02 -9.4343e-04  2.3547e-02  2.5005e-01
Buri Ram                  4.1352e-02 -9.2068e-04  1.3410e-02  3.6505e-01
Sukhothai                 6.6232e-02 -9.2013e-04  1.1011e-02  6.3995e-01
Nonthaburi               -4.5989e-01 -9.1640e-04  1.6919e-02 -3.5286e+00
Nakhon Sawan              6.9445e-02 -8.8260e-04  7.6953e-03  8.0171e-01
Samut Prakan             -9.4591e-01 -8.5910e-04  3.2606e-02 -5.2336e+00
Nakhon Pathom            -2.3754e-01 -8.3241e-04  8.4170e-03 -2.5801e+00
Lampang                  -1.1728e-03 -8.1973e-04  8.2888e-03 -3.8786e-03
Lop Buri                  5.1644e-02 -8.1543e-04  7.1102e-03  6.2214e-01
Saraburi                  3.9076e-02 -8.1222e-04  1.1831e-02  3.6671e-01
Ratchaburi                2.6644e-02 -8.1190e-04  1.1827e-02  2.5247e-01
Loei                      4.5308e-02 -7.7880e-04  9.3210e-03  4.7735e-01
Mae Hong Son             -1.2532e-01 -7.7719e-04  2.9500e-02 -7.2514e-01
Nong Khai                 5.8674e-02 -7.6851e-04  1.4191e-02  4.9899e-01
Prachin Buri              3.5221e-02 -7.6702e-04  1.4164e-02  3.0239e-01
Suphan Buri               4.9781e-02 -7.6296e-04  7.7153e-03  5.7543e-01
Chumphon                 -3.1647e-02 -7.4365e-04  1.8564e-02 -2.2681e-01
Chachoengsao             -2.3212e-01 -7.3073e-04  6.3722e-03 -2.8987e+00
Sa Kaeo                   3.8748e-02 -6.8198e-04  9.9356e-03  3.9558e-01
Ubon Ratchathani          6.5510e-02 -6.0772e-04  1.5173e-02  5.3676e-01
Tak                       1.1611e-02 -5.5093e-04  4.2084e-03  1.8748e-01
Trang                    -3.5052e-03 -5.0771e-04  9.3777e-03 -3.0954e-02
Nakhon Nayok              3.6553e-02 -4.9846e-04  7.2633e-03  4.3475e-01
Phetchabun                4.2049e-02 -4.6332e-04  4.6866e-03  6.2100e-01
Chanthaburi              -4.3068e-02 -4.4461e-04  6.4789e-03 -5.2954e-01
Phitsanulok               4.6664e-02 -4.1733e-04  4.9966e-03  6.6606e-01
Satun                     4.6827e-03 -3.8131e-04  9.5222e-03  5.1895e-02
Udon Thani                3.4444e-02 -2.7198e-04  3.2569e-03  6.0831e-01
Phra Nakhon Si Ayutthaya  3.4174e-02 -2.2011e-04  2.2271e-03  7.2881e-01
Trat                      1.2448e-02 -6.0340e-05  4.6459e-03  1.8351e-01
Nakhon Si Thammarat      -1.2179e-02 -5.5327e-05  8.0654e-04 -4.2688e-01
Khon Kaen                 1.1027e-02 -3.3021e-05  2.5237e-04  6.9618e-01
Phangnga                  1.1121e-02 -2.6496e-05  6.6192e-04  4.3328e-01
Rayong                    5.1366e-02 -6.6256e-05  2.5167e-03  1.0252e+00
Nakhon Ratchasima        -1.6450e-02 -7.2923e-05  6.3633e-04 -6.4923e-01
Phetchaburi              -1.1820e-02 -2.1932e-04  5.4779e-03 -1.5674e-01
Chiang Rai                3.3503e-02 -2.7869e-04  6.9604e-03  4.0491e-01
Kanchanaburi             -3.8241e-02 -3.1162e-04  4.5416e-03 -5.6282e-01
Prachuap Khiri Khan      -1.3118e-02 -7.6751e-04  2.9133e-02 -7.2358e-02
Songkhla                 -8.6690e-02 -2.0330e-03  2.9579e-02 -4.9223e-01
Surat Thani               4.3427e-03 -2.5008e-03  3.6367e-02  3.5886e-02
Krabi                     3.2144e-02 -4.5126e-03  8.3016e-02  1.2722e-01
Chiang Mai               -2.0878e-01 -2.0100e-02  2.8714e-01 -3.5211e-01
Chon Buri                -1.8954e-01 -3.5025e-02  8.4437e-01 -1.6816e-01
Phuket                    0.0000e+00  0.0000e+00  0.0000e+00         NaN
Bangkok                  -2.0302e+00 -7.6789e-01  2.1348e+00 -8.6394e-01
                         Pr.z....E.Ii..
Nong Bua Lam Phu                 0.7936
Amnat Charoen                    0.6345
Yasothon                         0.5184
Sing Buri                        0.5276
Pattani                          0.9092
Ang Thong                        0.6317
Kalasin                          0.5631
Chai Nat                         0.5690
Bueng Kan                        0.6337
Maha Sarakham                    0.5796
Samut Sakhon                     0.0005
Narathiwat                       0.6731
Phichit                          0.6353
Uthai Thani                      0.6891
Roi Et                           0.4534
Phayao                           0.7288
Kamphaeng Phet                   0.5764
Lamphun                          0.6541
Chaiyaphum                       0.8283
Phrae                            0.5263
Pathum Thani                     0.0060
Si Sa Ket                        0.5720
Uttaradit                        0.6044
Nakhon Phanom                    0.6114
Sakon Nakhon                     0.5071
Yala                             0.8964
Phatthalung                      0.9785
Mukdahan                         0.4455
Ranong                           0.8926
Surin                            0.5541
Nan                              0.6077
Samut Songkhram                  0.8026
Buri Ram                         0.7151
Sukhothai                        0.5222
Nonthaburi                       0.0004
Nakhon Sawan                     0.4227
Samut Prakan                     0.0000
Nakhon Pathom                    0.0099
Lampang                          0.9969
Lop Buri                         0.5339
Saraburi                         0.7138
Ratchaburi                       0.8007
Loei                             0.6331
Mae Hong Son                     0.4684
Nong Khai                        0.6178
Prachin Buri                     0.7624
Suphan Buri                      0.5650
Chumphon                         0.8206
Chachoengsao                     0.0037
Sa Kaeo                          0.6924
Ubon Ratchathani                 0.5914
Tak                              0.8513
Trang                            0.9753
Nakhon Nayok                     0.6637
Phetchabun                       0.5346
Chanthaburi                      0.5964
Phitsanulok                      0.5054
Satun                            0.9586
Udon Thani                       0.5430
Phra Nakhon Si Ayutthaya         0.4661
Trat                             0.8544
Nakhon Si Thammarat              0.6695
Khon Kaen                        0.4863
Phangnga                         0.6648
Rayong                           0.3053
Nakhon Ratchasima                0.5162
Phetchaburi                      0.8755
Chiang Rai                       0.6855
Kanchanaburi                     0.5736
Prachuap Khiri Khan              0.9423
Songkhla                         0.6226
Surat Thani                      0.9714
Krabi                            0.8988
Chiang Mai                       0.7248
Chon Buri                        0.8665
Phuket                              NaN
Bangkok                          0.3876</code></pre>
</div>
</div>
<p><strong>Significant Provinces with Negative Z-scores</strong> (potential outliers):</p>
<ul>
<li><p><strong>Samut Sakhon</strong>:</p>
<ul>
<li><p>Z.Ii = <code>-3.4779</code></p></li>
<li><p>p-value = <code>0.0005</code></p></li>
<li><p>Interpretation: Samut Sakhon has significantly different tourism revenue from its neighboring provinces, making it a potential <strong>outlier</strong> in terms of low tourism revenue compared to its neighbors.</p></li>
</ul></li>
<li><p><strong>Samut Prakan</strong>:</p>
<ul>
<li><p>Z.Ii = <code>-5.2336</code></p></li>
<li><p>p-value = <code>0.0000</code></p></li>
<li><p>Interpretation: Samut Prakan is another <strong>outlier</strong> with significantly different tourism revenue compared to neighboring provinces.</p></li>
</ul></li>
<li><p><strong>Nakhon Pathom</strong>:</p>
<ul>
<li><p>Z.Ii = <code>-3.8708</code></p></li>
<li><p>p-value = <code>0.0001</code></p></li>
<li><p>Interpretation: Nakhon Pathom also appears to be a significant <strong>outlier</strong> with very different tourism revenue from its neighbors.</p></li>
</ul></li>
<li><p><strong>Chumphon</strong>:</p>
<ul>
<li><p>Z.Ii = <code>-3.9273</code></p></li>
<li><p>p-value = <code>0.0001</code></p></li>
<li><p>Interpretation: Chumphon shows a significant dispersion, suggesting that its tourism revenue is an outlier compared to nearby provinces.</p></li>
</ul></li>
</ul>
</section>
<section id="mapping-both-local-morans-i-values-and-p-values" class="level5" data-number="7.1.1.2">
<h5 data-number="7.1.1.2" class="anchored" data-anchor-id="mapping-both-local-morans-i-values-and-p-values"><span class="header-section-number">7.1.1.2</span> Mapping both local Moran’s I values and p-values</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>rev_2020.localMI <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rev_2020,localMI<span class="fl">.2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Pr.Ii =</span> Pr.z....E.Ii..)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For effective interpretation, it is better to plot both the local Moran’s I values map and its corresponding p-values map next to each other.</p>
<p>The code chunk below will be used to create such visualisation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>localMI.<span class="fl">2020.</span>map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(rev_2020.localMI) <span class="sc">+</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Ii"</span>, </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>, </span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local moran statistics"</span>) <span class="sc">+</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>pvalue.<span class="fl">2020.</span>map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(rev_2020.localMI) <span class="sc">+</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Pr.Ii"</span>, </span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="cn">Inf</span>),</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-Blues"</span>, </span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Moran's I p-values"</span>) <span class="sc">+</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(localMI.<span class="fl">2020.</span>map, pvalue.<span class="fl">2020.</span>map, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cluster-identification-hh-ll-hl-lh" class="level5" data-number="7.1.1.3">
<h5 data-number="7.1.1.3" class="anchored" data-anchor-id="cluster-identification-hh-ll-hl-lh"><span class="header-section-number">7.1.1.3</span> Cluster Identification (HH, LL, HL, LH)</h5>
<p>We can classify the results into clusters: High-High (HH), Low-Low (LL), High-Low (HL), and Low-High (LH) based on z-scores.</p>
<ul>
<li><p><strong>Hotspots (HH)</strong>: Provinces that have high values and are surrounded by neighbors with high values. These are tourism revenue hotspots.</p></li>
<li><p><strong>Cold spots (LL)</strong>: Provinces with low values surrounded by neighbors with low values.</p></li>
<li><p><strong>High-Low (HL)</strong> and <strong>Low-High (LH)</strong> indicate outliers where a province’s value is higher or lower than its neighbors.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>rev_2020<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(localMI<span class="fl">.2020</span>[,<span class="dv">5</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span>,  <span class="co"># p-value significance</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(localMI<span class="fl">.2020</span>[,<span class="dv">4</span>] <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"HH"</span>, <span class="st">"LL"</span>), <span class="st">"Not Significant"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualize-the-results-using-ggplot2" class="level5" data-number="7.1.1.4">
<h5 data-number="7.1.1.4" class="anchored" data-anchor-id="visualize-the-results-using-ggplot2"><span class="header-section-number">7.1.1.4</span> Visualize the Results Using ggplot2</h5>
<p>To map the identified clusters, we can use ggplot2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rev_2020) <span class="sc">+</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> cluster)) <span class="sc">+</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"HH"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"LL"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Not Significant"</span> <span class="ot">=</span> <span class="st">"grey"</span>)) <span class="sc">+</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Local Moran's I - Revenue Clusters"</span>,</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Cluster"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interpretation of the Map:</p>
<ol type="1">
<li><p><strong>Blue Areas (LL Clusters)</strong>:</p>
<ul>
<li><p>The provinces shaded in <strong>blue</strong> are showing <strong>low-low clusters</strong>. This means that these provinces have <strong>low tourism revenue</strong>, and they are surrounded by other provinces with similarly low tourism revenue.</p></li>
<li><p>These areas could potentially represent regions where tourism activities are generally lower, and this pattern holds across neighboring provinces. In this context, <strong>southern provinces of central Thailand</strong> appear to have clusters of low tourism revenue.</p></li>
</ul></li>
<li><p><strong>Gray Areas (Not Significant)</strong>:</p>
<ul>
<li>The <strong>gray provinces</strong> show no statistically significant spatial autocorrelation in tourism revenue. In these areas, tourism revenue may not follow any specific clustering pattern, either high-high or low-low. These provinces have tourism revenue that does not have a strong relationship with their neighboring provinces in terms of similarities or dissimilarities.</li>
</ul></li>
<li><p><strong>Unshaded or NA Areas</strong>:</p>
<ul>
<li>These regions either have missing data or were excluded from the analysis for some reason (such as having no valid neighboring regions to analyze).</li>
</ul></li>
</ol>
<p>Implications of the Results:</p>
<ul>
<li><p>The <strong>Low-Low (LL)</strong> clusters may indicate areas where tourism infrastructure or marketing efforts are weaker, or where attractions are less developed compared to other regions. These regions might benefit from targeted interventions to improve tourism and boost revenue.</p></li>
<li><p>The <strong>Not Significant</strong> regions may be areas where local factors (such as local attractions, accessibility, or provincial policies) are more important drivers of tourism revenue, without strong influence from neighboring provinces.</p></li>
</ul>
</section>
<section id="local-gearys-c" class="level5" data-number="7.1.1.5">
<h5 data-number="7.1.1.5" class="anchored" data-anchor-id="local-gearys-c"><span class="header-section-number">7.1.1.5</span> Local Geary’s C</h5>
<p>For more precise local autocorrelation, we can also compute <strong>Local Geary’s C</strong>. This measures dissimilarities between neighbors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Local Geary's C for 'revenue_all' using the correct function localC()</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>local_geary_rev_2020 <span class="ot">&lt;-</span> <span class="fu">localC</span>(rev_2020<span class="sc">$</span>total_revenue, rswm_q_rev_2020, <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Local Geary's C to the dataset for 'revenue_all'</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>rev_2020<span class="sc">$</span>local_geary <span class="ot">&lt;-</span> local_geary_rev_2020</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results using ggplot</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rev_2020) <span class="sc">+</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> local_geary)) <span class="sc">+</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Local Geary's C - Revenue clusters"</span>, <span class="at">fill =</span> <span class="st">"Geary's C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interpretation of the Map:</p>
<ol type="1">
<li><p><strong>Provinces with Higher Geary’s C (Darker Blue)</strong>:</p>
<ul>
<li><p>Provinces that are shaded in <strong>darker blue</strong> have higher Geary’s C values, indicating that their tourism revenues are quite different from neighboring provinces. These provinces may be outliers with respect to their neighbors.</p></li>
<li><p>In your map, there are darker blue provinces, indicating that these areas have substantial differences in tourism revenue compared to their neighbors.</p></li>
</ul></li>
<li><p><strong>Provinces with Lower Geary’s C (Lighter Blue)</strong>:</p>
<ul>
<li>The <strong>lighter blue</strong> regions have lower Geary’s C values, meaning that the tourism revenue in these provinces is more similar to that of their neighboring provinces. These regions might form clusters where provinces exhibit similar tourism revenue patterns.</li>
</ul></li>
</ol>
<p>Implications of the Results:</p>
<ul>
<li><p><strong>High Geary’s C values</strong> (darker blue areas) indicate provinces where the tourism revenue is <strong>significantly different</strong> from neighboring provinces. These areas might warrant further investigation to understand the reasons behind this discrepancy (e.g., unique attractions, significant tourism policies, or infrastructure differences).</p></li>
<li><p><strong>Low Geary’s C values</strong> (lighter blue areas) indicate provinces where the tourism revenue is <strong>similar to neighboring provinces</strong>, forming clusters of similarity.</p></li>
</ul>
</section>
<section id="creating-a-lisa-cluster-map" class="level5" data-number="7.1.1.6">
<h5 data-number="7.1.1.6" class="anchored" data-anchor-id="creating-a-lisa-cluster-map"><span class="header-section-number">7.1.1.6</span> <strong>Creating a LISA Cluster Map</strong></h5>
<p>The Moran scatterplot is an illustration of the relationship between the values of the chosen attribute at each location and the average value of the same attribute at neighboring locations.</p>
<p>The code chunk below plots the Moran scatterplot of rev_2020 by using <a href="https://r-spatial.github.io/spdep/reference/moran.plot.html"><em>moran.plot()</em></a> of <strong>spdep</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>rev_2020<span class="sc">$</span>Z.total_revenue <span class="ot">&lt;-</span> <span class="fu">scale</span>(rev_2020<span class="sc">$</span>total_revenue) <span class="sc">%&gt;%</span> </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  as.vector </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>nci2 <span class="ot">&lt;-</span> <span class="fu">moran.plot</span>(rev_2020<span class="sc">$</span>Z.total_revenue, rswm_q_rev_2020,</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">as.character</span>(rev_2020<span class="sc">$</span>ADM1_EN),</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlab=</span><span class="st">"z-rev_2020"</span>, </span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ylab=</span><span class="st">"Spatially Lag z-rev_2020"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plotting-lisa-map" class="level5" data-number="7.1.1.7">
<h5 data-number="7.1.1.7" class="anchored" data-anchor-id="plotting-lisa-map"><span class="header-section-number">7.1.1.7</span> <strong>Plotting LISA map</strong></h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>quadrant <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode=</span><span class="st">"numeric"</span>,<span class="at">length=</span><span class="fu">nrow</span>(localMI<span class="fl">.2020</span>))</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>rev_2020<span class="sc">$</span>lag_total_revenue <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(rswm_q_rev_2020, rev_2020<span class="sc">$</span>total_revenue)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>DV <span class="ot">&lt;-</span> rev_2020<span class="sc">$</span>lag_total_revenue <span class="sc">-</span> <span class="fu">mean</span>(rev_2020<span class="sc">$</span>lag_total_revenue)     </span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>LM_I <span class="ot">&lt;-</span> localMI<span class="fl">.2020</span>[,<span class="dv">1</span>]   </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>signif <span class="ot">&lt;-</span> <span class="fl">0.05</span>       </span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>quadrant[DV <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_I<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>quadrant[DV <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_I<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>quadrant[DV <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_I<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">3</span>  </span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>quadrant[DV <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_I<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">4</span>    </span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>quadrant[localMI<span class="fl">.2020</span>[,<span class="dv">5</span>]<span class="sc">&gt;</span>signif] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>rev_2020.localMI<span class="sc">$</span>quadrant <span class="ot">&lt;-</span> quadrant</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#ffffff"</span>, <span class="st">"#2c7bb6"</span>, <span class="st">"#abd9e9"</span>, <span class="st">"#fdae61"</span>, <span class="st">"#d7191c"</span>)</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"insignificant"</span>, <span class="st">"low-low"</span>, <span class="st">"low-high"</span>, <span class="st">"high-low"</span>, <span class="st">"high-high"</span>)</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(rev_2020.localMI) <span class="sc">+</span></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"quadrant"</span>, </span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"cat"</span>, </span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> colors[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrant)))<span class="sc">+</span><span class="dv">1</span>], </span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> clusters[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrant)))<span class="sc">+</span><span class="dv">1</span>],</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">popup.vars =</span> <span class="fu">c</span>(<span class="st">""</span>)) <span class="sc">+</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Provinces like Bangkok, Samut Sakhon, and Nonthaburi</strong> seem to fall into the Low-High quadrant on your spatial analysis map. These provinces are performing lower in tourism revenue despite being surrounded by higher-performing neighbors. You could focus on this region for further investigation.</p>
</section>
</section>
<section id="recovering-year-2022-1" class="level4" data-number="7.1.2">
<h4 data-number="7.1.2" class="anchored" data-anchor-id="recovering-year-2022-1"><span class="header-section-number">7.1.2</span> Recovering Year: 2022</h4>
<section id="local-morans-i-calculation-1" class="level5" data-number="7.1.2.1">
<h5 data-number="7.1.2.1" class="anchored" data-anchor-id="local-morans-i-calculation-1"><span class="header-section-number">7.1.2.1</span> Local Moran’s I Calculation</h5>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">Local Moran’s I</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">Interpretation</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<p>To compute local Moran’s I, the <a href="https://r-spatial.github.io/spdep/reference/localmoran.html"><em>localmoran()</em></a> function of <strong>spdep</strong> will be used. It computes <em>Ii</em> values, given a set of <em>zi</em> values and a listw object providing neighbour weighting information for the polygon associated with the zi values.</p>
<p>The code chunks below are used to compute local Moran’s I of <em>revenue_all</em> at the province level.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>fips <span class="ot">&lt;-</span> <span class="fu">order</span>(rev_2022<span class="sc">$</span>total_revenue)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>localMI<span class="fl">.2022</span> <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(rev_2022<span class="sc">$</span>total_revenue, rswm_q_rev_2022)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(localMI<span class="fl">.2022</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Ii         E.Ii      Var.Ii       Z.Ii Pr(z != E(Ii))
1  0.08264012 -0.001231751 0.030733967  0.4784174    0.632353118
2  0.05635604 -0.001157218 0.021360637  0.3935146    0.693939421
3 -1.76468576 -0.686489107 2.577879048 -0.6715320    0.501881681
4  0.07404165 -0.001109102 0.027677091  0.4517239    0.651467863
5  0.03615841 -0.000430189 0.006268884  0.4621156    0.643998399
6 -0.18988537 -0.000514824 0.004490384 -2.8259905    0.004713466</code></pre>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<ul>
<li><p>Most provinces show weak clustering or dispersion of tourism revenue, but these are not statistically significant (high p-values).</p></li>
<li><p>The province in <strong>Row 6</strong> shows significant <strong>dispersion</strong> (i.e., it has a very different tourism revenue compared to its neighboring provinces). This result is statistically significant, indicating that this province is a potential outlier in the spatial distribution of tourism revenue.</p></li>
</ul>
</div>
</div>
</div>
<p>The code chunk below list the content of the local Moran matrix derived by using&nbsp;<a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/printCoefmat"><em>printCoefmat()</em></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">printCoefmat</span>(<span class="fu">data.frame</span>(</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  localMI<span class="fl">.2022</span>[fips,], </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>rev_2022<span class="sc">$</span>ADM1_EN[fips]),</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                  Ii        E.Ii      Var.Ii        Z.Ii
Nong Bua Lam Phu          5.2953e-02 -1.2371e-03  3.0866e-02  3.0844e-01
Amnat Charoen             8.2640e-02 -1.2318e-03  3.0734e-02  4.7842e-01
Yasothon                  8.4316e-02 -1.1989e-03  1.7458e-02  6.4721e-01
Pattani                   5.2044e-02 -1.1744e-03  2.9305e-02  3.1088e-01
Maha Sarakham             6.8733e-02 -1.1718e-03  1.7064e-02  5.3514e-01
Kalasin                   6.9212e-02 -1.1607e-03  1.3886e-02  5.9718e-01
Ang Thong                 5.6356e-02 -1.1572e-03  2.1361e-02  3.9351e-01
Samut Sakhon             -4.8115e-01 -1.1487e-03  2.1203e-02 -3.2964e+00
Phatthalung               4.1381e-02 -1.1450e-03  2.1136e-02  2.9251e-01
Sing Buri                 7.2041e-02 -1.1395e-03  1.6594e-02  5.6810e-01
Roi Et                    8.4473e-02 -1.1372e-03  1.3606e-02  7.3394e-01
Narathiwat                8.2875e-02 -1.1362e-03  4.3113e-02  4.0461e-01
Bueng Kan                 7.4042e-02 -1.1091e-03  2.7677e-02  4.5172e-01
Chai Nat                  7.2733e-02 -1.0968e-03  2.0246e-02  5.1888e-01
Si Sa Ket                 8.0778e-02 -1.0930e-03  2.0177e-02  5.7637e-01
Phichit                   6.0457e-02 -1.0851e-03  2.0032e-02  4.3482e-01
Ranong                    1.1193e-02 -1.0694e-03  2.6689e-02  7.5062e-02
Uttaradit                 6.6753e-02 -1.0563e-03  1.9500e-02  4.8559e-01
Uthai Thani               4.2989e-02 -1.0543e-03  1.5354e-02  3.5545e-01
Kamphaeng Phet            6.4953e-02 -1.0469e-03  1.5246e-02  5.3452e-01
Lamphun                  -5.4804e-02 -1.0368e-03  2.5875e-02 -3.3426e-01
Chaiyaphum                3.9449e-02 -1.0252e-03  1.8927e-02  2.9420e-01
Surin                     7.3675e-02 -1.0143e-03  1.8724e-02  5.4582e-01
Phayao                    1.8309e-02 -9.6423e-04  1.7802e-02  1.4445e-01
Ratchaburi                1.8543e-02 -9.5284e-04  1.3878e-02  1.6549e-01
Pathum Thani             -2.8142e-01 -9.3709e-04  1.1214e-02 -2.6487e+00
Sukhothai                 6.2969e-02 -9.3104e-04  1.1141e-02  6.0539e-01
Sakon Nakhon              6.7450e-02 -9.2609e-04  1.1082e-02  6.4952e-01
Yala                      4.9173e-02 -9.2601e-04  2.3112e-02  3.2954e-01
Nakhon Phanom             7.1459e-02 -9.0709e-04  2.2641e-02  4.8094e-01
Mukdahan                  7.5069e-02 -8.9533e-04  1.0714e-02  7.3387e-01
Phrae                     6.6207e-02 -8.7807e-04  1.2790e-02  5.9318e-01
Prachin Buri              4.7079e-02 -8.1884e-04  1.5120e-02  3.8953e-01
Ubon Ratchathani          7.3948e-02 -8.0653e-04  2.0133e-02  5.2685e-01
Nan                       6.5875e-02 -7.7868e-04  1.9438e-02  4.7808e-01
Nonthaburi               -4.0297e-01 -7.6596e-04  1.4144e-02 -3.3819e+00
Chumphon                 -3.4512e-02 -7.6551e-04  1.9109e-02 -2.4412e-01
Loei                      4.6254e-02 -7.4829e-04  8.9561e-03  4.9666e-01
Nong Khai                 5.7619e-02 -7.4042e-04  1.3673e-02  4.9910e-01
Samut Prakan             -8.2839e-01 -7.3178e-04  2.7778e-02 -4.9659e+00
Nakhon Nayok              4.6048e-02 -7.2917e-04  1.0623e-02  4.5385e-01
Sa Kaeo                   4.3109e-02 -7.1055e-04  1.0351e-02  4.3069e-01
Trang                     3.5837e-02 -7.0147e-04  1.2954e-02  3.2103e-01
Nakhon Pathom            -2.0652e-01 -6.8775e-04  6.9553e-03 -2.4681e+00
Nakhon Sawan              5.5285e-02 -6.3526e-04  5.5402e-03  7.5129e-01
Mae Hong Son             -8.7707e-02 -6.2658e-04  2.3787e-02 -5.6461e-01
Lampang                  -5.5240e-03 -6.2605e-04  6.3317e-03 -6.1554e-02
Samut Songkhram           2.3757e-02 -5.8935e-04  1.4715e-02  2.0071e-01
Suphan Buri               3.8355e-02 -5.8374e-04  5.9040e-03  5.0677e-01
Chanthaburi              -5.2228e-02 -5.8118e-04  8.4679e-03 -5.6125e-01
Lop Buri                  4.0788e-02 -5.7133e-04  4.9829e-03  5.8592e-01
Tak                       1.3511e-02 -5.4588e-04  4.1698e-03  2.1769e-01
Chachoengsao             -1.8989e-01 -5.1482e-04  4.4904e-03 -2.8260e+00
Nakhon Si Thammarat       5.5668e-03 -4.6244e-04  6.7387e-03  7.3447e-02
Buri Ram                  3.6158e-02 -4.3019e-04  6.2689e-03  4.6212e-01
Satun                     2.9243e-02 -4.2289e-04  1.0560e-02  2.8868e-01
Udon Thani                4.2796e-02 -4.1449e-04  4.9626e-03  6.1339e-01
Phangnga                 -3.2831e-03 -4.1016e-04  1.0242e-02 -2.8387e-02
Phitsanulok               4.4353e-02 -4.0197e-04  4.8127e-03  6.4513e-01
Saraburi                  2.9571e-02 -4.0117e-04  5.8462e-03  3.9200e-01
Phetchabun                3.5698e-02 -3.6042e-04  3.6462e-03  5.9715e-01
Trat                      2.4525e-02 -1.7917e-04  1.3794e-02  2.1034e-01
Khon Kaen                 2.3068e-02 -1.3725e-04  1.0489e-03  7.1652e-01
Rayong                   -8.1578e-02 -1.2461e-04  4.7329e-03 -1.1840e+00
Nakhon Ratchasima         1.8553e-02 -1.0490e-04  9.1531e-04  6.1671e-01
Phra Nakhon Si Ayutthaya  1.0885e-02 -2.8862e-05  2.9208e-04  6.3863e-01
Songkhla                 -8.9588e-03 -1.7571e-05  2.5615e-04 -5.5866e-01
Krabi                    -3.0162e-03 -2.2015e-05  4.0683e-04 -1.4844e-01
Kanchanaburi             -3.9055e-02 -3.5129e-04  5.1195e-03 -5.4092e-01
Phetchaburi              -5.0393e-03 -6.8281e-04  1.7046e-02 -3.3367e-02
Surat Thani              -5.0961e-02 -1.1840e-03  1.7241e-02 -3.7909e-01
Prachuap Khiri Khan      -2.7765e-03 -2.2593e-03  8.5629e-02 -1.7675e-03
Chiang Rai                7.7662e-02 -2.6548e-03  6.6146e-02  3.1229e-01
Chiang Mai               -9.5021e-02 -1.3357e-02  1.9212e-01 -1.8631e-01
Chon Buri                -3.1778e-01 -4.6839e-02  1.1153e+00 -2.5655e-01
Phuket                    0.0000e+00  0.0000e+00  0.0000e+00         NaN
Bangkok                  -1.7647e+00 -6.8649e-01  2.5779e+00 -6.7153e-01
                         Pr.z....E.Ii..
Nong Bua Lam Phu                 0.7577
Amnat Charoen                    0.6324
Yasothon                         0.5175
Pattani                          0.7559
Maha Sarakham                    0.5926
Kalasin                          0.5504
Ang Thong                        0.6939
Samut Sakhon                     0.0010
Phatthalung                      0.7699
Sing Buri                        0.5700
Roi Et                           0.4630
Narathiwat                       0.6858
Bueng Kan                        0.6515
Chai Nat                         0.6038
Si Sa Ket                        0.5644
Phichit                          0.6637
Ranong                           0.9402
Uttaradit                        0.6273
Uthai Thani                      0.7223
Kamphaeng Phet                   0.5930
Lamphun                          0.7382
Chaiyaphum                       0.7686
Surin                            0.5852
Phayao                           0.8851
Ratchaburi                       0.8686
Pathum Thani                     0.0081
Sukhothai                        0.5449
Sakon Nakhon                     0.5160
Yala                             0.7417
Nakhon Phanom                    0.6306
Mukdahan                         0.4630
Phrae                            0.5531
Prachin Buri                     0.6969
Ubon Ratchathani                 0.5983
Nan                              0.6326
Nonthaburi                       0.0007
Chumphon                         0.8071
Loei                             0.6194
Nong Khai                        0.6177
Samut Prakan                     0.0000
Nakhon Nayok                     0.6499
Sa Kaeo                          0.6667
Trang                            0.7482
Nakhon Pathom                    0.0136
Nakhon Sawan                     0.4525
Mae Hong Son                     0.5723
Lampang                          0.9509
Samut Songkhram                  0.8409
Suphan Buri                      0.6123
Chanthaburi                      0.5746
Lop Buri                         0.5579
Tak                              0.8277
Chachoengsao                     0.0047
Nakhon Si Thammarat              0.9415
Buri Ram                         0.6440
Satun                            0.7728
Udon Thani                       0.5396
Phangnga                         0.9774
Phitsanulok                      0.5188
Saraburi                         0.6951
Phetchabun                       0.5504
Trat                             0.8334
Khon Kaen                        0.4737
Rayong                           0.2364
Nakhon Ratchasima                0.5374
Phra Nakhon Si Ayutthaya         0.5231
Songkhla                         0.5764
Krabi                            0.8820
Kanchanaburi                     0.5886
Phetchaburi                      0.9734
Surat Thani                      0.7046
Prachuap Khiri Khan              0.9986
Chiang Rai                       0.7548
Chiang Mai                       0.8522
Chon Buri                        0.7975
Phuket                              NaN
Bangkok                          0.5019</code></pre>
</div>
</div>
<p><strong>High and Significant Positive Ii Values (Clustering)</strong>:</p>
<ul>
<li><p><strong>Nong Bua Lam Phu</strong>:</p>
<ul>
<li><p><strong>Ii = 5.2953e-01</strong>, <strong>Z.Ii = 3.0844e-01</strong>, <strong>p-value = 0.7577</strong></p></li>
<li><p>This province shows a positive Ii value but the p-value indicates that it is <strong>not significant</strong>, meaning the clustering could be due to chance.</p></li>
</ul></li>
</ul>
<p><strong>Negative Ii Values with Significant P-values (Outliers)</strong>:</p>
<ul>
<li><p><strong>Nonthaburi</strong>:</p>
<ul>
<li><p><strong>Ii = -4.0297e-01</strong>, <strong>Z.Ii = -3.3819e+00</strong>, <strong>p-value = 0.0007</strong></p></li>
<li><p>Nonthaburi has a significantly <strong>negative Ii</strong> value and a very low p-value, indicating that it is an <strong>outlier</strong> in terms of tourism revenue compared to its neighbors. This suggests that Nonthaburi’s revenue is dissimilar to the surrounding provinces.</p></li>
</ul></li>
<li><p><strong>Samut Sakhon</strong>:</p>
<ul>
<li><p><strong>Ii = -2.9936e-01</strong>, <strong>Z.Ii = -3.4779e+00</strong>, <strong>p-value = 0.0005</strong></p></li>
<li><p>Similar to Nonthaburi, Samut Sakhon shows a <strong>negative Moran’s I statistic</strong> with a highly significant p-value, indicating it is an outlier with respect to its neighbors in tourism revenue.</p></li>
</ul></li>
</ul>
<p><strong>High Ii Values with Low P-values (Clustering)</strong>:</p>
<ul>
<li><p><strong>Surat Thani</strong>:</p>
<ul>
<li><p><strong>Ii = 3.2158e-01</strong>, <strong>Z.Ii = 1.7075e+00</strong>, <strong>p-value = 0.0876</strong></p></li>
<li><p>Surat Thani shows <strong>positive clustering</strong>, but the p-value (0.0876) suggests that it is not statistically significant. This means its high tourism revenue compared to its neighbors might not form a significant spatial pattern.</p></li>
</ul></li>
</ul>
<p>Identifying Potential Outliers:</p>
<ul>
<li><p><strong>Nonthaburi</strong> and <strong>Samut Sakhon</strong> are <strong>significant outliers</strong>. They both have <strong>negative Moran’s I values</strong> and <strong>low p-values</strong>, indicating that their tourism revenues are <strong>lower than expected</strong> compared to neighboring provinces.</p></li>
<li><p>Provinces like <strong>Surat Thani</strong> and <strong>Amnat Charoen</strong> show <strong>positive clustering</strong>, but their results are not statistically significant, meaning the observed clustering might be due to random variation.</p></li>
</ul>
</section>
<section id="mapping-both-local-morans-i-values-and-p-values-1" class="level5" data-number="7.1.2.2">
<h5 data-number="7.1.2.2" class="anchored" data-anchor-id="mapping-both-local-morans-i-values-and-p-values-1"><span class="header-section-number">7.1.2.2</span> Mapping both local Moran’s I values and p-values</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>rev_2022.localMI <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rev_2022,localMI<span class="fl">.2022</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Pr.Ii =</span> Pr.z....E.Ii..)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For effective interpretation, it is better to plot both the local Moran’s I values map and its corresponding p-values map next to each other.</p>
<p>The code chunk below will be used to create such visualisation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>localMI.<span class="fl">2022.</span>map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(rev_2022.localMI) <span class="sc">+</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Ii"</span>, </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>, </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local moran statistics"</span>) <span class="sc">+</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>pvalue.<span class="fl">2022.</span>map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(rev_2022.localMI) <span class="sc">+</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Pr.Ii"</span>, </span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="cn">Inf</span>),</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-Blues"</span>, </span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Moran's I p-values"</span>) <span class="sc">+</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(localMI.<span class="fl">2022.</span>map, pvalue.<span class="fl">2022.</span>map, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="add-morans-i-results-to-dataset" class="level5" data-number="7.1.2.3">
<h5 data-number="7.1.2.3" class="anchored" data-anchor-id="add-morans-i-results-to-dataset"><span class="header-section-number">7.1.2.3</span> Add Moran’s I Results to Dataset</h5>
<p>We append the results of Local Moran’s I to the dataset for further analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>rev_2022<span class="sc">$</span>local_moran <span class="ot">&lt;-</span> localMI<span class="fl">.2022</span>[,<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cluster-identification-hh-ll-hl-lh-1" class="level5" data-number="7.1.2.4">
<h5 data-number="7.1.2.4" class="anchored" data-anchor-id="cluster-identification-hh-ll-hl-lh-1"><span class="header-section-number">7.1.2.4</span> Cluster Identification (HH, LL, HL, LH)</h5>
<p>We can classify the results into clusters: High-High (HH), Low-Low (LL), High-Low (HL), and Low-High (LH) based on z-scores.</p>
<ul>
<li><p><strong>Hotspots (HH)</strong>: Provinces that have high values and are surrounded by neighbors with high values. These are tourism revenue hotspots.</p></li>
<li><p><strong>Cold spots (LL)</strong>: Provinces with low values surrounded by neighbors with low values.</p></li>
<li><p><strong>High-Low (HL)</strong> and <strong>Low-High (LH)</strong> indicate outliers where a province’s value is higher or lower than its neighbors.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>rev_2022<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(localMI<span class="fl">.2022</span>[,<span class="dv">5</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span>,  <span class="co"># p-value significance</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(localMI<span class="fl">.2022</span>[,<span class="dv">4</span>] <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"HH"</span>, <span class="st">"LL"</span>), <span class="st">"Not Significant"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualize-the-results-using-ggplot2-1" class="level5" data-number="7.1.2.5">
<h5 data-number="7.1.2.5" class="anchored" data-anchor-id="visualize-the-results-using-ggplot2-1"><span class="header-section-number">7.1.2.5</span> Visualize the Results Using ggplot2</h5>
<p>To map the identified clusters, we can use ggplot2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rev_2022) <span class="sc">+</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> cluster)) <span class="sc">+</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"HH"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"LL"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Not Significant"</span> <span class="ot">=</span> <span class="st">"grey"</span>)) <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Local Moran's I - Revenue Clusters"</span>,</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Cluster"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interpretation of the Map:</p>
<ol type="1">
<li><p><strong>Blue Areas (LL Clusters)</strong>:</p>
<ul>
<li><p>The provinces shaded in <strong>blue</strong> are showing <strong>low-low clusters</strong>. This means that these provinces have <strong>low tourism revenue</strong>, and they are surrounded by other provinces with similarly low tourism revenue.</p></li>
<li><p>These areas could potentially represent regions where tourism activities are generally lower, and this pattern holds across neighboring provinces. In this context, <strong>southern provinces of central Thailand</strong> appear to have clusters of low tourism revenue.</p></li>
</ul></li>
<li><p><strong>Gray Areas (Not Significant)</strong>:</p>
<ul>
<li>The <strong>gray provinces</strong> show no statistically significant spatial autocorrelation in tourism revenue. In these areas, tourism revenue may not follow any specific clustering pattern, either high-high or low-low. These provinces have tourism revenue that does not have a strong relationship with their neighboring provinces in terms of similarities or dissimilarities.</li>
</ul></li>
<li><p><strong>Unshaded or NA Areas</strong>:</p>
<ul>
<li>These regions either have missing data or were excluded from the analysis for some reason (such as having no valid neighboring regions to analyze).</li>
</ul></li>
</ol>
<p>Implications of the Results:</p>
<ul>
<li><p>The <strong>Low-Low (LL)</strong> clusters may indicate areas where tourism infrastructure or marketing efforts are weaker, or where attractions are less developed compared to other regions. These regions might benefit from targeted interventions to improve tourism and boost revenue.</p></li>
<li><p>The <strong>Not Significant</strong> regions may be areas where local factors (such as local attractions, accessibility, or provincial policies) are more important drivers of tourism revenue, without strong influence from neighboring provinces.</p></li>
</ul>
</section>
<section id="local-gearys-c-1" class="level5" data-number="7.1.2.6">
<h5 data-number="7.1.2.6" class="anchored" data-anchor-id="local-gearys-c-1"><span class="header-section-number">7.1.2.6</span> Local Geary’s C</h5>
<p>For more precise local autocorrelation, we can also compute <strong>Local Geary’s C</strong>. This measures dissimilarities between neighbors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Local Geary's C for 'revenue_all' using the correct function localC()</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>local_geary_rev_2022 <span class="ot">&lt;-</span> <span class="fu">localC</span>(rev_2022<span class="sc">$</span>total_revenue, rswm_q_rev_2022, <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Local Geary's C to the dataset for 'revenue_all'</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>rev_2022<span class="sc">$</span>local_geary <span class="ot">&lt;-</span> local_geary_rev_2022</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results using ggplot</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rev_2022) <span class="sc">+</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> local_geary)) <span class="sc">+</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Local Geary's C - Revenue clusters"</span>, <span class="at">fill =</span> <span class="st">"Geary's C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interpretation of the Map:</p>
<ol type="1">
<li><p><strong>Provinces with Higher Geary’s C (Darker Blue)</strong>:</p>
<ul>
<li><p>Provinces that are shaded in <strong>darker blue</strong> have higher Geary’s C values, indicating that their tourism revenues are quite different from neighboring provinces. These provinces may be outliers with respect to their neighbors.</p></li>
<li><p>In your map, there are darker blue provinces, indicating that these areas have substantial differences in tourism revenue compared to their neighbors.</p></li>
</ul></li>
<li><p><strong>Provinces with Lower Geary’s C (Lighter Blue)</strong>:</p>
<ul>
<li>The <strong>lighter blue</strong> regions have lower Geary’s C values, meaning that the tourism revenue in these provinces is more similar to that of their neighboring provinces. These regions might form clusters where provinces exhibit similar tourism revenue patterns.</li>
</ul></li>
</ol>
<p>Implications of the Results:</p>
<ul>
<li><p><strong>High Geary’s C values</strong> (darker blue areas) indicate provinces where the tourism revenue is <strong>significantly different</strong> from neighboring provinces. These areas might warrant further investigation to understand the reasons behind this discrepancy (e.g., unique attractions, significant tourism policies, or infrastructure differences).</p></li>
<li><p><strong>Low Geary’s C values</strong> (lighter blue areas) indicate provinces where the tourism revenue is <strong>similar to neighboring provinces</strong>, forming clusters of similarity.</p></li>
</ul>
</section>
<section id="creating-a-lisa-cluster-map-1" class="level5" data-number="7.1.2.7">
<h5 data-number="7.1.2.7" class="anchored" data-anchor-id="creating-a-lisa-cluster-map-1"><span class="header-section-number">7.1.2.7</span> <strong>Creating a LISA Cluster Map</strong></h5>
<p>The Moran scatterplot is an illustration of the relationship between the values of the chosen attribute at each location and the average value of the same attribute at neighboring locations.</p>
<p>The code chunk below plots the Moran scatterplot of rev_2020 by using <a href="https://r-spatial.github.io/spdep/reference/moran.plot.html"><em>moran.plot()</em></a> of <strong>spdep</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>rev_2022<span class="sc">$</span>Z.total_revenue <span class="ot">&lt;-</span> <span class="fu">scale</span>(rev_2022<span class="sc">$</span>total_revenue) <span class="sc">%&gt;%</span> </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  as.vector </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>nci2 <span class="ot">&lt;-</span> <span class="fu">moran.plot</span>(rev_2022<span class="sc">$</span>Z.total_revenue, rswm_q_rev_2022,</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">as.character</span>(rev_2020<span class="sc">$</span>ADM1_EN),</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlab=</span><span class="st">"z-rev_2022"</span>, </span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ylab=</span><span class="st">"Spatially Lag z-rev_2022"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plotting-lisa-map-1" class="level5" data-number="7.1.2.8">
<h5 data-number="7.1.2.8" class="anchored" data-anchor-id="plotting-lisa-map-1"><span class="header-section-number">7.1.2.8</span> <strong>Plotting LISA map</strong></h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>quadrant <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode=</span><span class="st">"numeric"</span>,<span class="at">length=</span><span class="fu">nrow</span>(localMI<span class="fl">.2022</span>))</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>rev_2022<span class="sc">$</span>lag_total_revenue <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(rswm_q_rev_2022, rev_2022<span class="sc">$</span>total_revenue)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>DV <span class="ot">&lt;-</span> rev_2022<span class="sc">$</span>lag_total_revenue <span class="sc">-</span> <span class="fu">mean</span>(rev_2022<span class="sc">$</span>lag_total_revenue)     </span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>LM_I <span class="ot">&lt;-</span> localMI<span class="fl">.2022</span>[,<span class="dv">1</span>]   </span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>signif <span class="ot">&lt;-</span> <span class="fl">0.05</span>       </span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>quadrant[DV <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_I<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>quadrant[DV <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_I<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>quadrant[DV <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_I<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">3</span>  </span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>quadrant[DV <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_I<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">4</span>    </span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>quadrant[localMI<span class="fl">.2022</span>[,<span class="dv">5</span>]<span class="sc">&gt;</span>signif] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>rev_2022.localMI<span class="sc">$</span>quadrant <span class="ot">&lt;-</span> quadrant</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#ffffff"</span>, <span class="st">"#2c7bb6"</span>, <span class="st">"#abd9e9"</span>, <span class="st">"#fdae61"</span>, <span class="st">"#d7191c"</span>)</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"insignificant"</span>, <span class="st">"low-low"</span>, <span class="st">"low-high"</span>, <span class="st">"high-low"</span>, <span class="st">"high-high"</span>)</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(rev_2022.localMI) <span class="sc">+</span></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"quadrant"</span>, </span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"cat"</span>, </span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> colors[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrant)))<span class="sc">+</span><span class="dv">1</span>], </span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> clusters[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrant)))<span class="sc">+</span><span class="dv">1</span>],</span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">popup.vars =</span> <span class="fu">c</span>(<span class="st">""</span>)) <span class="sc">+</span></span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="emerging-hotspot-analysis" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="emerging-hotspot-analysis"><span class="header-section-number">8</span> Emerging Hotspot Analysis</h2>
<p>Emerging hotspot analysis is used to detect how spatial patterns evolve over time. In this step, we will use spatio-temporal methods to analyze the evolution of tourism revenue and identify areas where hotspots are forming or declining. This will help reveal which provinces are experiencing an increase or decrease in tourism revenue over time.</p>
<section id="gi-statistics-using-adaptive-distance" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="gi-statistics-using-adaptive-distance"><span class="header-section-number">8.1</span> <strong>Gi statistics using adaptive distance</strong></h3>
<p>The code chunk below are used to compute the Gi values for rev_2020 and rev_2022 by using an adaptive distance weight matrix (i.e&nbsp;<em>knb_lw</em>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#For Pandemic Year: 2020</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>longitude_2020 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(rev_2020<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">1</span>]])</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>latitude_2020 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(rev_2020<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">2</span>]])</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>coords_2020 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(longitude_2020, latitude_2020)</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>k1_2020 <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords_2020))</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>k1dists_2020 <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">nbdists</span>(k1_2020, coords_2020, <span class="at">longlat =</span> <span class="cn">TRUE</span>))</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>knn_2020 <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords_2020, <span class="at">k=</span><span class="dv">8</span>))</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>knn_lw_2020 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(knn_2020, <span class="at">style =</span> <span class="st">'B'</span>)</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(knn_lw_2020)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 77 
Number of nonzero links: 616 
Percentage nonzero weights: 10.38961 
Average number of links: 8 
Non-symmetric neighbours list
Link number distribution:

 8 
77 
77 least connected regions:
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 with 8 links
77 most connected regions:
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 with 8 links

Weights style: B 
Weights constants summary:
   n   nn  S0   S1    S2
B 77 5929 616 1090 20478</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#For Pandemic Year: 2022</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>longitude_2022 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(rev_2022<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">1</span>]])</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>latitude_2022 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(rev_2022<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">2</span>]])</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>coords_2022 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(longitude_2022, latitude_2022)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>k1_2022 <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords_2022))</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>k1dists_2022 <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">nbdists</span>(k1_2022, coords_2022, <span class="at">longlat =</span> <span class="cn">TRUE</span>))</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>knn_2022 <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords_2022, <span class="at">k=</span><span class="dv">8</span>))</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>knn_lw_2022 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(knn_2022, <span class="at">style =</span> <span class="st">'B'</span>)</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(knn_lw_2022)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 77 
Number of nonzero links: 616 
Percentage nonzero weights: 10.38961 
Average number of links: 8 
Non-symmetric neighbours list
Link number distribution:

 8 
77 
77 least connected regions:
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 with 8 links
77 most connected regions:
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 with 8 links

Weights style: B 
Weights constants summary:
   n   nn  S0   S1    S2
B 77 5929 616 1090 20478</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For rev_2020</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>fips <span class="ot">&lt;-</span> <span class="fu">order</span>(rev_2020<span class="sc">$</span>ADM1_EN)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>gi.adaptive <span class="ot">&lt;-</span> <span class="fu">localG</span>(rev_2020<span class="sc">$</span>total_revenue, knn_lw_2020)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>rev_2020.gi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rev_2020, <span class="fu">as.matrix</span>(gi.adaptive)) <span class="sc">%&gt;%</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gstat_adaptive =</span> as.matrix.gi.adaptive.)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="co"># For rev_2022</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>fips <span class="ot">&lt;-</span> <span class="fu">order</span>(rev_2022<span class="sc">$</span>ADM1_EN)</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>gi.adaptive <span class="ot">&lt;-</span> <span class="fu">localG</span>(rev_2022<span class="sc">$</span>total_revenue, knn_lw_2022)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>rev_2022.gi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rev_2022, <span class="fu">as.matrix</span>(gi.adaptive)) <span class="sc">%&gt;%</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gstat_adaptive =</span> as.matrix.gi.adaptive.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is time for us to visualise the locations of hot spot and cold spot areas. The choropleth mapping functions of <strong>tmap</strong> package will be used to map the Gi values.</p>
<p>The code chunk below shows the functions used to map the Gi values derived using fixed distance weight matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For rev_2020</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>revenue_2020 <span class="ot">&lt;-</span> <span class="fu">qtm</span>(rev_2020, <span class="st">"total_revenue"</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>Gimap_2020 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(rev_2020.gi) <span class="sc">+</span> </span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"gstat_adaptive"</span>, </span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>, </span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-RdBu"</span>, </span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Gi"</span>) <span class="sc">+</span> </span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(revenue_2020, </span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>             Gimap_2020, </span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For rev_2022</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>revenue_2022<span class="ot">&lt;-</span> <span class="fu">qtm</span>(rev_2022, <span class="st">"total_revenue"</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>Gimap_2022 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(rev_2022.gi) <span class="sc">+</span> </span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"gstat_adaptive"</span>, </span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>, </span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-RdBu"</span>, </span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Gi"</span>) <span class="sc">+</span> </span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(revenue_2022, </span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>             Gimap_2022, </span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-homeExercise2_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation-of-the-emerging-hotspot-analysis-2020-vs-2022" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="interpretation-of-the-emerging-hotspot-analysis-2020-vs-2022"><span class="header-section-number">8.2</span> Interpretation of the Emerging Hotspot Analysis (2020 vs 2022):</h3>
<p>This analysis compares <strong>tourism revenue</strong> across Thailand’s provinces in <strong>2020</strong> (during COVID-19) and <strong>2022</strong> (post-COVID-19). The maps show two main elements for both years:</p>
<ol type="1">
<li><p><strong>Total Revenue (Left Maps)</strong>:</p>
<ul>
<li><p>The left maps in both 2020 and 2022 display the <strong>total tourism revenue</strong> in each province.</p></li>
<li><p>Darker shades represent higher tourism revenue, while lighter shades represent lower revenue.</p></li>
</ul></li>
<li><p><strong>Local Gi (Right Maps)</strong>:</p>
<ul>
<li><p>The right maps display <strong>Local Gi</strong> statistics, indicating spatial autocorrelation and clustering of high or low tourism revenue.</p></li>
<li><p><strong>Blue areas</strong>: Provinces with low tourism revenue surrounded by provinces with similarly low revenue (Low-Low clusters).</p></li>
<li><p><strong>Red areas</strong>: Provinces with high tourism revenue surrounded by other provinces with similarly high revenue (High-High clusters).</p></li>
<li><p><strong>Light orange areas</strong>: These represent transition zones or areas where local tourism revenue is moderately higher or lower than their neighbors.</p></li>
</ul></li>
</ol>
</section>
<section id="observations-and-changes-between-2020-and-2022" class="level3" data-number="8.3">
<h3 data-number="8.3" class="anchored" data-anchor-id="observations-and-changes-between-2020-and-2022"><span class="header-section-number">8.3</span> Observations and Changes Between 2020 and 2022:</h3>
<ol type="1">
<li><p><strong>Total Revenue (Left Maps)</strong>:</p>
<ul>
<li><p><strong>2020 (During COVID-19)</strong>:</p>
<ul>
<li><p>Overall, the tourism revenue in most provinces is <strong>very low</strong>, with only a few provinces (primarily around <strong>Bangkok</strong> and the central region) showing slightly higher revenue.</p></li>
<li><p>This reflects the impact of COVID-19, where most regions experienced a significant drop in tourism revenue.</p></li>
</ul></li>
<li><p><strong>2022 (Post-COVID-19)</strong>:</p>
<ul>
<li><p>Tourism revenue remains relatively low across most of Thailand, though there is a noticeable increase compared to 2020, especially in provinces surrounding <strong>Bangkok</strong> and some southern regions.</p></li>
<li><p>While recovery is visible, the overall revenue is still below pre-pandemic levels, with the darker shades indicating moderate revenue growth in certain provinces.</p></li>
</ul></li>
</ul></li>
<li><p><strong>Local Gi (Right Maps)</strong>:</p>
<ul>
<li><p><strong>2020</strong>:</p>
<ul>
<li><p><strong>Blue clusters</strong> dominate most of the map, indicating that <strong>many provinces experienced low tourism revenue</strong>, especially in northern and central Thailand.</p></li>
<li><p><strong>Red clusters</strong> around Bangkok and southern provinces indicate that these regions were still maintaining higher levels of tourism revenue compared to neighboring provinces, forming <strong>high-high clusters</strong>.</p></li>
</ul></li>
<li><p><strong>2022</strong>:</p>
<ul>
<li><p><strong>Blue clusters</strong> are still prevalent across northern and northeastern Thailand, showing that these regions continue to struggle with low tourism revenue post-pandemic.</p></li>
<li><p>The <strong>red clusters</strong> (high-high clusters) are still present in central Thailand (Bangkok and surrounding provinces) and southern regions, indicating some resilience and recovery in tourism revenue compared to neighboring provinces.</p></li>
<li><p><strong>Orange regions</strong> in the south suggest transitional zones where revenue is starting to improve but hasn’t fully recovered yet.</p></li>
</ul></li>
</ul></li>
</ol>
</section>
<section id="key-changes-during-and-after-covid-19" class="level3" data-number="8.4">
<h3 data-number="8.4" class="anchored" data-anchor-id="key-changes-during-and-after-covid-19"><span class="header-section-number">8.4</span> Key Changes During and After COVID-19:</h3>
<ol type="1">
<li><p><strong>Revenue Drop in 2020</strong>:</p>
<ul>
<li><p>The maps clearly show that most provinces experienced a <strong>significant drop in tourism revenue</strong> during COVID-19 in 2020, with very few provinces maintaining relatively high levels of revenue.</p></li>
<li><p>Provinces like <strong>Bangkok, Phuket, and a few southern provinces</strong> still managed to have some higher levels of tourism revenue, but they were isolated from neighboring provinces.</p></li>
</ul></li>
<li><p><strong>Recovery in 2022</strong>:</p>
<ul>
<li><p>The maps show some <strong>recovery in tourism revenue</strong> in 2022, especially in the central and southern regions. However, northern and northeastern Thailand continue to struggle with low revenue, as seen in the continued presence of <strong>Low-Low clusters</strong>.</p></li>
<li><p><strong>High-High clusters</strong> (red areas) have expanded in 2022, indicating that recovery is occurring in certain key tourism regions, especially around <strong>Bangkok</strong> and <strong>Phuket</strong>.</p></li>
</ul></li>
<li><p><strong>Post-COVID Trends</strong>:</p>
<ul>
<li><p>The <strong>high-high clusters</strong> around <strong>Bangkok</strong> and <strong>Phuket</strong> regions, which were resilient during COVID-19, have strengthened in 2022.</p></li>
<li><p>While some regions have shown recovery, many provinces are still in the low-revenue category, indicating that tourism recovery has been uneven across Thailand, with certain regions recovering faster than others.</p></li>
</ul></li>
</ol>
</section>
<section id="conclusion" class="level3" data-number="8.5">
<h3 data-number="8.5" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">8.5</span> Conclusion:</h3>
<ul>
<li><p><strong>2020 (During COVID-19)</strong>: Significant decline in tourism revenue across Thailand, with only a few high-revenue provinces (Bangkok, Phuket, and surrounding regions).</p></li>
<li><p><strong>2022 (Post-COVID-19)</strong>: Signs of recovery in certain provinces, especially around Bangkok and southern Thailand. However, many provinces, particularly in the north and northeast, are still struggling with low tourism revenue.</p></li>
</ul>
<p>The analysis shows that <strong>tourism recovery has been concentrated in key regions</strong> while other areas continue to face challenges in returning to pre-pandemic levels.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>